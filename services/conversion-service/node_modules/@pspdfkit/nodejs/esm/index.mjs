/*!
 * PSPDFKit for Node.js 0.0.6 (https://pspdfkit.com/nodejs)
 *
 * Copyright (c) 2024 PSPDFKit GmbH. All rights reserved.
 *
 * THIS SOURCE CODE AND ANY ACCOMPANYING DOCUMENTATION ARE PROTECTED BY INTERNATIONAL COPYRIGHT LAW
 * AND MAY NOT BE RESOLD OR REDISTRIBUTED. USAGE IS BOUND TO THE PSPDFKIT LICENSE AGREEMENT.
 * UNAUTHORIZED REPRODUCTION OR DISTRIBUTION IS SUBJECT TO CIVIL AND CRIMINAL PENALTIES.
 * This notice may not be removed from this file.
 *
 * PSPDFKit uses several open source third-party components: https://pspdfkit.com/acknowledgements/nodejs/
 */let e;var t,r,n,i,a,s,o,u,d,c,l,h,p,f,m,y=Object.create,g=Object.defineProperty,_=Object.getOwnPropertyDescriptor,v=Object.getOwnPropertyNames,b=Object.getPrototypeOf,w=Object.prototype.hasOwnProperty;"u">typeof require?require:"u">typeof Proxy&&new Proxy(function(e){if("u">typeof require)return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')},{get:(e,t)=>("u">typeof require?require:e)[t]});var k,E,I,x=(e,t)=>()=>(e&&(t=e(e=0)),t),O=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),S=(e,t)=>{for(var r in t)g(e,r,{get:t[r],enumerable:!0})},T=(e,t,r,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let i of v(t))w.call(e,i)||i===r||g(e,i,{get:()=>t[i],enumerable:!(n=_(t,i))||n.enumerable});return e},C=(e,t,r)=>(r=null!=e?y(b(e)):{},T(!t&&e&&e.__esModule?r:g(r,"default",{value:e,enumerable:!0}),e)),D=x(()=>{k={BUNDLE:"/vendor",BACKEND_BUILD:"true",GDPICTURE_HASH:"d2ca6bda4cb907731fb7296e7cced273bc5ad2c4"}}),A=x(()=>{"use strict";D(),(E=function e(t){let r;return Object.setPrototypeOf(r=t instanceof Error?t:Error(t),e.prototype),r}).prototype=Object.create(Error.prototype,{name:{value:"PSPDFKitError",enumerable:!1}}),I=E});function F(e,t){if(!e)throw new I(`Assertion failed: ${t||"Condition not met"}

For further assistance, please go to: https://pspdfkit.com/support/request`)}var P=x(()=>{"use strict";D(),A()}),N=x(()=>{"use strict";D()}),j=x(()=>{"use strict";D()}),Z=x(()=>{"use strict";D()}),R=x(()=>{"use strict";D()}),B=x(()=>{"use strict";D()});function L(e){console.log(e)}var M,q=x(()=>{"use strict";D()}),U=x(()=>{"use strict";D()}),z=x(()=>{"use strict";D()}),$=x(()=>{"use strict";D()}),V=x(()=>{"use strict";D()}),J=x(()=>{"use strict";D()}),W=x(()=>{"use strict";D(),P()}),G=x(()=>{"use strict";D()}),K=x(()=>{"use strict";D()}),X=x(()=>{"use strict";D()}),H=x(()=>{"use strict";D(),M=">=1.4"}),Y=x(()=>{"use strict";D(),P(),A(),N(),j(),Z(),R(),B(),q(),U(),z(),$(),V(),J(),W(),G(),K(),X(),H()});async function Q(e){try{let t=await fetch(e).catch(t=>{throw new I(`Error fetching dynamic fonts file ${e}. ${t}`)});if(200!==t.status)throw new I(`Error fetching dynamic fonts file ${e}. Status code: ${t.status}`);return t}catch(e){throw e}}async function ee(e){return(await Q(e)).json().catch(t=>{throw new I(`Error parsing dynamic fonts file ${e}. ${t}`)})}var et,er=x(()=>{"use strict";D(),Y()}),en=O(e=>{"use strict";var t,r;D(),Object.defineProperty(e,"__esModule",{value:!0}),e.getParsedType=e.ZodParsedType=e.objectUtil=e.util=void 0,(t=r=e.util||(e.util={})).assertEqual=e=>e,t.assertIs=function(e){},t.assertNever=function(e){throw Error()},t.arrayToEnum=e=>{let t={};for(let r of e)t[r]=r;return t},t.getValidEnumValues=e=>{let r=t.objectKeys(e).filter(t=>"number"!=typeof e[e[t]]),n={};for(let t of r)n[t]=e[t];return t.objectValues(n)},t.objectValues=e=>t.objectKeys(e).map(function(t){return e[t]}),t.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{let t=[];for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t},t.find=(e,t)=>{for(let r of e)if(t(r))return r},t.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e,t.joinValues=function(e,t=" | "){return e.map(e=>"string"==typeof e?`'${e}'`:e).join(t)},t.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t,(e.objectUtil||(e.objectUtil={})).mergeShapes=(e,t)=>({...e,...t}),e.ZodParsedType=r.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),e.getParsedType=t=>{switch(typeof t){case"undefined":return e.ZodParsedType.undefined;case"string":return e.ZodParsedType.string;case"number":return isNaN(t)?e.ZodParsedType.nan:e.ZodParsedType.number;case"boolean":return e.ZodParsedType.boolean;case"function":return e.ZodParsedType.function;case"bigint":return e.ZodParsedType.bigint;case"symbol":return e.ZodParsedType.symbol;case"object":return Array.isArray(t)?e.ZodParsedType.array:null===t?e.ZodParsedType.null:t.then&&"function"==typeof t.then&&t.catch&&"function"==typeof t.catch?e.ZodParsedType.promise:"u">typeof Map&&t instanceof Map?e.ZodParsedType.map:"u">typeof Set&&t instanceof Set?e.ZodParsedType.set:"u">typeof Date&&t instanceof Date?e.ZodParsedType.date:e.ZodParsedType.object;default:return e.ZodParsedType.unknown}}}),ei=O(e=>{"use strict";D(),Object.defineProperty(e,"__esModule",{value:!0}),e.ZodError=e.quotelessJson=e.ZodIssueCode=void 0;var t=en();e.ZodIssueCode=t.util.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),e.quotelessJson=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");var r=class extends Error{constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};let t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){let t=e||function(e){return e.message},r={_errors:[]},n=e=>{for(let i of e.issues)if("invalid_union"===i.code)i.unionErrors.map(n);else if("invalid_return_type"===i.code)n(i.returnTypeError);else if("invalid_arguments"===i.code)n(i.argumentsError);else if(0===i.path.length)r._errors.push(t(i));else{let e=r,n=0;for(;n<i.path.length;){let r=i.path[n];n===i.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(t(i))):e[r]=e[r]||{_errors:[]},e=e[r],n++}}};return n(this),r}toString(){return this.message}get message(){return JSON.stringify(this.issues,t.util.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){let t={},r=[];for(let n of this.issues)n.path.length>0?(t[n.path[0]]=t[n.path[0]]||[],t[n.path[0]].push(e(n))):r.push(e(n));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}};e.ZodError=r,r.create=e=>new r(e)}),ea=O(e=>{"use strict";D(),Object.defineProperty(e,"__esModule",{value:!0});var t=en(),r=ei();e.default=(e,n)=>{let i;switch(e.code){case r.ZodIssueCode.invalid_type:i=e.received===t.ZodParsedType.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case r.ZodIssueCode.invalid_literal:i=`Invalid literal value, expected ${JSON.stringify(e.expected,t.util.jsonStringifyReplacer)}`;break;case r.ZodIssueCode.unrecognized_keys:i=`Unrecognized key(s) in object: ${t.util.joinValues(e.keys,", ")}`;break;case r.ZodIssueCode.invalid_union:i="Invalid input";break;case r.ZodIssueCode.invalid_union_discriminator:i=`Invalid discriminator value. Expected ${t.util.joinValues(e.options)}`;break;case r.ZodIssueCode.invalid_enum_value:i=`Invalid enum value. Expected ${t.util.joinValues(e.options)}, received '${e.received}'`;break;case r.ZodIssueCode.invalid_arguments:i="Invalid function arguments";break;case r.ZodIssueCode.invalid_return_type:i="Invalid function return type";break;case r.ZodIssueCode.invalid_date:i="Invalid date";break;case r.ZodIssueCode.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(i=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(i=`${i} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?i=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?i=`Invalid input: must end with "${e.validation.endsWith}"`:t.util.assertNever(e.validation):i="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case r.ZodIssueCode.too_small:i="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case r.ZodIssueCode.too_big:i="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case r.ZodIssueCode.custom:i="Invalid input";break;case r.ZodIssueCode.invalid_intersection_types:i="Intersection results could not be merged";break;case r.ZodIssueCode.not_multiple_of:i=`Number must be a multiple of ${e.multipleOf}`;break;case r.ZodIssueCode.not_finite:i="Number must be finite";break;default:i=n.defaultError,t.util.assertNever(e)}return{message:i}}}),es=O(e=>{"use strict";D();var t=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.getErrorMap=e.setErrorMap=e.defaultErrorMap=void 0;var r=t(ea());e.defaultErrorMap=r.default;var n=r.default;e.setErrorMap=function(e){n=e},e.getErrorMap=function(){return n}}),eo=O(e=>{"use strict";D();var t=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.isAsync=e.isValid=e.isDirty=e.isAborted=e.OK=e.DIRTY=e.INVALID=e.ParseStatus=e.addIssueToContext=e.EMPTY_PATH=e.makeIssue=void 0;var r=es(),n=t(ea());e.makeIssue=e=>{let{data:t,path:r,errorMaps:n,issueData:i}=e,a=[...r,...i.path||[]],s={...i,path:a},o="";for(let e of n.filter(e=>!!e).slice().reverse())o=e(s,{data:t,defaultError:o}).message;return{...i,path:a,message:i.message||o}},e.EMPTY_PATH=[],e.addIssueToContext=function(t,i){let a=(0,e.makeIssue)({issueData:i,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,(0,r.getErrorMap)(),n.default].filter(e=>!!e)});t.common.issues.push(a)};var i=class t{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(t,r){let n=[];for(let i of r){if("aborted"===i.status)return e.INVALID;"dirty"===i.status&&t.dirty(),n.push(i.value)}return{status:t.value,value:n}}static async mergeObjectAsync(e,r){let n=[];for(let e of r)n.push({key:await e.key,value:await e.value});return t.mergeObjectSync(e,n)}static mergeObjectSync(t,r){let n={};for(let i of r){let{key:r,value:a}=i;if("aborted"===r.status||"aborted"===a.status)return e.INVALID;"dirty"===r.status&&t.dirty(),"dirty"===a.status&&t.dirty(),"__proto__"!==r.value&&("u">typeof a.value||i.alwaysSet)&&(n[r.value]=a.value)}return{status:t.value,value:n}}};e.ParseStatus=i,e.INVALID=Object.freeze({status:"aborted"}),e.DIRTY=e=>({status:"dirty",value:e}),e.OK=e=>({status:"valid",value:e}),e.isAborted=e=>"aborted"===e.status,e.isDirty=e=>"dirty"===e.status,e.isValid=e=>"valid"===e.status,e.isAsync=e=>"u">typeof Promise&&e instanceof Promise}),eu=O(e=>{"use strict";D(),Object.defineProperty(e,"__esModule",{value:!0})}),ed=O(e=>{"use strict";var t;D(),Object.defineProperty(e,"__esModule",{value:!0}),e.errorUtil=void 0,(t=e.errorUtil||(e.errorUtil={})).errToObj=e=>"string"==typeof e?{message:e}:e||{},t.toString=e=>"string"==typeof e?e:e?.message}),ec=O(e=>{"use strict";D(),Object.defineProperty(e,"__esModule",{value:!0}),e.date=e.boolean=e.bigint=e.array=e.any=e.coerce=e.ZodFirstPartyTypeKind=e.late=e.ZodSchema=e.Schema=e.custom=e.ZodReadonly=e.ZodPipeline=e.ZodBranded=e.BRAND=e.ZodNaN=e.ZodCatch=e.ZodDefault=e.ZodNullable=e.ZodOptional=e.ZodTransformer=e.ZodEffects=e.ZodPromise=e.ZodNativeEnum=e.ZodEnum=e.ZodLiteral=e.ZodLazy=e.ZodFunction=e.ZodSet=e.ZodMap=e.ZodRecord=e.ZodTuple=e.ZodIntersection=e.ZodDiscriminatedUnion=e.ZodUnion=e.ZodObject=e.ZodArray=e.ZodVoid=e.ZodNever=e.ZodUnknown=e.ZodAny=e.ZodNull=e.ZodUndefined=e.ZodSymbol=e.ZodDate=e.ZodBoolean=e.ZodBigInt=e.ZodNumber=e.ZodString=e.ZodType=void 0,e.NEVER=e.void=e.unknown=e.union=e.undefined=e.tuple=e.transformer=e.symbol=e.string=e.strictObject=e.set=e.record=e.promise=e.preprocess=e.pipeline=e.ostring=e.optional=e.onumber=e.oboolean=e.object=e.number=e.nullable=e.null=e.never=e.nativeEnum=e.nan=e.map=e.literal=e.lazy=e.intersection=e.instanceof=e.function=e.enum=e.effect=e.discriminatedUnion=void 0;var t,r,n=es(),i=ed(),a=eo(),s=en(),o=ei(),u=class{constructor(e,t,r,n){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},d=(e,t)=>{if((0,a.isValid)(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new o.ZodError(e.common.issues);return this._error=t,this._error}}};function c(e){if(!e)return{};let{errorMap:t,invalid_type_error:r,required_error:n,description:i}=e;if(t&&(r||n))throw Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return t?{errorMap:t,description:i}:{errorMap:(e,t)=>"invalid_type"!==e.code?{message:t.defaultError}:typeof t.data>"u"?{message:n??t.defaultError}:{message:r??t.defaultError},description:i}}var l=class{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return(0,s.getParsedType)(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:(0,s.getParsedType)(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new a.ParseStatus,ctx:{common:e.parent.common,data:e.data,parsedType:(0,s.getParsedType)(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if((0,a.isAsync)(t))throw Error("Synchronous parse encountered promise.");return t}_parseAsync(e){return Promise.resolve(this._parse(e))}parse(e,t){let r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){var r;let n={common:{issues:[],async:null!==(r=t?.async)&&void 0!==r&&r,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:(0,s.getParsedType)(e)},i=this._parseSync({data:e,path:n.path,parent:n});return d(n,i)}async parseAsync(e,t){let r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){let r={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:(0,s.getParsedType)(e)},n=this._parse({data:e,path:r.path,parent:r});return d(r,await ((0,a.isAsync)(n)?n:Promise.resolve(n)))}refine(e,t){let r=e=>"string"==typeof t||typeof t>"u"?{message:t}:"function"==typeof t?t(e):t;return this._refinement((t,n)=>{let i=e(t),a=()=>n.addIssue({code:o.ZodIssueCode.custom,...r(t)});return"u">typeof Promise&&i instanceof Promise?i.then(e=>!!e||(a(),!1)):!!i||(a(),!1)})}refinement(e,t){return this._refinement((r,n)=>!!e(r)||(n.addIssue("function"==typeof t?t(r,n):t),!1))}_refinement(e){return new H({schema:this,typeName:r.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Y.create(this,this._def)}nullable(){return Q.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return N.create(this,this._def)}promise(){return X.create(this,this._def)}or(e){return Z.create([this,e],this._def)}and(e){return L.create(this,e,this._def)}transform(e){return new H({...c(this._def),schema:this,typeName:r.ZodEffects,effect:{type:"transform",transform:e}})}default(e){return new ee({...c(this._def),innerType:this,defaultValue:"function"==typeof e?e:()=>e,typeName:r.ZodDefault})}brand(){return new ea({typeName:r.ZodBranded,type:this,...c(this._def)})}catch(e){return new et({...c(this._def),innerType:this,catchValue:"function"==typeof e?e:()=>e,typeName:r.ZodCatch})}describe(e){return new this.constructor({...this._def,description:e})}pipe(e){return eu.create(this,e)}readonly(){return ec.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}};e.ZodType=l,e.Schema=l,e.ZodSchema=l;var h,p=/^c[^\s-]{8,}$/i,f=/^[a-z][a-z0-9]*$/,m=/^[0-9A-HJKMNP-TV-Z]{26}$/,y=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,g=/^(?!\.)(?!.*\.\.)([A-Z0-9_+-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,_=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,v=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,b=e=>e.precision?e.offset?RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${e.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${e.precision}}Z$`):0===e.precision?e.offset?RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):e.offset?RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$"),w=class e extends l{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==s.ZodParsedType.string){let t=this._getOrReturnCtx(e);return(0,a.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.string,received:t.parsedType}),a.INVALID}let t=new a.ParseStatus,r;for(let u of this._def.checks)if("min"===u.kind)e.data.length<u.value&&(r=this._getOrReturnCtx(e,r),(0,a.addIssueToContext)(r,{code:o.ZodIssueCode.too_small,minimum:u.value,type:"string",inclusive:!0,exact:!1,message:u.message}),t.dirty());else if("max"===u.kind)e.data.length>u.value&&(r=this._getOrReturnCtx(e,r),(0,a.addIssueToContext)(r,{code:o.ZodIssueCode.too_big,maximum:u.value,type:"string",inclusive:!0,exact:!1,message:u.message}),t.dirty());else if("length"===u.kind){let n=e.data.length>u.value,i=e.data.length<u.value;(n||i)&&(r=this._getOrReturnCtx(e,r),n?(0,a.addIssueToContext)(r,{code:o.ZodIssueCode.too_big,maximum:u.value,type:"string",inclusive:!0,exact:!0,message:u.message}):i&&(0,a.addIssueToContext)(r,{code:o.ZodIssueCode.too_small,minimum:u.value,type:"string",inclusive:!0,exact:!0,message:u.message}),t.dirty())}else if("email"===u.kind)g.test(e.data)||(r=this._getOrReturnCtx(e,r),(0,a.addIssueToContext)(r,{validation:"email",code:o.ZodIssueCode.invalid_string,message:u.message}),t.dirty());else if("emoji"===u.kind)h||(h=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),h.test(e.data)||(r=this._getOrReturnCtx(e,r),(0,a.addIssueToContext)(r,{validation:"emoji",code:o.ZodIssueCode.invalid_string,message:u.message}),t.dirty());else if("uuid"===u.kind)y.test(e.data)||(r=this._getOrReturnCtx(e,r),(0,a.addIssueToContext)(r,{validation:"uuid",code:o.ZodIssueCode.invalid_string,message:u.message}),t.dirty());else if("cuid"===u.kind)p.test(e.data)||(r=this._getOrReturnCtx(e,r),(0,a.addIssueToContext)(r,{validation:"cuid",code:o.ZodIssueCode.invalid_string,message:u.message}),t.dirty());else if("cuid2"===u.kind)f.test(e.data)||(r=this._getOrReturnCtx(e,r),(0,a.addIssueToContext)(r,{validation:"cuid2",code:o.ZodIssueCode.invalid_string,message:u.message}),t.dirty());else if("ulid"===u.kind)m.test(e.data)||(r=this._getOrReturnCtx(e,r),(0,a.addIssueToContext)(r,{validation:"ulid",code:o.ZodIssueCode.invalid_string,message:u.message}),t.dirty());else if("url"===u.kind)try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),(0,a.addIssueToContext)(r,{validation:"url",code:o.ZodIssueCode.invalid_string,message:u.message}),t.dirty()}else{var n,i;"regex"===u.kind?(u.regex.lastIndex=0,u.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),(0,a.addIssueToContext)(r,{validation:"regex",code:o.ZodIssueCode.invalid_string,message:u.message}),t.dirty())):"trim"===u.kind?e.data=e.data.trim():"includes"===u.kind?e.data.includes(u.value,u.position)||(r=this._getOrReturnCtx(e,r),(0,a.addIssueToContext)(r,{code:o.ZodIssueCode.invalid_string,validation:{includes:u.value,position:u.position},message:u.message}),t.dirty()):"toLowerCase"===u.kind?e.data=e.data.toLowerCase():"toUpperCase"===u.kind?e.data=e.data.toUpperCase():"startsWith"===u.kind?e.data.startsWith(u.value)||(r=this._getOrReturnCtx(e,r),(0,a.addIssueToContext)(r,{code:o.ZodIssueCode.invalid_string,validation:{startsWith:u.value},message:u.message}),t.dirty()):"endsWith"===u.kind?e.data.endsWith(u.value)||(r=this._getOrReturnCtx(e,r),(0,a.addIssueToContext)(r,{code:o.ZodIssueCode.invalid_string,validation:{endsWith:u.value},message:u.message}),t.dirty()):"datetime"===u.kind?b(u).test(e.data)||(r=this._getOrReturnCtx(e,r),(0,a.addIssueToContext)(r,{code:o.ZodIssueCode.invalid_string,validation:"datetime",message:u.message}),t.dirty()):"ip"===u.kind?(n=e.data,("v4"===(i=u.version)||!i)&&_.test(n)||("v6"===i||!i)&&v.test(n)||(r=this._getOrReturnCtx(e,r),(0,a.addIssueToContext)(r,{validation:"ip",code:o.ZodIssueCode.invalid_string,message:u.message}),t.dirty())):s.util.assertNever(u)}return{status:t.value,value:e.data}}_regex(e,t,r){return this.refinement(t=>e.test(t),{validation:t,code:o.ZodIssueCode.invalid_string,...i.errorUtil.errToObj(r)})}_addCheck(t){return new e({...this._def,checks:[...this._def.checks,t]})}email(e){return this._addCheck({kind:"email",...i.errorUtil.errToObj(e)})}url(e){return this._addCheck({kind:"url",...i.errorUtil.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...i.errorUtil.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...i.errorUtil.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...i.errorUtil.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...i.errorUtil.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...i.errorUtil.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...i.errorUtil.errToObj(e)})}datetime(e){var t;return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:null!==(t=e?.offset)&&void 0!==t&&t,...i.errorUtil.errToObj(e?.message)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...i.errorUtil.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...i.errorUtil.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...i.errorUtil.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...i.errorUtil.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...i.errorUtil.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...i.errorUtil.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...i.errorUtil.errToObj(t)})}nonempty(e){return this.min(1,i.errorUtil.errToObj(e))}trim(){return new e({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new e({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new e({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>"datetime"===e.kind)}get isEmail(){return!!this._def.checks.find(e=>"email"===e.kind)}get isURL(){return!!this._def.checks.find(e=>"url"===e.kind)}get isEmoji(){return!!this._def.checks.find(e=>"emoji"===e.kind)}get isUUID(){return!!this._def.checks.find(e=>"uuid"===e.kind)}get isCUID(){return!!this._def.checks.find(e=>"cuid"===e.kind)}get isCUID2(){return!!this._def.checks.find(e=>"cuid2"===e.kind)}get isULID(){return!!this._def.checks.find(e=>"ulid"===e.kind)}get isIP(){return!!this._def.checks.find(e=>"ip"===e.kind)}get minLength(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}};e.ZodString=w,w.create=e=>{var t;return new w({checks:[],typeName:r.ZodString,coerce:null!==(t=e?.coerce)&&void 0!==t&&t,...c(e)})};var k=class e extends l{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==s.ZodParsedType.number){let t=this._getOrReturnCtx(e);return(0,a.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.number,received:t.parsedType}),a.INVALID}let t,r=new a.ParseStatus;for(let n of this._def.checks)"int"===n.kind?s.util.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),(0,a.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:"integer",received:"float",message:n.message}),r.dirty()):"min"===n.kind?(n.inclusive?e.data<n.value:e.data<=n.value)&&(t=this._getOrReturnCtx(e,t),(0,a.addIssueToContext)(t,{code:o.ZodIssueCode.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty()):"max"===n.kind?(n.inclusive?e.data>n.value:e.data>=n.value)&&(t=this._getOrReturnCtx(e,t),(0,a.addIssueToContext)(t,{code:o.ZodIssueCode.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty()):"multipleOf"===n.kind?0!==function(e,t){let r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,i=r>n?r:n;return parseInt(e.toFixed(i).replace(".",""))%parseInt(t.toFixed(i).replace(".",""))/Math.pow(10,i)}(e.data,n.value)&&(t=this._getOrReturnCtx(e,t),(0,a.addIssueToContext)(t,{code:o.ZodIssueCode.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):"finite"===n.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),(0,a.addIssueToContext)(t,{code:o.ZodIssueCode.not_finite,message:n.message}),r.dirty()):s.util.assertNever(n);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,i.errorUtil.toString(t))}gt(e,t){return this.setLimit("min",e,!1,i.errorUtil.toString(t))}lte(e,t){return this.setLimit("max",e,!0,i.errorUtil.toString(t))}lt(e,t){return this.setLimit("max",e,!1,i.errorUtil.toString(t))}setLimit(t,r,n,a){return new e({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:i.errorUtil.toString(a)}]})}_addCheck(t){return new e({...this._def,checks:[...this._def.checks,t]})}int(e){return this._addCheck({kind:"int",message:i.errorUtil.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:i.errorUtil.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:i.errorUtil.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:i.errorUtil.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:i.errorUtil.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:i.errorUtil.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:i.errorUtil.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:i.errorUtil.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:i.errorUtil.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>"int"===e.kind||"multipleOf"===e.kind&&s.util.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let r of this._def.checks){if("finite"===r.kind||"int"===r.kind||"multipleOf"===r.kind)return!0;"min"===r.kind?(null===t||r.value>t)&&(t=r.value):"max"===r.kind&&(null===e||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}};e.ZodNumber=k,k.create=e=>new k({checks:[],typeName:r.ZodNumber,coerce:e?.coerce||!1,...c(e)});var E=class e extends l{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==s.ZodParsedType.bigint){let t=this._getOrReturnCtx(e);return(0,a.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.bigint,received:t.parsedType}),a.INVALID}let t,r=new a.ParseStatus;for(let n of this._def.checks)"min"===n.kind?(n.inclusive?e.data<n.value:e.data<=n.value)&&(t=this._getOrReturnCtx(e,t),(0,a.addIssueToContext)(t,{code:o.ZodIssueCode.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):"max"===n.kind?(n.inclusive?e.data>n.value:e.data>=n.value)&&(t=this._getOrReturnCtx(e,t),(0,a.addIssueToContext)(t,{code:o.ZodIssueCode.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):"multipleOf"===n.kind?e.data%n.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),(0,a.addIssueToContext)(t,{code:o.ZodIssueCode.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):s.util.assertNever(n);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,i.errorUtil.toString(t))}gt(e,t){return this.setLimit("min",e,!1,i.errorUtil.toString(t))}lte(e,t){return this.setLimit("max",e,!0,i.errorUtil.toString(t))}lt(e,t){return this.setLimit("max",e,!1,i.errorUtil.toString(t))}setLimit(t,r,n,a){return new e({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:i.errorUtil.toString(a)}]})}_addCheck(t){return new e({...this._def,checks:[...this._def.checks,t]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:i.errorUtil.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:i.errorUtil.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:i.errorUtil.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:i.errorUtil.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:i.errorUtil.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}};e.ZodBigInt=E,E.create=e=>{var t;return new E({checks:[],typeName:r.ZodBigInt,coerce:null!==(t=e?.coerce)&&void 0!==t&&t,...c(e)})};var I=class extends l{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==s.ZodParsedType.boolean){let t=this._getOrReturnCtx(e);return(0,a.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.boolean,received:t.parsedType}),a.INVALID}return(0,a.OK)(e.data)}};e.ZodBoolean=I,I.create=e=>new I({typeName:r.ZodBoolean,coerce:e?.coerce||!1,...c(e)});var x=class e extends l{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==s.ZodParsedType.date){let t=this._getOrReturnCtx(e);return(0,a.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.date,received:t.parsedType}),a.INVALID}if(isNaN(e.data.getTime())){let t=this._getOrReturnCtx(e);return(0,a.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_date}),a.INVALID}let t=new a.ParseStatus,r;for(let n of this._def.checks)"min"===n.kind?e.data.getTime()<n.value&&(r=this._getOrReturnCtx(e,r),(0,a.addIssueToContext)(r,{code:o.ZodIssueCode.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),t.dirty()):"max"===n.kind?e.data.getTime()>n.value&&(r=this._getOrReturnCtx(e,r),(0,a.addIssueToContext)(r,{code:o.ZodIssueCode.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),t.dirty()):s.util.assertNever(n);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(t){return new e({...this._def,checks:[...this._def.checks,t]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:i.errorUtil.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:i.errorUtil.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}};e.ZodDate=x,x.create=e=>new x({checks:[],coerce:e?.coerce||!1,typeName:r.ZodDate,...c(e)});var O=class extends l{_parse(e){if(this._getType(e)!==s.ZodParsedType.symbol){let t=this._getOrReturnCtx(e);return(0,a.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.symbol,received:t.parsedType}),a.INVALID}return(0,a.OK)(e.data)}};e.ZodSymbol=O,O.create=e=>new O({typeName:r.ZodSymbol,...c(e)});var S=class extends l{_parse(e){if(this._getType(e)!==s.ZodParsedType.undefined){let t=this._getOrReturnCtx(e);return(0,a.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.undefined,received:t.parsedType}),a.INVALID}return(0,a.OK)(e.data)}};e.ZodUndefined=S,S.create=e=>new S({typeName:r.ZodUndefined,...c(e)});var T=class extends l{_parse(e){if(this._getType(e)!==s.ZodParsedType.null){let t=this._getOrReturnCtx(e);return(0,a.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.null,received:t.parsedType}),a.INVALID}return(0,a.OK)(e.data)}};e.ZodNull=T,T.create=e=>new T({typeName:r.ZodNull,...c(e)});var C=class extends l{constructor(){super(...arguments),this._any=!0}_parse(e){return(0,a.OK)(e.data)}};e.ZodAny=C,C.create=e=>new C({typeName:r.ZodAny,...c(e)});var A=class extends l{constructor(){super(...arguments),this._unknown=!0}_parse(e){return(0,a.OK)(e.data)}};e.ZodUnknown=A,A.create=e=>new A({typeName:r.ZodUnknown,...c(e)});var F=class extends l{_parse(e){let t=this._getOrReturnCtx(e);return(0,a.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.never,received:t.parsedType}),a.INVALID}};e.ZodNever=F,F.create=e=>new F({typeName:r.ZodNever,...c(e)});var P=class extends l{_parse(e){if(this._getType(e)!==s.ZodParsedType.undefined){let t=this._getOrReturnCtx(e);return(0,a.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.void,received:t.parsedType}),a.INVALID}return(0,a.OK)(e.data)}};e.ZodVoid=P,P.create=e=>new P({typeName:r.ZodVoid,...c(e)});var N=class e extends l{_parse(e){let{ctx:t,status:r}=this._processInputParams(e),n=this._def;if(t.parsedType!==s.ZodParsedType.array)return(0,a.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.array,received:t.parsedType}),a.INVALID;if(null!==n.exactLength){let e=t.data.length>n.exactLength.value,i=t.data.length<n.exactLength.value;(e||i)&&((0,a.addIssueToContext)(t,{code:e?o.ZodIssueCode.too_big:o.ZodIssueCode.too_small,minimum:i?n.exactLength.value:void 0,maximum:e?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),r.dirty())}if(null!==n.minLength&&t.data.length<n.minLength.value&&((0,a.addIssueToContext)(t,{code:o.ZodIssueCode.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),r.dirty()),null!==n.maxLength&&t.data.length>n.maxLength.value&&((0,a.addIssueToContext)(t,{code:o.ZodIssueCode.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((e,r)=>n.type._parseAsync(new u(t,e,t.path,r)))).then(e=>a.ParseStatus.mergeArray(r,e));let i=[...t.data].map((e,r)=>n.type._parseSync(new u(t,e,t.path,r)));return a.ParseStatus.mergeArray(r,i)}get element(){return this._def.type}min(t,r){return new e({...this._def,minLength:{value:t,message:i.errorUtil.toString(r)}})}max(t,r){return new e({...this._def,maxLength:{value:t,message:i.errorUtil.toString(r)}})}length(t,r){return new e({...this._def,exactLength:{value:t,message:i.errorUtil.toString(r)}})}nonempty(e){return this.min(1,e)}};e.ZodArray=N,N.create=(e,t)=>new N({type:e,minLength:null,maxLength:null,exactLength:null,typeName:r.ZodArray,...c(t)});var j=class e extends l{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;let e=this._def.shape(),t=s.util.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==s.ZodParsedType.object){let t=this._getOrReturnCtx(e);return(0,a.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.object,received:t.parsedType}),a.INVALID}let{status:t,ctx:r}=this._processInputParams(e),{shape:n,keys:i}=this._getCached(),d=[];if(!(this._def.catchall instanceof F&&"strip"===this._def.unknownKeys))for(let e in r.data)i.includes(e)||d.push(e);let c=[];for(let e of i){let t=n[e],i=r.data[e];c.push({key:{status:"valid",value:e},value:t._parse(new u(r,i,r.path,e)),alwaysSet:e in r.data})}if(this._def.catchall instanceof F){let e=this._def.unknownKeys;if("passthrough"===e)for(let e of d)c.push({key:{status:"valid",value:e},value:{status:"valid",value:r.data[e]}});else if("strict"===e)d.length>0&&((0,a.addIssueToContext)(r,{code:o.ZodIssueCode.unrecognized_keys,keys:d}),t.dirty());else if("strip"!==e)throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let e=this._def.catchall;for(let t of d){let n=r.data[t];c.push({key:{status:"valid",value:t},value:e._parse(new u(r,n,r.path,t)),alwaysSet:t in r.data})}}return r.common.async?Promise.resolve().then(async()=>{let e=[];for(let t of c){let r=await t.key;e.push({key:r,value:await t.value,alwaysSet:t.alwaysSet})}return e}).then(e=>a.ParseStatus.mergeObjectSync(t,e)):a.ParseStatus.mergeObjectSync(t,c)}get shape(){return this._def.shape()}strict(t){return i.errorUtil.errToObj,new e({...this._def,unknownKeys:"strict",...void 0!==t?{errorMap:(e,r)=>{var n,a,s,o;let u=null!==(s=null===(a=(n=this._def).errorMap)||void 0===a?void 0:a.call(n,e,r).message)&&void 0!==s?s:r.defaultError;return"unrecognized_keys"===e.code?{message:null!==(o=i.errorUtil.errToObj(t).message)&&void 0!==o?o:u}:{message:u}}}:{}})}strip(){return new e({...this._def,unknownKeys:"strip"})}passthrough(){return new e({...this._def,unknownKeys:"passthrough"})}extend(t){return new e({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new e({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:r.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(t){return new e({...this._def,catchall:t})}pick(t){let r={};return s.util.objectKeys(t).forEach(e=>{t[e]&&this.shape[e]&&(r[e]=this.shape[e])}),new e({...this._def,shape:()=>r})}omit(t){let r={};return s.util.objectKeys(this.shape).forEach(e=>{t[e]||(r[e]=this.shape[e])}),new e({...this._def,shape:()=>r})}deepPartial(){return function e(t){if(!(t instanceof j))return t instanceof N?new N({...t._def,type:e(t.element)}):t instanceof Y?Y.create(e(t.unwrap())):t instanceof Q?Q.create(e(t.unwrap())):t instanceof M?M.create(t.items.map(t=>e(t))):t;{let r={};for(let n in t.shape){let i=t.shape[n];r[n]=Y.create(e(i))}return new j({...t._def,shape:()=>r})}}(this)}partial(t){let r={};return s.util.objectKeys(this.shape).forEach(e=>{let n=this.shape[e];t&&!t[e]?r[e]=n:r[e]=n.optional()}),new e({...this._def,shape:()=>r})}required(t){let r={};return s.util.objectKeys(this.shape).forEach(e=>{if(t&&!t[e])r[e]=this.shape[e];else{let t=this.shape[e];for(;t instanceof Y;)t=t._def.innerType;r[e]=t}}),new e({...this._def,shape:()=>r})}keyof(){return W(s.util.objectKeys(this.shape))}};e.ZodObject=j,j.create=(e,t)=>new j({shape:()=>e,unknownKeys:"strip",catchall:F.create(),typeName:r.ZodObject,...c(t)}),j.strictCreate=(e,t)=>new j({shape:()=>e,unknownKeys:"strict",catchall:F.create(),typeName:r.ZodObject,...c(t)}),j.lazycreate=(e,t)=>new j({shape:e,unknownKeys:"strip",catchall:F.create(),typeName:r.ZodObject,...c(t)});var Z=class extends l{_parse(e){let{ctx:t}=this._processInputParams(e),r=this._def.options;if(t.common.async)return Promise.all(r.map(async e=>{let r={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:r}),ctx:r}})).then(function(e){for(let t of e)if("valid"===t.result.status)return t.result;for(let r of e)if("dirty"===r.result.status)return t.common.issues.push(...r.ctx.common.issues),r.result;let r=e.map(e=>new o.ZodError(e.ctx.common.issues));return(0,a.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_union,unionErrors:r}),a.INVALID});{let e,n=[];for(let i of r){let r={...t,common:{...t.common,issues:[]},parent:null},a=i._parseSync({data:t.data,path:t.path,parent:r});if("valid"===a.status)return a;"dirty"!==a.status||e||(e={result:a,ctx:r}),r.common.issues.length&&n.push(r.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;let i=n.map(e=>new o.ZodError(e));return(0,a.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_union,unionErrors:i}),a.INVALID}}get options(){return this._def.options}};e.ZodUnion=Z,Z.create=(e,t)=>new Z({options:e,typeName:r.ZodUnion,...c(t)});var R=e=>e instanceof V?R(e.schema):e instanceof H?R(e.innerType()):e instanceof J?[e.value]:e instanceof G?e.options:e instanceof K?Object.keys(e.enum):e instanceof ee?R(e._def.innerType):e instanceof S?[void 0]:e instanceof T?[null]:null,B=class e extends l{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==s.ZodParsedType.object)return(0,a.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.object,received:t.parsedType}),a.INVALID;let r=this.discriminator,n=t.data[r],i=this.optionsMap.get(n);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):((0,a.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),a.INVALID)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,n,i){let a=new Map;for(let e of n){let r=R(e.shape[t]);if(!r)throw Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(let n of r){if(a.has(n))throw Error(`Discriminator property ${String(t)} has duplicate value ${String(n)}`);a.set(n,e)}}return new e({typeName:r.ZodDiscriminatedUnion,discriminator:t,options:n,optionsMap:a,...c(i)})}};e.ZodDiscriminatedUnion=B;var L=class extends l{_parse(e){let{status:t,ctx:r}=this._processInputParams(e),n=(e,n)=>{if((0,a.isAborted)(e)||(0,a.isAborted)(n))return a.INVALID;let i=function e(t,r){let n=(0,s.getParsedType)(t),i=(0,s.getParsedType)(r);if(t===r)return{valid:!0,data:t};if(n===s.ZodParsedType.object&&i===s.ZodParsedType.object){let n=s.util.objectKeys(r),i=s.util.objectKeys(t).filter(e=>-1!==n.indexOf(e)),a={...t,...r};for(let n of i){let i=e(t[n],r[n]);if(!i.valid)return{valid:!1};a[n]=i.data}return{valid:!0,data:a}}if(n!==s.ZodParsedType.array||i!==s.ZodParsedType.array)return n===s.ZodParsedType.date&&i===s.ZodParsedType.date&&+t==+r?{valid:!0,data:t}:{valid:!1};{if(t.length!==r.length)return{valid:!1};let n=[];for(let i=0;i<t.length;i++){let a=e(t[i],r[i]);if(!a.valid)return{valid:!1};n.push(a.data)}return{valid:!0,data:n}}}(e.value,n.value);return i.valid?(((0,a.isDirty)(e)||(0,a.isDirty)(n))&&t.dirty(),{status:t.value,value:i.data}):((0,a.addIssueToContext)(r,{code:o.ZodIssueCode.invalid_intersection_types}),a.INVALID)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([e,t])=>n(e,t)):n(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}};e.ZodIntersection=L,L.create=(e,t,n)=>new L({left:e,right:t,typeName:r.ZodIntersection,...c(n)});var M=class e extends l{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==s.ZodParsedType.array)return(0,a.addIssueToContext)(r,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.array,received:r.parsedType}),a.INVALID;if(r.data.length<this._def.items.length)return(0,a.addIssueToContext)(r,{code:o.ZodIssueCode.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),a.INVALID;!this._def.rest&&r.data.length>this._def.items.length&&((0,a.addIssueToContext)(r,{code:o.ZodIssueCode.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let n=[...r.data].map((e,t)=>{let n=this._def.items[t]||this._def.rest;return n?n._parse(new u(r,e,r.path,t)):null}).filter(e=>!!e);return r.common.async?Promise.all(n).then(e=>a.ParseStatus.mergeArray(t,e)):a.ParseStatus.mergeArray(t,n)}get items(){return this._def.items}rest(t){return new e({...this._def,rest:t})}};e.ZodTuple=M,M.create=(e,t)=>{if(!Array.isArray(e))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new M({items:e,typeName:r.ZodTuple,rest:null,...c(t)})};var q=class e extends l{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==s.ZodParsedType.object)return(0,a.addIssueToContext)(r,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.object,received:r.parsedType}),a.INVALID;let n=[],i=this._def.keyType,d=this._def.valueType;for(let e in r.data)n.push({key:i._parse(new u(r,e,r.path,e)),value:d._parse(new u(r,r.data[e],r.path,e))});return r.common.async?a.ParseStatus.mergeObjectAsync(t,n):a.ParseStatus.mergeObjectSync(t,n)}get element(){return this._def.valueType}static create(t,n,i){return new e(n instanceof l?{keyType:t,valueType:n,typeName:r.ZodRecord,...c(i)}:{keyType:w.create(),valueType:t,typeName:r.ZodRecord,...c(n)})}};e.ZodRecord=q;var U=class extends l{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==s.ZodParsedType.map)return(0,a.addIssueToContext)(r,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.map,received:r.parsedType}),a.INVALID;let n=this._def.keyType,i=this._def.valueType,d=[...r.data.entries()].map(([e,t],a)=>({key:n._parse(new u(r,e,r.path,[a,"key"])),value:i._parse(new u(r,t,r.path,[a,"value"]))}));if(r.common.async){let e=new Map;return Promise.resolve().then(async()=>{for(let r of d){let n=await r.key,i=await r.value;if("aborted"===n.status||"aborted"===i.status)return a.INVALID;("dirty"===n.status||"dirty"===i.status)&&t.dirty(),e.set(n.value,i.value)}return{status:t.value,value:e}})}{let e=new Map;for(let r of d){let n=r.key,i=r.value;if("aborted"===n.status||"aborted"===i.status)return a.INVALID;("dirty"===n.status||"dirty"===i.status)&&t.dirty(),e.set(n.value,i.value)}return{status:t.value,value:e}}}};e.ZodMap=U,U.create=(e,t,n)=>new U({valueType:t,keyType:e,typeName:r.ZodMap,...c(n)});var z=class e extends l{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==s.ZodParsedType.set)return(0,a.addIssueToContext)(r,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.set,received:r.parsedType}),a.INVALID;let n=this._def;null!==n.minSize&&r.data.size<n.minSize.value&&((0,a.addIssueToContext)(r,{code:o.ZodIssueCode.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),t.dirty()),null!==n.maxSize&&r.data.size>n.maxSize.value&&((0,a.addIssueToContext)(r,{code:o.ZodIssueCode.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),t.dirty());let i=this._def.valueType;function d(e){let r=new Set;for(let n of e){if("aborted"===n.status)return a.INVALID;"dirty"===n.status&&t.dirty(),r.add(n.value)}return{status:t.value,value:r}}let c=[...r.data.values()].map((e,t)=>i._parse(new u(r,e,r.path,t)));return r.common.async?Promise.all(c).then(e=>d(e)):d(c)}min(t,r){return new e({...this._def,minSize:{value:t,message:i.errorUtil.toString(r)}})}max(t,r){return new e({...this._def,maxSize:{value:t,message:i.errorUtil.toString(r)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}};e.ZodSet=z,z.create=(e,t)=>new z({valueType:e,minSize:null,maxSize:null,typeName:r.ZodSet,...c(t)});var $=class e extends l{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==s.ZodParsedType.function)return(0,a.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.function,received:t.parsedType}),a.INVALID;function r(e,r){return(0,a.makeIssue)({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,(0,n.getErrorMap)(),n.defaultErrorMap].filter(e=>!!e),issueData:{code:o.ZodIssueCode.invalid_arguments,argumentsError:r}})}function i(e,r){return(0,a.makeIssue)({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,(0,n.getErrorMap)(),n.defaultErrorMap].filter(e=>!!e),issueData:{code:o.ZodIssueCode.invalid_return_type,returnTypeError:r}})}let u={errorMap:t.common.contextualErrorMap},d=t.data;if(this._def.returns instanceof X){let e=this;return(0,a.OK)(async function(...t){let n=new o.ZodError([]),a=await e._def.args.parseAsync(t,u).catch(e=>{throw n.addIssue(r(t,e)),n}),s=await Reflect.apply(d,this,a);return await e._def.returns._def.type.parseAsync(s,u).catch(e=>{throw n.addIssue(i(s,e)),n})})}{let e=this;return(0,a.OK)(function(...t){let n=e._def.args.safeParse(t,u);if(!n.success)throw new o.ZodError([r(t,n.error)]);let a=Reflect.apply(d,this,n.data),s=e._def.returns.safeParse(a,u);if(!s.success)throw new o.ZodError([i(a,s.error)]);return s.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new e({...this._def,args:M.create(t).rest(A.create())})}returns(t){return new e({...this._def,returns:t})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(t,n,i){return new e({args:t||M.create([]).rest(A.create()),returns:n||A.create(),typeName:r.ZodFunction,...c(i)})}};e.ZodFunction=$;var V=class extends l{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}};e.ZodLazy=V,V.create=(e,t)=>new V({getter:e,typeName:r.ZodLazy,...c(t)});var J=class extends l{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return(0,a.addIssueToContext)(t,{received:t.data,code:o.ZodIssueCode.invalid_literal,expected:this._def.value}),a.INVALID}return{status:"valid",value:e.data}}get value(){return this._def.value}};function W(e,t){return new G({values:e,typeName:r.ZodEnum,...c(t)})}e.ZodLiteral=J,J.create=(e,t)=>new J({value:e,typeName:r.ZodLiteral,...c(t)});var G=class e extends l{_parse(e){if("string"!=typeof e.data){let t=this._getOrReturnCtx(e),r=this._def.values;return(0,a.addIssueToContext)(t,{expected:s.util.joinValues(r),received:t.parsedType,code:o.ZodIssueCode.invalid_type}),a.INVALID}if(-1===this._def.values.indexOf(e.data)){let t=this._getOrReturnCtx(e),r=this._def.values;return(0,a.addIssueToContext)(t,{received:t.data,code:o.ZodIssueCode.invalid_enum_value,options:r}),a.INVALID}return(0,a.OK)(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(t){return e.create(t)}exclude(t){return e.create(this.options.filter(e=>!t.includes(e)))}};e.ZodEnum=G,G.create=W;var K=class extends l{_parse(e){let t=s.util.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==s.ZodParsedType.string&&r.parsedType!==s.ZodParsedType.number){let e=s.util.objectValues(t);return(0,a.addIssueToContext)(r,{expected:s.util.joinValues(e),received:r.parsedType,code:o.ZodIssueCode.invalid_type}),a.INVALID}if(-1===t.indexOf(e.data)){let e=s.util.objectValues(t);return(0,a.addIssueToContext)(r,{received:r.data,code:o.ZodIssueCode.invalid_enum_value,options:e}),a.INVALID}return(0,a.OK)(e.data)}get enum(){return this._def.values}};e.ZodNativeEnum=K,K.create=(e,t)=>new K({values:e,typeName:r.ZodNativeEnum,...c(t)});var X=class extends l{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==s.ZodParsedType.promise&&!1===t.common.async)return(0,a.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.promise,received:t.parsedType}),a.INVALID;let r=t.parsedType===s.ZodParsedType.promise?t.data:Promise.resolve(t.data);return(0,a.OK)(r.then(e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap})))}};e.ZodPromise=X,X.create=(e,t)=>new X({type:e,typeName:r.ZodPromise,...c(t)});var H=class extends l{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===r.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:r}=this._processInputParams(e),n=this._def.effect||null,i={addIssue:e=>{(0,a.addIssueToContext)(r,e),e.fatal?t.abort():t.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),"preprocess"===n.type){let e=n.transform(r.data,i);return r.common.issues.length?{status:"dirty",value:r.data}:r.common.async?Promise.resolve(e).then(e=>this._def.schema._parseAsync({data:e,path:r.path,parent:r})):this._def.schema._parseSync({data:e,path:r.path,parent:r})}if("refinement"===n.type){let e=e=>{let t=n.refinement(e,i);if(r.common.async)return Promise.resolve(t);if(t instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(r=>"aborted"===r.status?a.INVALID:("dirty"===r.status&&t.dirty(),e(r.value).then(()=>({status:t.value,value:r.value}))));{let n=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===n.status?a.INVALID:("dirty"===n.status&&t.dirty(),e(n.value),{status:t.value,value:n.value})}}if("transform"===n.type){if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(e=>(0,a.isValid)(e)?Promise.resolve(n.transform(e.value,i)).then(e=>({status:t.value,value:e})):e);{let e=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!(0,a.isValid)(e))return e;let s=n.transform(e.value,i);if(s instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:s}}}s.util.assertNever(n)}};e.ZodEffects=H,e.ZodTransformer=H,H.create=(e,t,n)=>new H({schema:e,typeName:r.ZodEffects,effect:t,...c(n)}),H.createWithPreprocess=(e,t,n)=>new H({schema:t,effect:{type:"preprocess",transform:e},typeName:r.ZodEffects,...c(n)});var Y=class extends l{_parse(e){return this._getType(e)===s.ZodParsedType.undefined?(0,a.OK)(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};e.ZodOptional=Y,Y.create=(e,t)=>new Y({innerType:e,typeName:r.ZodOptional,...c(t)});var Q=class extends l{_parse(e){return this._getType(e)===s.ZodParsedType.null?(0,a.OK)(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};e.ZodNullable=Q,Q.create=(e,t)=>new Q({innerType:e,typeName:r.ZodNullable,...c(t)});var ee=class extends l{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return t.parsedType===s.ZodParsedType.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}};e.ZodDefault=ee,ee.create=(e,t)=>new ee({innerType:e,typeName:r.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...c(t)});var et=class extends l{_parse(e){let{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},n=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return(0,a.isAsync)(n)?n.then(e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new o.ZodError(r.common.issues)},input:r.data})})):{status:"valid",value:"valid"===n.status?n.value:this._def.catchValue({get error(){return new o.ZodError(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}};e.ZodCatch=et,et.create=(e,t)=>new et({innerType:e,typeName:r.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...c(t)});var er=class extends l{_parse(e){if(this._getType(e)!==s.ZodParsedType.nan){let t=this._getOrReturnCtx(e);return(0,a.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.nan,received:t.parsedType}),a.INVALID}return{status:"valid",value:e.data}}};e.ZodNaN=er,er.create=e=>new er({typeName:r.ZodNaN,...c(e)}),e.BRAND=Symbol("zod_brand");var ea=class extends l{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}};e.ZodBranded=ea;var eu=class e extends l{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{let e=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?a.INVALID:"dirty"===e.status?(t.dirty(),(0,a.DIRTY)(e.value)):this._def.out._parseAsync({data:e.value,path:r.path,parent:r})})();{let e=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?a.INVALID:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:r.path,parent:r})}}static create(t,n){return new e({in:t,out:n,typeName:r.ZodPipeline})}};e.ZodPipeline=eu;var ec=class extends l{_parse(e){let t=this._def.innerType._parse(e);return(0,a.isValid)(t)&&(t.value=Object.freeze(t.value)),t}};e.ZodReadonly=ec,ec.create=(e,t)=>new ec({innerType:e,typeName:r.ZodReadonly,...c(t)}),e.custom=(e,t={},r)=>e?C.create().superRefine((n,i)=>{var a,s;if(!e(n)){let e="function"==typeof t?t(n):"string"==typeof t?{message:t}:t,o=null===(s=null!==(a=e.fatal)&&void 0!==a?a:r)||void 0===s||s,u="string"==typeof e?{message:e}:e;i.addIssue({code:"custom",...u,fatal:o})}}):C.create(),e.late={object:j.lazycreate},(t=r=e.ZodFirstPartyTypeKind||(e.ZodFirstPartyTypeKind={})).ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly",e.instanceof=(t,r={message:`Input not instance of ${t.name}`})=>(0,e.custom)(e=>e instanceof t,r);var el=w.create;e.string=el;var eh=k.create;e.number=eh;var ep=er.create;e.nan=ep;var ef=E.create;e.bigint=ef;var em=I.create;e.boolean=em;var ey=x.create;e.date=ey;var eg=O.create;e.symbol=eg;var e_=S.create;e.undefined=e_;var ev=T.create;e.null=ev;var eb=C.create;e.any=eb;var ew=A.create;e.unknown=ew;var ek=F.create;e.never=ek;var eE=P.create;e.void=eE;var eI=N.create;e.array=eI;var ex=j.create;e.object=ex;var eO=j.strictCreate;e.strictObject=eO;var eS=Z.create;e.union=eS;var eT=B.create;e.discriminatedUnion=eT;var eC=L.create;e.intersection=eC;var eD=M.create;e.tuple=eD;var eA=q.create;e.record=eA;var eF=U.create;e.map=eF;var eP=z.create;e.set=eP;var eN=$.create;e.function=eN;var ej=V.create;e.lazy=ej;var eZ=J.create;e.literal=eZ;var eR=G.create;e.enum=eR;var eB=K.create;e.nativeEnum=eB;var eL=X.create;e.promise=eL;var eM=H.create;e.effect=eM,e.transformer=eM;var eq=Y.create;e.optional=eq;var eU=Q.create;e.nullable=eU;var ez=H.createWithPreprocess;e.preprocess=ez;var e$=eu.create;e.pipeline=e$,e.ostring=()=>el().optional(),e.onumber=()=>eh().optional(),e.oboolean=()=>em().optional(),e.coerce={string:e=>w.create({...e,coerce:!0}),number:e=>k.create({...e,coerce:!0}),boolean:e=>I.create({...e,coerce:!0}),bigint:e=>E.create({...e,coerce:!0}),date:e=>x.create({...e,coerce:!0})},e.NEVER=a.INVALID}),el=O(e=>{"use strict";D();var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(r,n)||t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(es(),e),r(eo(),e),r(eu(),e),r(en(),e),r(ec(),e),r(ei(),e)}),eh=O(e=>{"use strict";D();var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&t(n,e,i);return r(n,e),n},i=e&&e.__exportStar||function(e,r){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(r,n)||t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),e.z=void 0;var a=n(el());e.z=a,i(el(),e),e.default=a}),ep=O(e=>{"use strict";D(),Object.defineProperty(e,"__esModule",{value:!0}),e.joinPath=void 0;var t=/[$_\p{ID_Start}][$\u200c\u200d\p{ID_Continue}]*/u;e.joinPath=function(e){return 1===e.length?e[0].toString():e.reduce((e,r)=>{if("number"==typeof r)return e+"["+r.toString()+"]";if(r.includes('"'))return e+'["'+r.replace(/"/g,'\\"')+'"]';if(!t.test(r))return e+'["'+r+'"]';let n=0===e.length?"":".";return e+n+r},"")}}),ef=O(e=>{"use strict";D(),Object.defineProperty(e,"__esModule",{value:!0}),e.isNonEmptyArray=void 0,e.isNonEmptyArray=function(e){return 0!==e.length}}),em=O(e=>{"use strict";D();var t=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&t(n,e,i);return r(n,e),n};Object.defineProperty(e,"__esModule",{value:!0}),e.errorMap=e.isValidationErrorLike=e.isValidationError=e.toValidationError=e.fromZodError=e.fromZodIssue=e.ValidationError=void 0;var i=n(eh()),a=ep(),s=ef(),o=", or ",u="Validation error",d=class extends Error{details;name;constructor(e,t=[]){super(e),this.details=t,this.name="ZodValidationError"}toString(){return this.message}};function c(e,t,r){if("invalid_union"===e.code)return e.unionErrors.reduce((e,n)=>{let i=n.issues.map(e=>c(e,t,r)).join(t);return e.includes(i)||e.push(i),e},[]).join(r);if((0,s.isNonEmptyArray)(e.path)){if(1===e.path.length){let t=e.path[0];if("number"==typeof t)return`${e.message} at index ${t}`}return`${e.message} at "${(0,a.joinPath)(e.path)}"`}return e.message}function l(e,t,r){return null!==t?e.length>0?[t,e].join(r):t:e.length>0?e:u}function h(e,t={}){let{issueSeparator:r="; ",unionSeparator:n=o,prefixSeparator:i=": ",prefix:a=u}=t,s=l(c(e,r,n),a,i);return new d(s,[e])}function p(e,t={}){let{maxIssuesInMessage:r=99,issueSeparator:n="; ",unionSeparator:i=o,prefixSeparator:a=": ",prefix:s=u}=t,h=l(e.errors.slice(0,r).map(e=>c(e,n,i)).join(n),s,a);return new d(h,e.errors)}e.ValidationError=d,e.fromZodIssue=h,e.fromZodError=p,e.toValidationError=(e={})=>t=>t instanceof i.ZodError?p(t,e):t instanceof Error?t:Error("Unknown error"),e.isValidationError=function(e){return e instanceof d},e.isValidationErrorLike=function(e){return e instanceof Error&&"ZodValidationError"===e.name},e.errorMap=(e,t)=>({message:h({...e,message:e.message??t.defaultError}).message})}),ey=O(e=>{"use strict";D(),Object.defineProperty(e,"__esModule",{value:!0}),e.errorMap=e.fromZodIssue=e.fromZodError=e.isValidationErrorLike=e.isValidationError=e.toValidationError=e.ValidationError=void 0;var t=em();Object.defineProperty(e,"ValidationError",{enumerable:!0,get:function(){return t.ValidationError}}),Object.defineProperty(e,"toValidationError",{enumerable:!0,get:function(){return t.toValidationError}}),Object.defineProperty(e,"isValidationError",{enumerable:!0,get:function(){return t.isValidationError}}),Object.defineProperty(e,"isValidationErrorLike",{enumerable:!0,get:function(){return t.isValidationErrorLike}}),Object.defineProperty(e,"fromZodError",{enumerable:!0,get:function(){return t.fromZodError}}),Object.defineProperty(e,"fromZodIssue",{enumerable:!0,get:function(){return t.fromZodIssue}}),Object.defineProperty(e,"errorMap",{enumerable:!0,get:function(){return t.errorMap}})}),eg=O((e,t)=>{var r;D(),r=function(e){"use strict";var t="delete",r={};function n(){return{value:!1}}function i(e){e&&(e.value=!0)}function a(){}function s(e){return void 0===e.size&&(e.size=e.__iterate(u)),e.size}function o(e,t){if("number"!=typeof t){var r=t>>>0;if(""+r!==t||4294967295===r)return NaN;t=r}return t<0?s(e)+t:t}function u(){return!0}function d(e,t,r){return(0===e&&!l(e)||void 0!==r&&e<=-r)&&(void 0===t||void 0!==r&&t>=r)}function c(e,t,r){return void 0===e?r:l(e)?t===1/0?t:0|Math.max(0,t+e):void 0===t||t===e?e:0|Math.min(t,e)}function l(e){return e<0||0===e&&1/e==-1/0}var h="@@__IMMUTABLE_ITERABLE__@@";function p(e){return!!(e&&e[h])}var f="@@__IMMUTABLE_KEYED__@@";function m(e){return!!(e&&e[f])}var y="@@__IMMUTABLE_INDEXED__@@";function g(e){return!!(e&&e[y])}function _(e){return m(e)||g(e)}var v=function(e){return p(e)?e:q(e)},b=function(e){function t(e){return m(e)?e:U(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(v),w=function(e){function t(e){return g(e)?e:z(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(v),k=function(e){function t(e){return p(e)&&!_(e)?e:$(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(v);v.Keyed=b,v.Indexed=w,v.Set=k;var E="@@__IMMUTABLE_SEQ__@@";function I(e){return!!(e&&e[E])}var x="@@__IMMUTABLE_RECORD__@@";function O(e){return!!(e&&e[x])}function S(e){return p(e)||O(e)}var T="@@__IMMUTABLE_ORDERED__@@";function C(e){return!!(e&&e[T])}var D="function"==typeof Symbol&&Symbol.iterator,A="@@iterator",F=D||A,P=function(e){this.next=e};function N(e,t,r,n){var i=0===e?t:1===e?r:[t,r];return n?n.value=i:n={value:i,done:!1},n}function j(){return{value:void 0,done:!0}}function Z(e){return e&&"function"==typeof e.next}function R(e){var t=B(e);return t&&t.call(e)}function B(e){var t=e&&(D&&e[D]||e[A]);if("function"==typeof t)return t}P.prototype.toString=function(){return"[Iterator]"},P.KEYS=0,P.VALUES=1,P.ENTRIES=2,P.prototype.inspect=P.prototype.toSource=function(){return this.toString()},P.prototype[F]=function(){return this};var L=Object.prototype.hasOwnProperty;function M(e){return!!Array.isArray(e)||"string"==typeof e||e&&"object"==typeof e&&Number.isInteger(e.length)&&e.length>=0&&(0===e.length?1===Object.keys(e).length:e.hasOwnProperty(e.length-1))}var q=function(e){function t(e){return null==e?K():S(e)?e.toSeq():function(e){var t=Y(e);if(t)return t;if("object"==typeof e)return new J(e);throw TypeError("Expected Array or collection object of values, or keyed object: "+e)}(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.toSeq=function(){return this},t.prototype.toString=function(){return this.__toString("Seq {","}")},t.prototype.cacheResult=function(){return!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length),this},t.prototype.__iterate=function(e,t){var r=this._cache;if(r){for(var n=r.length,i=0;i!==n;){var a=r[t?n-++i:i++];if(!1===e(a[1],a[0],this))break}return i}return this.__iterateUncached(e,t)},t.prototype.__iterator=function(e,t){var r=this._cache;if(r){var n=r.length,i=0;return new P(function(){if(i===n)return j();var a=r[t?n-++i:i++];return N(e,a[0],a[1])})}return this.__iteratorUncached(e,t)},t}(v),U=function(e){function t(e){return null==e?K().toKeyedSeq():p(e)?m(e)?e.toSeq():e.fromEntrySeq():O(e)?e.toSeq():X(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.toKeyedSeq=function(){return this},t}(q),z=function(e){function t(e){return null==e?K():p(e)?m(e)?e.entrySeq():e.toIndexedSeq():O(e)?e.toSeq().entrySeq():H(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return t(arguments)},t.prototype.toIndexedSeq=function(){return this},t.prototype.toString=function(){return this.__toString("Seq [","]")},t}(q),$=function(e){function t(e){return(p(e)&&!_(e)?e:z(e)).toSetSeq()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return t(arguments)},t.prototype.toSetSeq=function(){return this},t}(q);q.isSeq=I,q.Keyed=U,q.Set=$,q.Indexed=z,q.prototype[E]=!0;var V=function(e){function t(e){this._array=e,this.size=e.length}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(e,t){return this.has(e)?this._array[o(this,e)]:t},t.prototype.__iterate=function(e,t){for(var r=this._array,n=r.length,i=0;i!==n;){var a=t?n-++i:i++;if(!1===e(r[a],a,this))break}return i},t.prototype.__iterator=function(e,t){var r=this._array,n=r.length,i=0;return new P(function(){if(i===n)return j();var a=t?n-++i:i++;return N(e,a,r[a])})},t}(z),J=function(e){function t(e){var t=Object.keys(e);this._object=e,this._keys=t,this.size=t.length}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(e,t){return void 0===t||this.has(e)?this._object[e]:t},t.prototype.has=function(e){return L.call(this._object,e)},t.prototype.__iterate=function(e,t){for(var r=this._object,n=this._keys,i=n.length,a=0;a!==i;){var s=n[t?i-++a:a++];if(!1===e(r[s],s,this))break}return a},t.prototype.__iterator=function(e,t){var r=this._object,n=this._keys,i=n.length,a=0;return new P(function(){if(a===i)return j();var s=n[t?i-++a:a++];return N(e,s,r[s])})},t}(U);J.prototype[T]=!0;var W,G=function(e){function t(e){this._collection=e,this.size=e.length||e.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.__iterateUncached=function(e,t){if(t)return this.cacheResult().__iterate(e,t);var r,n=R(this._collection),i=0;if(Z(n))for(;!(r=n.next()).done&&!1!==e(r.value,i++,this););return i},t.prototype.__iteratorUncached=function(e,t){if(t)return this.cacheResult().__iterator(e,t);var r=R(this._collection);if(!Z(r))return new P(j);var n=0;return new P(function(){var t=r.next();return t.done?t:N(e,n++,t.value)})},t}(z);function K(){return W||(W=new V([]))}function X(e){var t=Array.isArray(e)?new V(e):B(e)?new G(e):void 0;if(t)return t.fromEntrySeq();if("object"==typeof e)return new J(e);throw TypeError("Expected Array or collection object of [k, v] entries, or keyed object: "+e)}function H(e){var t=Y(e);if(t)return t;throw TypeError("Expected Array or collection object of values: "+e)}function Y(e){return M(e)?new V(e):B(e)?new G(e):void 0}var Q="@@__IMMUTABLE_MAP__@@";function ee(e){return!!(e&&e[Q])}function et(e){return ee(e)&&C(e)}function er(e){return!!(e&&"function"==typeof e.equals&&"function"==typeof e.hashCode)}function en(e,t){if(e===t||e!=e&&t!=t)return!0;if(!e||!t)return!1;if("function"==typeof e.valueOf&&"function"==typeof t.valueOf){if((e=e.valueOf())===(t=t.valueOf())||e!=e&&t!=t)return!0;if(!e||!t)return!1}return!!(er(e)&&er(t)&&e.equals(t))}var ei="function"==typeof Math.imul&&-2===Math.imul(4294967295,2)?Math.imul:function(e,t){e|=0,t|=0;var r=65535&e,n=65535&t;return r*n+((e>>>16)*n+r*(t>>>16)<<16>>>0)|0};function ea(e){return e>>>1&1073741824|3221225471&e}function es(e){if(!1===e||null==e||"function"==typeof e.valueOf&&(!1===(e=e.valueOf())||null==e))return 0;if(!0===e)return 1;var t,r,n=typeof e;if("number"===n){if(e!=e||e===1/0)return 0;var i=0|e;for(i!==e&&(i^=4294967295*e);e>4294967295;)e/=4294967295,i^=e;return ea(i)}if("string"===n)return e.length>ef?(void 0===(r=eg[t=e])&&(r=eo(t),ey===em&&(ey=0,eg={}),ey++,eg[t]=r),r):eo(e);if("function"==typeof e.hashCode)return ea(e.hashCode());if("object"===n||"function"===n)return function(e){var t;if(el&&void 0!==(t=eu.get(e))||void 0!==(t=e[ep])||!ec&&(void 0!==(t=e.propertyIsEnumerable&&e.propertyIsEnumerable[ep])||void 0!==(t=function(e){if(e&&e.nodeType>0)switch(e.nodeType){case 1:return e.uniqueID;case 9:return e.documentElement&&e.documentElement.uniqueID}}(e))))return t;if(t=++eh,1073741824&eh&&(eh=0),el)eu.set(e,t);else{if(void 0!==ed&&!1===ed(e))throw Error("Non-extensible objects are not allowed as keys.");if(ec)Object.defineProperty(e,ep,{enumerable:!1,configurable:!1,writable:!1,value:t});else if(void 0!==e.propertyIsEnumerable&&e.propertyIsEnumerable===e.constructor.prototype.propertyIsEnumerable)e.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},e.propertyIsEnumerable[ep]=t;else if(void 0!==e.nodeType)e[ep]=t;else throw Error("Unable to set a non-enumerable property on object.")}return t}(e);if("function"==typeof e.toString)return eo(e.toString());throw Error("Value type "+n+" cannot be hashed.")}function eo(e){for(var t=0,r=0;r<e.length;r++)t=31*t+e.charCodeAt(r)|0;return ea(t)}var eu,ed=Object.isExtensible,ec=function(){try{return Object.defineProperty({},"@",{}),!0}catch{return!1}}(),el="function"==typeof WeakMap;el&&(eu=new WeakMap);var eh=0,ep="__immutablehash__";"function"==typeof Symbol&&(ep=Symbol(ep));var ef=16,em=255,ey=0,eg={},e_=function(e){function t(e,t){this._iter=e,this._useKeys=t,this.size=e.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(e,t){return this._iter.get(e,t)},t.prototype.has=function(e){return this._iter.has(e)},t.prototype.valueSeq=function(){return this._iter.valueSeq()},t.prototype.reverse=function(){var e=this,t=eI(this,!0);return this._useKeys||(t.valueSeq=function(){return e._iter.toSeq().reverse()}),t},t.prototype.map=function(e,t){var r=this,n=eE(this,e,t);return this._useKeys||(n.valueSeq=function(){return r._iter.toSeq().map(e,t)}),n},t.prototype.__iterate=function(e,t){var r=this;return this._iter.__iterate(function(t,n){return e(t,n,r)},t)},t.prototype.__iterator=function(e,t){return this._iter.__iterator(e,t)},t}(U);e_.prototype[T]=!0;var ev=function(e){function t(e){this._iter=e,this.size=e.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.includes=function(e){return this._iter.includes(e)},t.prototype.__iterate=function(e,t){var r=this,n=0;return t&&s(this),this._iter.__iterate(function(i){return e(i,t?r.size-++n:n++,r)},t)},t.prototype.__iterator=function(e,t){var r=this,n=this._iter.__iterator(1,t),i=0;return t&&s(this),new P(function(){var a=n.next();return a.done?a:N(e,t?r.size-++i:i++,a.value,a)})},t}(z),eb=function(e){function t(e){this._iter=e,this.size=e.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.has=function(e){return this._iter.includes(e)},t.prototype.__iterate=function(e,t){var r=this;return this._iter.__iterate(function(t){return e(t,t,r)},t)},t.prototype.__iterator=function(e,t){var r=this._iter.__iterator(1,t);return new P(function(){var t=r.next();return t.done?t:N(e,t.value,t.value,t)})},t}($),ew=function(e){function t(e){this._iter=e,this.size=e.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.entrySeq=function(){return this._iter.toSeq()},t.prototype.__iterate=function(e,t){var r=this;return this._iter.__iterate(function(t){if(t){eN(t);var n=p(t);return e(n?t.get(1):t[1],n?t.get(0):t[0],r)}},t)},t.prototype.__iterator=function(e,t){var r=this._iter.__iterator(1,t);return new P(function(){for(;;){var t=r.next();if(t.done)return t;var n=t.value;if(n){eN(n);var i=p(n);return N(e,i?n.get(0):n[0],i?n.get(1):n[1],t)}}})},t}(U);function ek(e){var t=eZ(e);return t._iter=e,t.size=e.size,t.flip=function(){return e},t.reverse=function(){var t=e.reverse.apply(this);return t.flip=function(){return e.reverse()},t},t.has=function(t){return e.includes(t)},t.includes=function(t){return e.has(t)},t.cacheResult=eR,t.__iterateUncached=function(t,r){var n=this;return e.__iterate(function(e,r){return!1!==t(r,e,n)},r)},t.__iteratorUncached=function(t,r){if(2===t){var n=e.__iterator(t,r);return new P(function(){var e=n.next();if(!e.done){var t=e.value[0];e.value[0]=e.value[1],e.value[1]=t}return e})}return e.__iterator(1===t?0:1,r)},t}function eE(e,t,n){var i=eZ(e);return i.size=e.size,i.has=function(t){return e.has(t)},i.get=function(i,a){var s=e.get(i,r);return s===r?a:t.call(n,s,i,e)},i.__iterateUncached=function(r,i){var a=this;return e.__iterate(function(e,i,s){return!1!==r(t.call(n,e,i,s),i,a)},i)},i.__iteratorUncached=function(r,i){var a=e.__iterator(2,i);return new P(function(){var i=a.next();if(i.done)return i;var s=i.value,o=s[0];return N(r,o,t.call(n,s[1],o,e),i)})},i}function eI(e,t){var r=this,n=eZ(e);return n._iter=e,n.size=e.size,n.reverse=function(){return e},e.flip&&(n.flip=function(){var t=ek(e);return t.reverse=function(){return e.flip()},t}),n.get=function(r,n){return e.get(t?r:-1-r,n)},n.has=function(r){return e.has(t?r:-1-r)},n.includes=function(t){return e.includes(t)},n.cacheResult=eR,n.__iterate=function(r,n){var i=this,a=0;return n&&s(e),e.__iterate(function(e,s){return r(e,t?s:n?i.size-++a:a++,i)},!n)},n.__iterator=function(n,i){var a=0;i&&s(e);var o=e.__iterator(2,!i);return new P(function(){var e=o.next();if(e.done)return e;var s=e.value;return N(n,t?s[0]:i?r.size-++a:a++,s[1],e)})},n}function ex(e,t,n,i){var a=eZ(e);return i&&(a.has=function(i){var a=e.get(i,r);return a!==r&&!!t.call(n,a,i,e)},a.get=function(i,a){var s=e.get(i,r);return s!==r&&t.call(n,s,i,e)?s:a}),a.__iterateUncached=function(r,a){var s=this,o=0;return e.__iterate(function(e,a,u){if(t.call(n,e,a,u))return o++,r(e,i?a:o-1,s)},a),o},a.__iteratorUncached=function(r,a){var s=e.__iterator(2,a),o=0;return new P(function(){for(;;){var a=s.next();if(a.done)return a;var u=a.value,d=u[0],c=u[1];if(t.call(n,c,d,e))return N(r,i?d:o++,c,a)}})},a}function eO(e,t,r,n){var i=e.size;if(d(t,r,i))return e;var a=c(t,i,0),s=c(r,i,i);if(a!=a||s!=s)return eO(e.toSeq().cacheResult(),t,r,n);var u,l=s-a;l==l&&(u=l<0?0:l);var h=eZ(e);return h.size=0===u?u:e.size&&u||void 0,!n&&I(e)&&u>=0&&(h.get=function(t,r){return(t=o(this,t))>=0&&t<u?e.get(t+a,r):r}),h.__iterateUncached=function(t,r){var i=this;if(0===u)return 0;if(r)return this.cacheResult().__iterate(t,r);var s=0,o=!0,d=0;return e.__iterate(function(e,r){if(!(o&&(o=s++<a)))return d++,!1!==t(e,n?r:d-1,i)&&d!==u}),d},h.__iteratorUncached=function(t,r){if(0!==u&&r)return this.cacheResult().__iterator(t,r);if(0===u)return new P(j);var i=e.__iterator(t,r),s=0,o=0;return new P(function(){for(;s++<a;)i.next();if(++o>u)return j();var e=i.next();return n||1===t||e.done?e:0===t?N(t,o-1,void 0,e):N(t,o-1,e.value[1],e)})},h}function eS(e,t,r,n){var i=eZ(e);return i.__iterateUncached=function(i,a){var s=this;if(a)return this.cacheResult().__iterate(i,a);var o=!0,u=0;return e.__iterate(function(e,a,d){if(!(o&&(o=t.call(r,e,a,d))))return u++,i(e,n?a:u-1,s)}),u},i.__iteratorUncached=function(i,a){var s=this;if(a)return this.cacheResult().__iterator(i,a);var o=e.__iterator(2,a),u=!0,d=0;return new P(function(){var e,a,c;do{if((e=o.next()).done)return n||1===i?e:0===i?N(i,d++,void 0,e):N(i,d++,e.value[1],e);var l=e.value;a=l[0],c=l[1],u&&(u=t.call(r,c,a,s))}while(u);return 2===i?e:N(i,a,c,e)})},i}function eT(e,t,r){var n=eZ(e);return n.__iterateUncached=function(i,a){if(a)return this.cacheResult().__iterate(i,a);var s=0,o=!1;return function e(u,d){u.__iterate(function(a,u){return(!t||d<t)&&p(a)?e(a,d+1):(s++,!1===i(a,r?u:s-1,n)&&(o=!0)),!o},a)}(e,0),s},n.__iteratorUncached=function(n,i){if(i)return this.cacheResult().__iterator(n,i);var a=e.__iterator(n,i),s=[],o=0;return new P(function(){for(;a;){var e=a.next();if(!1!==e.done){a=s.pop();continue}var u=e.value;if(2===n&&(u=u[1]),!((!t||s.length<t)&&p(u)))return r?e:N(n,o++,u,e);s.push(a),a=u.__iterator(n,i)}return j()})},n}function eC(e,t,r){t||(t=eB);var n=m(e),i=0,a=e.toSeq().map(function(t,n){return[n,t,i++,r?r(t,n,e):t]}).valueSeq().toArray();return a.sort(function(e,r){return t(e[3],r[3])||e[2]-r[2]}).forEach(n?function(e,t){a[t].length=2}:function(e,t){a[t]=e[1]}),n?U(a):g(e)?z(a):$(a)}function eD(e,t,r){if(t||(t=eB),r){var n=e.toSeq().map(function(t,n){return[t,r(t,n,e)]}).reduce(function(e,r){return eA(t,e[1],r[1])?r:e});return n&&n[0]}return e.reduce(function(e,r){return eA(t,e,r)?r:e})}function eA(e,t,r){var n=e(r,t);return 0===n&&r!==t&&(null==r||r!=r)||n>0}function eF(e,t,r,n){var i=eZ(e),a=new V(r).map(function(e){return e.size});return i.size=n?a.max():a.min(),i.__iterate=function(e,t){for(var r,n=this.__iterator(1,t),i=0;!(r=n.next()).done&&!1!==e(r.value,i++,this););return i},i.__iteratorUncached=function(e,i){var a=r.map(function(e){return e=v(e),R(i?e.reverse():e)}),s=0,o=!1;return new P(function(){var r;return o||(r=a.map(function(e){return e.next()}),o=n?r.every(function(e){return e.done}):r.some(function(e){return e.done})),o?j():N(e,s++,t.apply(null,r.map(function(e){return e.value})))})},i}function eP(e,t){return e===t?e:I(e)?t:e.constructor(t)}function eN(e){if(e!==Object(e))throw TypeError("Expected [K, V] tuple: "+e)}function ej(e){return m(e)?b:g(e)?w:k}function eZ(e){return Object.create((m(e)?U:g(e)?z:$).prototype)}function eR(){return this._iter.cacheResult?(this._iter.cacheResult(),this.size=this._iter.size,this):q.prototype.cacheResult.call(this)}function eB(e,t){return void 0===e&&void 0===t?0:void 0===e?1:void 0===t?-1:e>t?1:e<t?-1:0}function eL(e,t){t=t||0;for(var r=Math.max(0,e.length-t),n=Array(r),i=0;i<r;i++)n[i]=e[i+t];return n}function eM(e,t){if(!e)throw Error(t)}function eq(e){eM(e!==1/0,"Cannot perform this action with an infinite size.")}function eU(e){if(M(e)&&"string"!=typeof e)return e;if(C(e))return e.toArray();throw TypeError("Invalid keyPath: expected Ordered Collection or Array: "+e)}function ez(e){return e&&(e.constructor&&"Object"===e.constructor.name||void 0===e.constructor)}function e$(e){return"object"==typeof e&&(S(e)||Array.isArray(e)||ez(e))}function eV(e){try{return"string"==typeof e?JSON.stringify(e):String(e)}catch{return JSON.stringify(e)}}function eJ(e,t){return S(e)?e.has(t):e$(e)&&L.call(e,t)}function eW(e,t,r){return S(e)?e.get(t,r):eJ(e,t)?"function"==typeof e.get?e.get(t):e[t]:r}function eG(e){if(Array.isArray(e))return eL(e);var t={};for(var r in e)L.call(e,r)&&(t[r]=e[r]);return t}function eK(e,t){if(!e$(e))throw TypeError("Cannot update non-data-structure value: "+e);if(S(e)){if(!e.remove)throw TypeError("Cannot update immutable value without .remove() method: "+e);return e.remove(t)}if(!L.call(e,t))return e;var r=eG(e);return Array.isArray(r)?r.splice(t,1):delete r[t],r}function eX(e,t,r){if(!e$(e))throw TypeError("Cannot update non-data-structure value: "+e);if(S(e)){if(!e.set)throw TypeError("Cannot update immutable value without .set() method: "+e);return e.set(t,r)}if(L.call(e,t)&&r===e[t])return e;var n=eG(e);return n[t]=r,n}function eH(e,t,n,i){i||(i=n,n=void 0);var a=function e(t,n,i,a,s,o){var u=n===r;if(a===i.length){var d=u?s:n,c=o(d);return c===d?n:c}if(!u&&!e$(n))throw TypeError("Cannot update within non-data-structure value in path ["+i.slice(0,a).map(eV)+"]: "+n);var l=i[a],h=u?r:eW(n,l,r),p=e(h===r?t:S(h),h,i,a+1,s,o);return p===h?n:p===r?eK(n,l):eX(u?t?tE():{}:n,l,p)}(S(e),e,eU(t),0,n,i);return a===r?n:a}function eY(e,t,n){return eH(e,t,r,function(){return n})}function eQ(e,t){return eY(this,e,t)}function e0(e,t){return eH(e,t,function(){return r})}function e1(e){return e0(this,e)}function e2(e,t,r,n){return eH(e,[t],r,n)}function e4(e,t,r){return 1==arguments.length?e(this):e2(this,e,t,r)}function e3(e,t,r){return eH(this,e,t,r)}function e6(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return e5(this,e)}function e7(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];if("function"!=typeof e)throw TypeError("Invalid merger function: "+e);return e5(this,t,e)}function e5(e,t,n){for(var i=[],a=0;a<t.length;a++){var s=b(t[a]);0!==s.size&&i.push(s)}return 0===i.length?e:0!==e.toSeq().size||e.__ownerID||1!==i.length?e.withMutations(function(e){for(var t=n?function(t,i){e2(e,i,r,function(e){return e===r?t:n(e,t,i)})}:function(t,r){e.set(r,t)},a=0;a<i.length;a++)i[a].forEach(t)}):e.constructor(i[0])}function e8(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return tn(e,t)}function e9(e,t){for(var r=[],n=arguments.length-2;n-- >0;)r[n]=arguments[n+2];return tn(t,r,e)}function te(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return tr(e,t)}function tt(e,t){for(var r=[],n=arguments.length-2;n-- >0;)r[n]=arguments[n+2];return tr(t,r,e)}function tr(e,t,r){return tn(e,t,function e(t,n,i){return e$(t)&&e$(n)?tn(t,[n],e):r?r(t,n,i):n})}function tn(e,t,r){if(!e$(e))throw TypeError("Cannot merge into non-data-structure value: "+e);if(S(e))return"function"==typeof r&&e.mergeWith?e.mergeWith.apply(e,[r].concat(t)):e.merge?e.merge.apply(e,t):e.concat.apply(e,t);for(var n=Array.isArray(e),i=e,a=n?w:b,s=n?function(t){i===e&&(i=eG(i)),i.push(t)}:function(t,n){var a=L.call(i,n),s=a&&r?r(i[n],t,n):t;a&&s===i[n]||(i===e&&(i=eG(i)),i[n]=s)},o=0;o<t.length;o++)a(t[o]).forEach(s);return i}function ti(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return tr(this,e)}function ta(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return tr(this,t,e)}function ts(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return eH(this,e,tE(),function(e){return tn(e,t)})}function to(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return eH(this,e,tE(),function(e){return tr(e,t)})}function tu(e){var t=this.asMutable();return e(t),t.wasAltered()?t.__ensureOwner(this.__ownerID):this}function td(){return this.__ownerID?this:this.__ensureOwner(new a)}function tc(){return this.__ensureOwner()}function tl(){return this.__altered}ev.prototype.cacheResult=e_.prototype.cacheResult=eb.prototype.cacheResult=ew.prototype.cacheResult=eR;var th=function(e){function t(t){return null==t?tE():ee(t)&&!C(t)?t:tE().withMutations(function(r){var n=e(t);eq(n.size),n.forEach(function(e,t){return r.set(t,e)})})}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return tE().withMutations(function(t){for(var r=0;r<e.length;r+=2){if(r+1>=e.length)throw Error("Missing value for key: "+e[r]);t.set(e[r],e[r+1])}})},t.prototype.toString=function(){return this.__toString("Map {","}")},t.prototype.get=function(e,t){return this._root?this._root.get(0,void 0,e,t):t},t.prototype.set=function(e,t){return tI(this,e,t)},t.prototype.remove=function(e){return tI(this,e,r)},t.prototype.deleteAll=function(e){var t=v(e);return 0===t.size?this:this.withMutations(function(e){t.forEach(function(t){return e.remove(t)})})},t.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._root=null,this.__hash=void 0,this.__altered=!0,this):tE()},t.prototype.sort=function(e){return tW(eC(this,e))},t.prototype.sortBy=function(e,t){return tW(eC(this,t,e))},t.prototype.map=function(e,t){return this.withMutations(function(r){r.forEach(function(n,i){r.set(i,e.call(t,n,i,r))})})},t.prototype.__iterator=function(e,t){return new tv(this,e,t)},t.prototype.__iterate=function(e,t){var r=this,n=0;return this._root&&this._root.iterate(function(t){return n++,e(t[1],t[0],r)},t),n},t.prototype.__ensureOwner=function(e){return e===this.__ownerID?this:e?tk(this.size,this._root,e,this.__hash):0===this.size?tE():(this.__ownerID=e,this.__altered=!1,this)},t}(b);th.isMap=ee;var tp=th.prototype;tp[Q]=!0,tp[t]=tp.remove,tp.removeAll=tp.deleteAll,tp.setIn=eQ,tp.removeIn=tp.deleteIn=e1,tp.update=e4,tp.updateIn=e3,tp.merge=tp.concat=e6,tp.mergeWith=e7,tp.mergeDeep=ti,tp.mergeDeepWith=ta,tp.mergeIn=ts,tp.mergeDeepIn=to,tp.withMutations=tu,tp.wasAltered=tl,tp.asImmutable=tc,tp["@@transducer/init"]=tp.asMutable=td,tp["@@transducer/step"]=function(e,t){return e.set(t[0],t[1])},tp["@@transducer/result"]=function(e){return e.asImmutable()};var tf=function(e,t){this.ownerID=e,this.entries=t};tf.prototype.get=function(e,t,r,n){for(var i=this.entries,a=0,s=i.length;a<s;a++)if(en(r,i[a][0]))return i[a][1];return n},tf.prototype.update=function(e,t,n,s,o,u,d){for(var c=o===r,l=this.entries,h=0,p=l.length;h<p&&!en(s,l[h][0]);h++);var f=h<p;if(f?l[h][1]===o:c)return this;if(i(d),(c||!f)&&i(u),!(c&&1===l.length)){if(!f&&!c&&l.length>=tD)return function(e,t,r,n){e||(e=new a);for(var i=new t_(e,es(r),[r,n]),s=0;s<t.length;s++){var o=t[s];i=i.update(e,0,void 0,o[0],o[1])}return i}(e,l,s,o);var m=e&&e===this.ownerID,y=m?l:eL(l);return f?c?h===p-1?y.pop():y[h]=y.pop():y[h]=[s,o]:y.push([s,o]),m?(this.entries=y,this):new tf(e,y)}};var tm=function(e,t,r){this.ownerID=e,this.bitmap=t,this.nodes=r};tm.prototype.get=function(e,t,r,n){void 0===t&&(t=es(r));var i=1<<((0===e?t:t>>>e)&31),a=this.bitmap;return a&i?this.nodes[tT(a&i-1)].get(e+5,t,r,n):n},tm.prototype.update=function(e,t,n,i,a,s,o){void 0===n&&(n=es(i));var u=(0===t?n:n>>>t)&31,d=1<<u,c=this.bitmap,l=(c&d)!=0;if(!l&&a===r)return this;var h=tT(c&d-1),p=this.nodes,f=l?p[h]:void 0,m=tx(f,e,t+5,n,i,a,s,o);if(m===f)return this;if(!l&&m&&p.length>=tA)return function(e,t,r,n,i){for(var a=0,s=Array(32),o=0;0!==r;o++,r>>>=1)s[o]=1&r?t[a++]:void 0;return s[n]=i,new ty(e,a+1,s)}(e,p,c,u,m);if(l&&!m&&2===p.length&&tO(p[1^h]))return p[1^h];if(l&&m&&1===p.length&&tO(m))return m;var y=e&&e===this.ownerID,g=l?m?c:c^d:c|d,_=l?m?tC(p,h,m,y):function(e,t,r){var n=e.length-1;if(r&&t===n)return e.pop(),e;for(var i=Array(n),a=0,s=0;s<n;s++)s===t&&(a=1),i[s]=e[s+a];return i}(p,h,y):function(e,t,r,n){var i=e.length+1;if(n&&t+1===i)return e[t]=r,e;for(var a=Array(i),s=0,o=0;o<i;o++)o===t?(a[o]=r,s=-1):a[o]=e[o+s];return a}(p,h,m,y);return y?(this.bitmap=g,this.nodes=_,this):new tm(e,g,_)};var ty=function(e,t,r){this.ownerID=e,this.count=t,this.nodes=r};ty.prototype.get=function(e,t,r,n){void 0===t&&(t=es(r));var i=(0===e?t:t>>>e)&31,a=this.nodes[i];return a?a.get(e+5,t,r,n):n},ty.prototype.update=function(e,t,n,i,a,s,o){void 0===n&&(n=es(i));var u=(0===t?n:n>>>t)&31,d=a===r,c=this.nodes,l=c[u];if(d&&!l)return this;var h=tx(l,e,t+5,n,i,a,s,o);if(h===l)return this;var p=this.count;if(l){if(!h&&--p<tF)return function(e,t,r,n){for(var i=0,a=0,s=Array(r),o=0,u=1,d=t.length;o<d;o++,u<<=1){var c=t[o];void 0!==c&&o!==n&&(i|=u,s[a++]=c)}return new tm(e,i,s)}(e,c,p,u)}else p++;var f=e&&e===this.ownerID,m=tC(c,u,h,f);return f?(this.count=p,this.nodes=m,this):new ty(e,p,m)};var tg=function(e,t,r){this.ownerID=e,this.keyHash=t,this.entries=r};tg.prototype.get=function(e,t,r,n){for(var i=this.entries,a=0,s=i.length;a<s;a++)if(en(r,i[a][0]))return i[a][1];return n},tg.prototype.update=function(e,t,n,a,s,o,u){void 0===n&&(n=es(a));var d=s===r;if(n!==this.keyHash)return d?this:(i(u),i(o),tS(this,e,t,n,[a,s]));for(var c=this.entries,l=0,h=c.length;l<h&&!en(a,c[l][0]);l++);var p=l<h;if(p?c[l][1]===s:d)return this;if(i(u),(d||!p)&&i(o),d&&2===h)return new t_(e,this.keyHash,c[1^l]);var f=e&&e===this.ownerID,m=f?c:eL(c);return p?d?l===h-1?m.pop():m[l]=m.pop():m[l]=[a,s]:m.push([a,s]),f?(this.entries=m,this):new tg(e,this.keyHash,m)};var t_=function(e,t,r){this.ownerID=e,this.keyHash=t,this.entry=r};t_.prototype.get=function(e,t,r,n){return en(r,this.entry[0])?this.entry[1]:n},t_.prototype.update=function(e,t,n,a,s,o,u){var d=s===r,c=en(a,this.entry[0]);if(c?s===this.entry[1]:d)return this;if(i(u),d){i(o);return}return c?e&&e===this.ownerID?(this.entry[1]=s,this):new t_(e,this.keyHash,[a,s]):(i(o),tS(this,e,t,es(a),[a,s]))},tf.prototype.iterate=tg.prototype.iterate=function(e,t){for(var r=this.entries,n=0,i=r.length-1;n<=i;n++)if(!1===e(r[t?i-n:n]))return!1},tm.prototype.iterate=ty.prototype.iterate=function(e,t){for(var r=this.nodes,n=0,i=r.length-1;n<=i;n++){var a=r[t?i-n:n];if(a&&!1===a.iterate(e,t))return!1}},t_.prototype.iterate=function(e,t){return e(this.entry)};var tv=function(e){function t(e,t,r){this._type=t,this._reverse=r,this._stack=e._root&&tw(e._root)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.next=function(){for(var e=this._type,t=this._stack;t;){var r=t.node,n=t.index++,i=void 0;if(r.entry){if(0===n)return tb(e,r.entry)}else if(r.entries){if(n<=(i=r.entries.length-1))return tb(e,r.entries[this._reverse?i-n:n])}else if(n<=(i=r.nodes.length-1)){var a=r.nodes[this._reverse?i-n:n];if(a){if(a.entry)return tb(e,a.entry);t=this._stack=tw(a,t)}continue}t=this._stack=this._stack.__prev}return j()},t}(P);function tb(e,t){return N(e,t[0],t[1])}function tw(e,t){return{node:e,index:0,__prev:t}}function tk(e,t,r,n){var i=Object.create(tp);return i.size=e,i._root=t,i.__ownerID=r,i.__hash=n,i.__altered=!1,i}function tE(){return ri||(ri=tk(0))}function tI(e,t,i){var a,s;if(e._root){var o=n(),u=n();if(a=tx(e._root,e.__ownerID,0,void 0,t,i,o,u),!u.value)return e;s=e.size+(o.value?i===r?-1:1:0)}else{if(i===r)return e;s=1,a=new tf(e.__ownerID,[[t,i]])}return e.__ownerID?(e.size=s,e._root=a,e.__hash=void 0,e.__altered=!0,e):a?tk(s,a):tE()}function tx(e,t,n,a,s,o,u,d){return e?e.update(t,n,a,s,o,u,d):o===r?e:(i(d),i(u),new t_(t,a,[s,o]))}function tO(e){return e.constructor===t_||e.constructor===tg}function tS(e,t,r,n,i){if(e.keyHash===n)return new tg(t,n,[e.entry,i]);var a,s=(0===r?e.keyHash:e.keyHash>>>r)&31,o=(0===r?n:n>>>r)&31,u=s===o?[tS(e,t,r+5,n,i)]:(a=new t_(t,n,i),s<o?[e,a]:[a,e]);return new tm(t,1<<s|1<<o,u)}function tT(e){return e-=e>>1&1431655765,e=(e=(858993459&e)+(e>>2&858993459))+(e>>4)&252645135,e+=e>>8,127&(e+=e>>16)}function tC(e,t,r,n){var i=n?e:eL(e);return i[t]=r,i}var tD=8,tA=16,tF=8,tP="@@__IMMUTABLE_LIST__@@";function tN(e){return!!(e&&e[tP])}var tj=function(e){function t(t){var r=tq();if(null==t)return r;if(tN(t))return t;var n=e(t),i=n.size;return 0===i?r:(eq(i),i>0&&i<32?tM(0,i,5,null,new tR(n.toArray())):r.withMutations(function(e){e.setSize(i),n.forEach(function(t,r){return e.set(r,t)})}))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.prototype.toString=function(){return this.__toString("List [","]")},t.prototype.get=function(e,t){if((e=o(this,e))>=0&&e<this.size){var r=t$(this,e+=this._origin);return r&&r.array[31&e]}return t},t.prototype.set=function(e,t){return function(e,t,r){if((t=o(e,t))!=t)return e;if(t>=e.size||t<0)return e.withMutations(function(e){t<0?tV(e,t).set(0,r):tV(e,0,t+1).set(t,r)});t+=e._origin;var i=e._tail,a=e._root,s=n();return t>=tJ(e._capacity)?i=tU(i,e.__ownerID,0,t,r,s):a=tU(a,e.__ownerID,e._level,t,r,s),s.value?e.__ownerID?(e._root=a,e._tail=i,e.__hash=void 0,e.__altered=!0,e):tM(e._origin,e._capacity,e._level,a,i):e}(this,e,t)},t.prototype.remove=function(e){return this.has(e)?0===e?this.shift():e===this.size-1?this.pop():this.splice(e,1):this},t.prototype.insert=function(e,t){return this.splice(e,0,t)},t.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=this._origin=this._capacity=0,this._level=5,this._root=this._tail=null,this.__hash=void 0,this.__altered=!0,this):tq()},t.prototype.push=function(){var e=arguments,t=this.size;return this.withMutations(function(r){tV(r,0,t+e.length);for(var n=0;n<e.length;n++)r.set(t+n,e[n])})},t.prototype.pop=function(){return tV(this,0,-1)},t.prototype.unshift=function(){var e=arguments;return this.withMutations(function(t){tV(t,-e.length);for(var r=0;r<e.length;r++)t.set(r,e[r])})},t.prototype.shift=function(){return tV(this,1)},t.prototype.concat=function(){for(var t=arguments,r=[],n=0;n<arguments.length;n++){var i=t[n],a=e("string"!=typeof i&&B(i)?i:[i]);0!==a.size&&r.push(a)}return 0===r.length?this:0!==this.size||this.__ownerID||1!==r.length?this.withMutations(function(e){r.forEach(function(t){return t.forEach(function(t){return e.push(t)})})}):this.constructor(r[0])},t.prototype.setSize=function(e){return tV(this,0,e)},t.prototype.map=function(e,t){var r=this;return this.withMutations(function(n){for(var i=0;i<r.size;i++)n.set(i,e.call(t,n.get(i),i,n))})},t.prototype.slice=function(e,t){var r=this.size;return d(e,t,r)?this:tV(this,c(e,r,0),c(t,r,r))},t.prototype.__iterator=function(e,t){var r=t?this.size:0,n=tL(this,t);return new P(function(){var i=n();return i===tB?j():N(e,t?--r:r++,i)})},t.prototype.__iterate=function(e,t){for(var r,n=t?this.size:0,i=tL(this,t);(r=i())!==tB&&!1!==e(r,t?--n:n++,this););return n},t.prototype.__ensureOwner=function(e){return e===this.__ownerID?this:e?tM(this._origin,this._capacity,this._level,this._root,this._tail,e,this.__hash):0===this.size?tq():(this.__ownerID=e,this.__altered=!1,this)},t}(w);tj.isList=tN;var tZ=tj.prototype;tZ[tP]=!0,tZ[t]=tZ.remove,tZ.merge=tZ.concat,tZ.setIn=eQ,tZ.deleteIn=tZ.removeIn=e1,tZ.update=e4,tZ.updateIn=e3,tZ.mergeIn=ts,tZ.mergeDeepIn=to,tZ.withMutations=tu,tZ.wasAltered=tl,tZ.asImmutable=tc,tZ["@@transducer/init"]=tZ.asMutable=td,tZ["@@transducer/step"]=function(e,t){return e.push(t)},tZ["@@transducer/result"]=function(e){return e.asImmutable()};var tR=function(e,t){this.array=e,this.ownerID=t};tR.prototype.removeBefore=function(e,t,r){if(r===t?1<<t:0===this.array.length)return this;var n=r>>>t&31;if(n>=this.array.length)return new tR([],e);var i,a=0===n;if(t>0){var s=this.array[n];if((i=s&&s.removeBefore(e,t-5,r))===s&&a)return this}if(a&&!i)return this;var o=tz(this,e);if(!a)for(var u=0;u<n;u++)o.array[u]=void 0;return i&&(o.array[n]=i),o},tR.prototype.removeAfter=function(e,t,r){if(r===(t?1<<t:0)||0===this.array.length)return this;var n,i=r-1>>>t&31;if(i>=this.array.length)return this;if(t>0){var a=this.array[i];if((n=a&&a.removeAfter(e,t-5,r))===a&&i===this.array.length-1)return this}var s=tz(this,e);return s.array.splice(i+1),n&&(s.array[i]=n),s};var tB={};function tL(e,t){var r=e._origin,n=e._capacity,i=tJ(n),a=e._tail;return function e(s,o,u){var d,c,l,h,p,f,m;return 0===o?(d=u===i?a&&a.array:s&&s.array,c=u>r?0:r-u,(l=n-u)>32&&(l=32),function(){if(c===l)return tB;var e=t?--l:c++;return d&&d[e]}):(p=s&&s.array,f=u>r?0:r-u>>o,(m=(n-u>>o)+1)>32&&(m=32),function(){for(;;){if(h){var r=h();if(r!==tB)return r;h=null}if(f===m)return tB;var n=t?--m:f++;h=e(p&&p[n],o-5,u+(n<<o))}})}(e._root,e._level,0)}function tM(e,t,r,n,i,a,s){var o=Object.create(tZ);return o.size=t-e,o._origin=e,o._capacity=t,o._level=r,o._root=n,o._tail=i,o.__ownerID=a,o.__hash=s,o.__altered=!1,o}function tq(){return ra||(ra=tM(0,0,5))}function tU(e,t,r,n,a,s){var o,u=n>>>r&31,d=e&&u<e.array.length;if(!d&&void 0===a)return e;if(r>0){var c=e&&e.array[u],l=tU(c,t,r-5,n,a,s);return l===c?e:((o=tz(e,t)).array[u]=l,o)}return d&&e.array[u]===a?e:(s&&i(s),o=tz(e,t),void 0===a&&u===o.array.length-1?o.array.pop():o.array[u]=a,o)}function tz(e,t){return t&&e&&t===e.ownerID?e:new tR(e?e.array.slice():[],t)}function t$(e,t){if(t>=tJ(e._capacity))return e._tail;if(t<1<<e._level+5){for(var r=e._root,n=e._level;r&&n>0;)r=r.array[t>>>n&31],n-=5;return r}}function tV(e,t,r){void 0!==t&&(t|=0),void 0!==r&&(r|=0);var n=e.__ownerID||new a,i=e._origin,s=e._capacity,o=i+t,u=void 0===r?s:r<0?s+r:i+r;if(o===i&&u===s)return e;if(o>=u)return e.clear();for(var d=e._level,c=e._root,l=0;o+l<0;)c=new tR(c&&c.array.length?[void 0,c]:[],n),d+=5,l+=1<<d;l&&(o+=l,i+=l,u+=l,s+=l);for(var h=tJ(s),p=tJ(u);p>=1<<d+5;)c=new tR(c&&c.array.length?[c]:[],n),d+=5;var f=e._tail,m=p<h?t$(e,u-1):p>h?new tR([],n):f;if(f&&p>h&&o<s&&f.array.length){c=tz(c,n);for(var y=c,g=d;g>5;g-=5){var _=h>>>g&31;y=y.array[_]=tz(y.array[_],n)}y.array[h>>>5&31]=f}if(u<s&&(m=m&&m.removeAfter(n,0,u)),o>=p)o-=p,u-=p,d=5,c=null,m=m&&m.removeBefore(n,0,o);else if(o>i||p<h){for(l=0;c;){var v=o>>>d&31;if(v!==p>>>d&31)break;v&&(l+=(1<<d)*v),d-=5,c=c.array[v]}c&&o>i&&(c=c.removeBefore(n,d,o-l)),c&&p<h&&(c=c.removeAfter(n,d,p-l)),l&&(o-=l,u-=l)}return e.__ownerID?(e.size=u-o,e._origin=o,e._capacity=u,e._level=d,e._root=c,e._tail=m,e.__hash=void 0,e.__altered=!0,e):tM(o,u,d,c,m)}function tJ(e){return e<32?0:e-1>>>5<<5}var tW=function(e){function t(e){return null==e?tK():et(e)?e:tK().withMutations(function(t){var r=b(e);eq(r.size),r.forEach(function(e,r){return t.set(r,e)})})}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.prototype.toString=function(){return this.__toString("OrderedMap {","}")},t.prototype.get=function(e,t){var r=this._map.get(e);return void 0!==r?this._list.get(r)[1]:t},t.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._map.clear(),this._list.clear(),this):tK()},t.prototype.set=function(e,t){return tX(this,e,t)},t.prototype.remove=function(e){return tX(this,e,r)},t.prototype.wasAltered=function(){return this._map.wasAltered()||this._list.wasAltered()},t.prototype.__iterate=function(e,t){var r=this;return this._list.__iterate(function(t){return t&&e(t[1],t[0],r)},t)},t.prototype.__iterator=function(e,t){return this._list.fromEntrySeq().__iterator(e,t)},t.prototype.__ensureOwner=function(e){if(e===this.__ownerID)return this;var t=this._map.__ensureOwner(e),r=this._list.__ensureOwner(e);return e?tG(t,r,e,this.__hash):0===this.size?tK():(this.__ownerID=e,this._map=t,this._list=r,this)},t}(th);function tG(e,t,r,n){var i=Object.create(tW.prototype);return i.size=e?e.size:0,i._map=e,i._list=t,i.__ownerID=r,i.__hash=n,i}function tK(){return rs||(rs=tG(tE(),tq()))}function tX(e,t,n){var i,a,s=e._map,o=e._list,u=s.get(t),d=void 0!==u;if(n===r){if(!d)return e;o.size>=32&&o.size>=2*s.size?(i=(a=o.filter(function(e,t){return void 0!==e&&u!==t})).toKeyedSeq().map(function(e){return e[0]}).flip().toMap(),e.__ownerID&&(i.__ownerID=a.__ownerID=e.__ownerID)):(i=s.remove(t),a=u===o.size-1?o.pop():o.set(u,void 0))}else if(d){if(n===o.get(u)[1])return e;i=s,a=o.set(u,[t,n])}else i=s.set(t,o.size),a=o.set(o.size,[t,n]);return e.__ownerID?(e.size=i.size,e._map=i,e._list=a,e.__hash=void 0,e):tG(i,a)}tW.isOrderedMap=et,tW.prototype[T]=!0,tW.prototype[t]=tW.prototype.remove;var tH="@@__IMMUTABLE_STACK__@@";function tY(e){return!!(e&&e[tH])}var tQ=function(e){function t(e){return null==e?t2():tY(e)?e:t2().pushAll(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.prototype.toString=function(){return this.__toString("Stack [","]")},t.prototype.get=function(e,t){var r=this._head;for(e=o(this,e);r&&e--;)r=r.next;return r?r.value:t},t.prototype.peek=function(){return this._head&&this._head.value},t.prototype.push=function(){var e=arguments;if(0==arguments.length)return this;for(var t=this.size+arguments.length,r=this._head,n=arguments.length-1;n>=0;n--)r={value:e[n],next:r};return this.__ownerID?(this.size=t,this._head=r,this.__hash=void 0,this.__altered=!0,this):t1(t,r)},t.prototype.pushAll=function(t){if(0===(t=e(t)).size)return this;if(0===this.size&&tY(t))return t;eq(t.size);var r=this.size,n=this._head;return t.__iterate(function(e){r++,n={value:e,next:n}},!0),this.__ownerID?(this.size=r,this._head=n,this.__hash=void 0,this.__altered=!0,this):t1(r,n)},t.prototype.pop=function(){return this.slice(1)},t.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._head=void 0,this.__hash=void 0,this.__altered=!0,this):t2()},t.prototype.slice=function(t,r){if(d(t,r,this.size))return this;var n,i=c(t,this.size,0);if(c(r,n=this.size,n)!==this.size)return e.prototype.slice.call(this,t,r);for(var a=this.size-i,s=this._head;i--;)s=s.next;return this.__ownerID?(this.size=a,this._head=s,this.__hash=void 0,this.__altered=!0,this):t1(a,s)},t.prototype.__ensureOwner=function(e){return e===this.__ownerID?this:e?t1(this.size,this._head,e,this.__hash):0===this.size?t2():(this.__ownerID=e,this.__altered=!1,this)},t.prototype.__iterate=function(e,t){var r=this;if(t)return new V(this.toArray()).__iterate(function(t,n){return e(t,n,r)},t);for(var n=0,i=this._head;i&&!1!==e(i.value,n++,r);)i=i.next;return n},t.prototype.__iterator=function(e,t){if(t)return new V(this.toArray()).__iterator(e,t);var r=0,n=this._head;return new P(function(){if(n){var t=n.value;return n=n.next,N(e,r++,t)}return j()})},t}(w);tQ.isStack=tY;var t0=tQ.prototype;function t1(e,t,r,n){var i=Object.create(t0);return i.size=e,i._head=t,i.__ownerID=r,i.__hash=n,i.__altered=!1,i}function t2(){return ro||(ro=t1(0))}t0[tH]=!0,t0.shift=t0.pop,t0.unshift=t0.push,t0.unshiftAll=t0.pushAll,t0.withMutations=tu,t0.wasAltered=tl,t0.asImmutable=tc,t0["@@transducer/init"]=t0.asMutable=td,t0["@@transducer/step"]=function(e,t){return e.unshift(t)},t0["@@transducer/result"]=function(e){return e.asImmutable()};var t4="@@__IMMUTABLE_SET__@@";function t3(e){return!!(e&&e[t4])}function t6(e){return t3(e)&&C(e)}function t7(e,t){if(e===t)return!0;if(!p(t)||void 0!==e.size&&void 0!==t.size&&e.size!==t.size||void 0!==e.__hash&&void 0!==t.__hash&&e.__hash!==t.__hash||m(e)!==m(t)||g(e)!==g(t)||C(e)!==C(t))return!1;if(0===e.size&&0===t.size)return!0;var n=!_(e);if(C(e)){var i=e.entries();return t.every(function(e,t){var r=i.next().value;return r&&en(r[1],e)&&(n||en(r[0],t))})&&i.next().done}var a=!1;if(void 0===e.size){if(void 0===t.size)"function"==typeof e.cacheResult&&e.cacheResult();else{a=!0;var s=e;e=t,t=s}}var o=!0,u=t.__iterate(function(t,i){if(n?!e.has(t):a?!en(t,e.get(i,r)):!en(e.get(i,r),t))return o=!1,!1});return o&&e.size===u}function t5(e,t){var r=function(r){e.prototype[r]=t[r]};return Object.keys(t).forEach(r),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(t).forEach(r),e}function t8(e){if(!e||"object"!=typeof e)return e;if(!p(e)){if(!e$(e))return e;e=q(e)}if(m(e)){var t={};return e.__iterate(function(e,r){t[r]=t8(e)}),t}var r=[];return e.__iterate(function(e){r.push(t8(e))}),r}var t9=function(e){function t(t){return null==t?rn():t3(t)&&!C(t)?t:rn().withMutations(function(r){var n=e(t);eq(n.size),n.forEach(function(e){return r.add(e)})})}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.fromKeys=function(e){return this(b(e).keySeq())},t.intersect=function(e){return(e=v(e).toArray()).length?re.intersect.apply(t(e.pop()),e):rn()},t.union=function(e){return(e=v(e).toArray()).length?re.union.apply(t(e.pop()),e):rn()},t.prototype.toString=function(){return this.__toString("Set {","}")},t.prototype.has=function(e){return this._map.has(e)},t.prototype.add=function(e){return rt(this,this._map.set(e,e))},t.prototype.remove=function(e){return rt(this,this._map.remove(e))},t.prototype.clear=function(){return rt(this,this._map.clear())},t.prototype.map=function(e,t){var r=this;return rt(this,this._map.map(function(t){return e(t,t,r)},t))},t.prototype.union=function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return 0===(t=t.filter(function(e){return 0!==e.size})).length?this:0!==this.size||this.__ownerID||1!==t.length?this.withMutations(function(r){for(var n=0;n<t.length;n++)e(t[n]).forEach(function(e){return r.add(e)})}):this.constructor(t[0])},t.prototype.intersect=function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];if(0===t.length)return this;t=t.map(function(t){return e(t)});var n=[];return this.forEach(function(e){t.every(function(t){return t.includes(e)})||n.push(e)}),this.withMutations(function(e){n.forEach(function(t){e.remove(t)})})},t.prototype.subtract=function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];if(0===t.length)return this;t=t.map(function(t){return e(t)});var n=[];return this.forEach(function(e){t.some(function(t){return t.includes(e)})&&n.push(e)}),this.withMutations(function(e){n.forEach(function(t){e.remove(t)})})},t.prototype.sort=function(e){return rO(eC(this,e))},t.prototype.sortBy=function(e,t){return rO(eC(this,t,e))},t.prototype.wasAltered=function(){return this._map.wasAltered()},t.prototype.__iterate=function(e,t){var r=this;return this._map.__iterate(function(t){return e(t,t,r)},t)},t.prototype.__iterator=function(e,t){return this._map.__iterator(e,t)},t.prototype.__ensureOwner=function(e){if(e===this.__ownerID)return this;var t=this._map.__ensureOwner(e);return e?this.__make(t,e):0===this.size?this.__empty():(this.__ownerID=e,this._map=t,this)},t}(k);t9.isSet=t3;var re=t9.prototype;function rt(e,t){return e.__ownerID?(e.size=t.size,e._map=t,e):t===e._map?e:0===t.size?e.__empty():e.__make(t)}function rr(e,t){var r=Object.create(re);return r.size=e?e.size:0,r._map=e,r.__ownerID=t,r}function rn(){return ru||(ru=rr(tE()))}re[t4]=!0,re[t]=re.remove,re.merge=re.concat=re.union,re.withMutations=tu,re.asImmutable=tc,re["@@transducer/init"]=re.asMutable=td,re["@@transducer/step"]=function(e,t){return e.add(t)},re["@@transducer/result"]=function(e){return e.asImmutable()},re.__empty=rn,re.__make=rr;var ri,ra,rs,ro,ru,rd,rc=function(e){function t(e,r,n){if(!(this instanceof t))return new t(e,r,n);if(eM(0!==n,"Cannot step a Range by 0"),e=e||0,void 0===r&&(r=1/0),n=void 0===n?1:Math.abs(n),r<e&&(n=-n),this._start=e,this._end=r,this._step=n,this.size=Math.max(0,Math.ceil((r-e)/n-1)+1),0===this.size){if(rd)return rd;rd=this}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.toString=function(){return 0===this.size?"Range []":"Range [ "+this._start+"..."+this._end+(1!==this._step?" by "+this._step:"")+" ]"},t.prototype.get=function(e,t){return this.has(e)?this._start+o(this,e)*this._step:t},t.prototype.includes=function(e){var t=(e-this._start)/this._step;return t>=0&&t<this.size&&t===Math.floor(t)},t.prototype.slice=function(e,r){var n;return d(e,r,this.size)?this:(e=c(e,this.size,0),(r=c(r,n=this.size,n))<=e?new t(0,0):new t(this.get(e,this._end),this.get(r,this._end),this._step))},t.prototype.indexOf=function(e){var t=e-this._start;if(t%this._step==0){var r=t/this._step;if(r>=0&&r<this.size)return r}return -1},t.prototype.lastIndexOf=function(e){return this.indexOf(e)},t.prototype.__iterate=function(e,t){for(var r=this.size,n=this._step,i=t?this._start+(r-1)*n:this._start,a=0;a!==r&&!1!==e(i,t?r-++a:a++,this);)i+=t?-n:n;return a},t.prototype.__iterator=function(e,t){var r=this.size,n=this._step,i=t?this._start+(r-1)*n:this._start,a=0;return new P(function(){if(a===r)return j();var s=i;return i+=t?-n:n,N(e,t?r-++a:a++,s)})},t.prototype.equals=function(e){return e instanceof t?this._start===e._start&&this._end===e._end&&this._step===e._step:t7(this,e)},t}(z);function rl(e,t,n){for(var i=eU(t),a=0;a!==i.length;)if((e=eW(e,i[a++],r))===r)return n;return e}function rh(e,t){return rl(this,e,t)}function rp(e,t){return rl(e,t,r)!==r}function rf(){eq(this.size);var e={};return this.__iterate(function(t,r){e[r]=t}),e}v.isIterable=p,v.isKeyed=m,v.isIndexed=g,v.isAssociative=_,v.isOrdered=C,v.Iterator=P,t5(v,{toArray:function(){eq(this.size);var e=Array(this.size||0),t=m(this),r=0;return this.__iterate(function(n,i){e[r++]=t?[i,n]:n}),e},toIndexedSeq:function(){return new ev(this)},toJS:function(){return t8(this)},toKeyedSeq:function(){return new e_(this,!0)},toMap:function(){return th(this.toKeyedSeq())},toObject:rf,toOrderedMap:function(){return tW(this.toKeyedSeq())},toOrderedSet:function(){return rO(m(this)?this.valueSeq():this)},toSet:function(){return t9(m(this)?this.valueSeq():this)},toSetSeq:function(){return new eb(this)},toSeq:function(){return g(this)?this.toIndexedSeq():m(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function(){return tQ(m(this)?this.valueSeq():this)},toList:function(){return tj(m(this)?this.valueSeq():this)},toString:function(){return"[Collection]"},__toString:function(e,t){return 0===this.size?e+t:e+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+t},concat:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return eP(this,function(e,t){var r=m(e),n=[e].concat(t).map(function(e){return p(e)?r&&(e=b(e)):e=r?X(e):H(Array.isArray(e)?e:[e]),e}).filter(function(e){return 0!==e.size});if(0===n.length)return e;if(1===n.length){var i=n[0];if(i===e||r&&m(i)||g(e)&&g(i))return i}var a=new V(n);return r?a=a.toKeyedSeq():g(e)||(a=a.toSetSeq()),(a=a.flatten(!0)).size=n.reduce(function(e,t){if(void 0!==e){var r=t.size;if(void 0!==r)return e+r}},0),a}(this,e))},includes:function(e){return this.some(function(t){return en(t,e)})},entries:function(){return this.__iterator(2)},every:function(e,t){eq(this.size);var r=!0;return this.__iterate(function(n,i,a){if(!e.call(t,n,i,a))return r=!1,!1}),r},filter:function(e,t){return eP(this,ex(this,e,t,!0))},find:function(e,t,r){var n=this.findEntry(e,t);return n?n[1]:r},forEach:function(e,t){return eq(this.size),this.__iterate(t?e.bind(t):e)},join:function(e){eq(this.size),e=void 0!==e?""+e:",";var t="",r=!0;return this.__iterate(function(n){r?r=!1:t+=e,t+=null!=n?n.toString():""}),t},keys:function(){return this.__iterator(0)},map:function(e,t){return eP(this,eE(this,e,t))},reduce:function(e,t,r){return r_(this,e,t,r,arguments.length<2,!1)},reduceRight:function(e,t,r){return r_(this,e,t,r,arguments.length<2,!0)},reverse:function(){return eP(this,eI(this,!0))},slice:function(e,t){return eP(this,eO(this,e,t,!0))},some:function(e,t){return!this.every(rw(e),t)},sort:function(e){return eP(this,eC(this,e))},values:function(){return this.__iterator(1)},butLast:function(){return this.slice(0,-1)},isEmpty:function(){return void 0!==this.size?0===this.size:!this.some(function(){return!0})},count:function(e,t){return s(e?this.toSeq().filter(e,t):this)},countBy:function(e,t){var r,n;return r=this,n=th().asMutable(),r.__iterate(function(i,a){n.update(e.call(t,i,a,r),0,function(e){return e+1})}),n.asImmutable()},equals:function(e){return t7(this,e)},entrySeq:function(){var e=this;if(e._cache)return new V(e._cache);var t=e.toSeq().map(rb).toIndexedSeq();return t.fromEntrySeq=function(){return e.toSeq()},t},filterNot:function(e,t){return this.filter(rw(e),t)},findEntry:function(e,t,r){var n=r;return this.__iterate(function(r,i,a){if(e.call(t,r,i,a))return n=[i,r],!1}),n},findKey:function(e,t){var r=this.findEntry(e,t);return r&&r[0]},findLast:function(e,t,r){return this.toKeyedSeq().reverse().find(e,t,r)},findLastEntry:function(e,t,r){return this.toKeyedSeq().reverse().findEntry(e,t,r)},findLastKey:function(e,t){return this.toKeyedSeq().reverse().findKey(e,t)},first:function(e){return this.find(u,null,e)},flatMap:function(e,t){var r,n;return eP(this,(r=this,n=ej(r),r.toSeq().map(function(i,a){return n(e.call(t,i,a,r))}).flatten(!0)))},flatten:function(e){return eP(this,eT(this,e,!0))},fromEntrySeq:function(){return new ew(this)},get:function(e,t){return this.find(function(t,r){return en(r,e)},void 0,t)},getIn:rh,groupBy:function(e,t){return function(e,t,r){var n=m(e),i=(C(e)?tW():th()).asMutable();e.__iterate(function(a,s){i.update(t.call(r,a,s,e),function(e){return(e=e||[]).push(n?[s,a]:a),e})});var a=ej(e);return i.map(function(t){return eP(e,a(t))}).asImmutable()}(this,e,t)},has:function(e){return this.get(e,r)!==r},hasIn:function(e){return rp(this,e)},isSubset:function(e){return e="function"==typeof e.includes?e:v(e),this.every(function(t){return e.includes(t)})},isSuperset:function(e){return(e="function"==typeof e.isSubset?e:v(e)).isSubset(this)},keyOf:function(e){return this.findKey(function(t){return en(t,e)})},keySeq:function(){return this.toSeq().map(rv).toIndexedSeq()},last:function(e){return this.toSeq().reverse().first(e)},lastKeyOf:function(e){return this.toKeyedSeq().reverse().keyOf(e)},max:function(e){return eD(this,e)},maxBy:function(e,t){return eD(this,t,e)},min:function(e){return eD(this,e?rk(e):rI)},minBy:function(e,t){return eD(this,t?rk(t):rI,e)},rest:function(){return this.slice(1)},skip:function(e){return 0===e?this:this.slice(Math.max(0,e))},skipLast:function(e){return 0===e?this:this.slice(0,-Math.max(0,e))},skipWhile:function(e,t){return eP(this,eS(this,e,t,!0))},skipUntil:function(e,t){return this.skipWhile(rw(e),t)},sortBy:function(e,t){return eP(this,eC(this,t,e))},take:function(e){return this.slice(0,Math.max(0,e))},takeLast:function(e){return this.slice(-Math.max(0,e))},takeWhile:function(e,t){var r,n;return eP(this,(r=this,(n=eZ(r)).__iterateUncached=function(n,i){var a=this;if(i)return this.cacheResult().__iterate(n,i);var s=0;return r.__iterate(function(r,i,o){return e.call(t,r,i,o)&&++s&&n(r,i,a)}),s},n.__iteratorUncached=function(n,i){var a=this;if(i)return this.cacheResult().__iterator(n,i);var s=r.__iterator(2,i),o=!0;return new P(function(){if(!o)return j();var r=s.next();if(r.done)return r;var i=r.value,u=i[0],d=i[1];return e.call(t,d,u,a)?2===n?r:N(n,u,d,r):(o=!1,j())})},n))},takeUntil:function(e,t){return this.takeWhile(rw(e),t)},update:function(e){return e(this)},valueSeq:function(){return this.toIndexedSeq()},hashCode:function(){return this.__hash||(this.__hash=function(e){if(e.size===1/0)return 0;var t,r,n=C(e),i=m(e),a=n?1:0;return t=e.__iterate(i?n?function(e,t){a=31*a+rx(es(e),es(t))|0}:function(e,t){a=a+rx(es(e),es(t))|0}:n?function(e){a=31*a+es(e)|0}:function(e){a=a+es(e)|0}),r=ei(r=a,3432918353),r=ei(r<<15|r>>>-15,461845907),r=((r=ei(r<<13|r>>>-13,5))+3864292196|0)^t,r=ei(r^r>>>16,2246822507),r=ea((r=ei(r^r>>>13,3266489909))^r>>>16)}(this))}});var rm=v.prototype;rm[h]=!0,rm[F]=rm.values,rm.toJSON=rm.toArray,rm.__toStringMapper=eV,rm.inspect=rm.toSource=function(){return this.toString()},rm.chain=rm.flatMap,rm.contains=rm.includes,t5(b,{flip:function(){return eP(this,ek(this))},mapEntries:function(e,t){var r=this,n=0;return eP(this,this.toSeq().map(function(i,a){return e.call(t,[a,i],n++,r)}).fromEntrySeq())},mapKeys:function(e,t){var r=this;return eP(this,this.toSeq().flip().map(function(n,i){return e.call(t,n,i,r)}).flip())}});var ry=b.prototype;ry[f]=!0,ry[F]=rm.entries,ry.toJSON=rf,ry.__toStringMapper=function(e,t){return eV(t)+": "+eV(e)},t5(w,{toKeyedSeq:function(){return new e_(this,!1)},filter:function(e,t){return eP(this,ex(this,e,t,!1))},findIndex:function(e,t){var r=this.findEntry(e,t);return r?r[0]:-1},indexOf:function(e){var t=this.keyOf(e);return void 0===t?-1:t},lastIndexOf:function(e){var t=this.lastKeyOf(e);return void 0===t?-1:t},reverse:function(){return eP(this,eI(this,!1))},slice:function(e,t){return eP(this,eO(this,e,t,!1))},splice:function(e,t){var r=arguments.length;if(t=Math.max(t||0,0),0===r||2===r&&!t)return this;e=c(e,e<0?this.count():this.size,0);var n=this.slice(0,e);return eP(this,1===r?n:n.concat(eL(arguments,2),this.slice(e+t)))},findLastIndex:function(e,t){var r=this.findLastEntry(e,t);return r?r[0]:-1},first:function(e){return this.get(0,e)},flatten:function(e){return eP(this,eT(this,e,!1))},get:function(e,t){return(e=o(this,e))<0||this.size===1/0||void 0!==this.size&&e>this.size?t:this.find(function(t,r){return r===e},void 0,t)},has:function(e){return(e=o(this,e))>=0&&(void 0!==this.size?this.size===1/0||e<this.size:-1!==this.indexOf(e))},interpose:function(e){var t,r;return eP(this,(t=this,(r=eZ(t)).size=t.size&&2*t.size-1,r.__iterateUncached=function(r,n){var i=this,a=0;return t.__iterate(function(t){return(!a||!1!==r(e,a++,i))&&!1!==r(t,a++,i)},n),a},r.__iteratorUncached=function(r,n){var i,a=t.__iterator(1,n),s=0;return new P(function(){return(!i||s%2)&&(i=a.next()).done?i:s%2?N(r,s++,e):N(r,s++,i.value,i)})},r))},interleave:function(){var e=[this].concat(eL(arguments)),t=eF(this.toSeq(),z.of,e),r=t.flatten(!0);return t.size&&(r.size=t.size*e.length),eP(this,r)},keySeq:function(){return rc(0,this.size)},last:function(e){return this.get(-1,e)},skipWhile:function(e,t){return eP(this,eS(this,e,t,!1))},zip:function(){var e=[this].concat(eL(arguments));return eP(this,eF(this,rE,e))},zipAll:function(){var e=[this].concat(eL(arguments));return eP(this,eF(this,rE,e,!0))},zipWith:function(e){var t=eL(arguments);return t[0]=this,eP(this,eF(this,e,t))}});var rg=w.prototype;function r_(e,t,r,n,i,a){return eq(e.size),e.__iterate(function(e,a,s){i?(i=!1,r=e):r=t.call(n,r,e,a,s)},a),r}function rv(e,t){return t}function rb(e,t){return[t,e]}function rw(e){return function(){return!e.apply(this,arguments)}}function rk(e){return function(){return-e.apply(this,arguments)}}function rE(){return eL(arguments)}function rI(e,t){return e<t?1:e>t?-1:0}function rx(e,t){return e^t+2654435769+(e<<6)+(e>>2)|0}rg[y]=!0,rg[T]=!0,t5(k,{get:function(e,t){return this.has(e)?e:t},includes:function(e){return this.has(e)},keySeq:function(){return this.valueSeq()}}),k.prototype.has=rm.includes,k.prototype.contains=k.prototype.includes,t5(U,b.prototype),t5(z,w.prototype),t5($,k.prototype);var rO=function(e){function t(e){return null==e?rC():t6(e)?e:rC().withMutations(function(t){var r=k(e);eq(r.size),r.forEach(function(e){return t.add(e)})})}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.fromKeys=function(e){return this(b(e).keySeq())},t.prototype.toString=function(){return this.__toString("OrderedSet {","}")},t}(t9);rO.isOrderedSet=t6;var rS=rO.prototype;function rT(e,t){var r=Object.create(rS);return r.size=e?e.size:0,r._map=e,r.__ownerID=t,r}function rC(){return rj||(rj=rT(tK()))}rS[T]=!0,rS.zip=rg.zip,rS.zipWith=rg.zipWith,rS.__empty=rC,rS.__make=rT;var rD=function(e,t){var r,n=function(a){var s=this;if(a instanceof n)return a;if(!(this instanceof n))return new n(a);if(!r){r=!0;var o=Object.keys(e),u=i._indices={};i._name=t,i._keys=o,i._defaultValues=e;for(var d=0;d<o.length;d++){var c=o[d];u[c]=d,i[c]?"object"==typeof console&&console.warn&&console.warn("Cannot define "+rP(s)+' with property "'+c+'" since that property name is part of the Record API.'):function(e,t){try{Object.defineProperty(e,t,{get:function(){return this.get(t)},set:function(e){eM(this.__ownerID,"Cannot set on an immutable record."),this.set(t,e)}})}catch{}}(i,c)}}this.__ownerID=void 0,this._values=tj().withMutations(function(e){e.setSize(s._keys.length),b(a).forEach(function(t,r){e.set(s._indices[r],t===s._defaultValues[r]?void 0:t)})})},i=n.prototype=Object.create(rA);return i.constructor=n,n};rD.prototype.toString=function(){for(var e,t=rP(this)+" { ",r=this._keys,n=0,i=r.length;n!==i;n++)e=r[n],t+=(n?", ":"")+e+": "+eV(this.get(e));return t+" }"},rD.prototype.equals=function(e){return this===e||e&&this._keys===e._keys&&rN(this).equals(rN(e))},rD.prototype.hashCode=function(){return rN(this).hashCode()},rD.prototype.has=function(e){return this._indices.hasOwnProperty(e)},rD.prototype.get=function(e,t){if(!this.has(e))return t;var r=this._indices[e],n=this._values.get(r);return void 0===n?this._defaultValues[e]:n},rD.prototype.set=function(e,t){if(this.has(e)){var r=this._values.set(this._indices[e],t===this._defaultValues[e]?void 0:t);if(r!==this._values&&!this.__ownerID)return rF(this,r)}return this},rD.prototype.remove=function(e){return this.set(e)},rD.prototype.clear=function(){var e=this._values.clear().setSize(this._keys.length);return this.__ownerID?this:rF(this,e)},rD.prototype.wasAltered=function(){return this._values.wasAltered()},rD.prototype.toSeq=function(){return rN(this)},rD.prototype.toJS=function(){return t8(this)},rD.prototype.entries=function(){return this.__iterator(2)},rD.prototype.__iterator=function(e,t){return rN(this).__iterator(e,t)},rD.prototype.__iterate=function(e,t){return rN(this).__iterate(e,t)},rD.prototype.__ensureOwner=function(e){if(e===this.__ownerID)return this;var t=this._values.__ensureOwner(e);return e?rF(this,t,e):(this.__ownerID=e,this._values=t,this)},rD.isRecord=O,rD.getDescriptiveName=rP;var rA=rD.prototype;function rF(e,t,r){var n=Object.create(Object.getPrototypeOf(e));return n._values=t,n.__ownerID=r,n}function rP(e){return e._name||e.constructor.name||"Record"}function rN(e){return X(e._keys.map(function(t){return[t,e.get(t)]}))}rA[x]=!0,rA[t]=rA.remove,rA.deleteIn=rA.removeIn=e1,rA.getIn=rh,rA.hasIn=rm.hasIn,rA.merge=e6,rA.mergeWith=e7,rA.mergeIn=ts,rA.mergeDeep=ti,rA.mergeDeepWith=ta,rA.mergeDeepIn=to,rA.setIn=eQ,rA.update=e4,rA.updateIn=e3,rA.withMutations=tu,rA.asMutable=td,rA.asImmutable=tc,rA[F]=rA.entries,rA.toJSON=rA.toObject=rm.toObject,rA.inspect=rA.toSource=function(){return this.toString()};var rj,rZ,rR=function(e){function t(e,r){if(!(this instanceof t))return new t(e,r);if(this._value=e,this.size=void 0===r?1/0:Math.max(0,r),0===this.size){if(rZ)return rZ;rZ=this}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.toString=function(){return 0===this.size?"Repeat []":"Repeat [ "+this._value+" "+this.size+" times ]"},t.prototype.get=function(e,t){return this.has(e)?this._value:t},t.prototype.includes=function(e){return en(this._value,e)},t.prototype.slice=function(e,r){var n=this.size;return d(e,r,n)?this:new t(this._value,c(r,n,n)-c(e,n,0))},t.prototype.reverse=function(){return this},t.prototype.indexOf=function(e){return en(this._value,e)?0:-1},t.prototype.lastIndexOf=function(e){return en(this._value,e)?this.size:-1},t.prototype.__iterate=function(e,t){for(var r=this.size,n=0;n!==r&&!1!==e(this._value,t?r-++n:n++,this););return n},t.prototype.__iterator=function(e,t){var r=this,n=this.size,i=0;return new P(function(){return i===n?j():N(e,t?n-++i:i++,r._value)})},t.prototype.equals=function(e){return e instanceof t?en(this._value,e._value):t7(e)},t}(z);function rB(e,t){return function e(t,r,n,i,a,s){var o=Array.isArray(n)?z:ez(n)?U:null;if(o){if(~t.indexOf(n))throw TypeError("Cannot convert circular structure to Immutable");t.push(n),a&&""!==i&&a.push(i);var u=r.call(s,i,o(n).map(function(i,s){return e(t,r,i,s,a,n)}),a&&a.slice());return t.pop(),a&&a.pop(),u}return n}([],t||rL,e,"",t&&t.length>2?[]:void 0,{"":e})}function rL(e,t){return m(t)?t.toMap():t.toList()}var rM="4.0.0-rc.10";e.default={version:rM,Collection:v,Iterable:v,Seq:q,Map:th,OrderedMap:tW,List:tj,Stack:tQ,Set:t9,OrderedSet:rO,Record:rD,Range:rc,Repeat:rR,is:en,fromJS:rB,hash:es,isImmutable:S,isCollection:p,isKeyed:m,isIndexed:g,isAssociative:_,isOrdered:C,isValueObject:er,isSeq:I,isList:tN,isMap:ee,isOrderedMap:et,isStack:tY,isSet:t3,isOrderedSet:t6,isRecord:O,get:eW,getIn:rl,has:eJ,hasIn:rp,merge:e8,mergeDeep:te,mergeWith:e9,mergeDeepWith:tt,remove:eK,removeIn:e0,set:eX,setIn:eY,update:e2,updateIn:eH},e.version=rM,e.Collection=v,e.Iterable=v,e.Seq=q,e.Map=th,e.OrderedMap=tW,e.List=tj,e.Stack=tQ,e.Set=t9,e.OrderedSet=rO,e.Record=rD,e.Range=rc,e.Repeat=rR,e.is=en,e.fromJS=rB,e.hash=es,e.isImmutable=S,e.isCollection=p,e.isKeyed=m,e.isIndexed=g,e.isAssociative=_,e.isOrdered=C,e.isValueObject=er,e.get=eW,e.getIn=rl,e.has=eJ,e.hasIn=rp,e.merge=e8,e.mergeDeep=te,e.mergeWith=e9,e.mergeDeepWith=tt,e.remove=eK,e.removeIn=e0,e.set=eX,e.setIn=eY,e.update=e2,e.updateIn=eH,Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof e&&"u">typeof t?r(e):"function"==typeof define&&define.amd?define(["exports"],r):r(e.Immutable={})}),e_=x(()=>{et='var import_meta_url = require(\'url\').pathToFileURL(__filename)\n"use strict";var d={BUNDLE:"/vendor",BACKEND_BUILD:"true",GDPICTURE_HASH:"d2ca6bda4cb907731fb7296e7cced273bc5ad2c4"};var Ee=require("node:worker_threads");var Ae=function n(e){let t;return e instanceof Error?t=e:t=new Error(e),Object.setPrototypeOf(t,n.prototype),t};Ae.prototype=Object.create(Error.prototype,{name:{value:"PSPDFKitError",enumerable:!1}});var R=Ae;function u(n,e){if(!n)throw new R(`Assertion failed: ${e||"Condition not met"}\n\nFor further assistance, please go to: https://pspdfkit.com/support/request`)}function O(n){console.log(n)}function J(...n){console.warn(...n)}function A(n){console.error(n)}var Fe=["a[href]","area[href]","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])","iframe","object","embed","[contenteditable]",\'[tabindex]:not([tabindex^="-"])\'],Et=Fe.join(",");var De="3.7.7",Ft=De,V=typeof Buffer=="function",xe=typeof TextDecoder=="function"?new TextDecoder:void 0,Ie=typeof TextEncoder=="function"?new TextEncoder:void 0,xt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",z=Array.prototype.slice.call(xt),re=(n=>{let e={};return n.forEach((t,r)=>e[t]=r),e})(z),It=/^(?:[A-Za-z\\d+\\/]{4})*?(?:[A-Za-z\\d+\\/]{2}(?:==)?|[A-Za-z\\d+\\/]{3}=?)?$/,b=String.fromCharCode.bind(String),we=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):n=>new Uint8Array(Array.prototype.slice.call(n,0)),Te=n=>n.replace(/=/g,"").replace(/[+\\/]/g,e=>e=="+"?"-":"_"),ve=n=>n.replace(/[^A-Za-z0-9\\+\\/]/g,""),Re=n=>{let e,t,r,o,i="",s=n.length%3;for(let a=0;a<n.length;){if((t=n.charCodeAt(a++))>255||(r=n.charCodeAt(a++))>255||(o=n.charCodeAt(a++))>255)throw new TypeError("invalid character found");e=t<<16|r<<8|o,i+=z[e>>18&63]+z[e>>12&63]+z[e>>6&63]+z[e&63]}return s?i.slice(0,s-3)+"===".substring(s):i},de=typeof btoa=="function"?n=>btoa(n):V?n=>Buffer.from(n,"binary").toString("base64"):Re,ue=V?n=>Buffer.from(n).toString("base64"):n=>{let t=[];for(let r=0,o=n.length;r<o;r+=4096)t.push(b.apply(null,n.subarray(r,r+4096)));return de(t.join(""))},oe=(n,e=!1)=>e?Te(ue(n)):ue(n),wt=n=>{if(n.length<2){var e=n.charCodeAt(0);return e<128?n:e<2048?b(192|e>>>6)+b(128|e&63):b(224|e>>>12&15)+b(128|e>>>6&63)+b(128|e&63)}else{var e=65536+(n.charCodeAt(0)-55296)*1024+(n.charCodeAt(1)-56320);return b(240|e>>>18&7)+b(128|e>>>12&63)+b(128|e>>>6&63)+b(128|e&63)}},Pt=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\\x00-\\x7F]/g,Ce=n=>n.replace(Pt,wt),Pe=V?n=>Buffer.from(n,"utf8").toString("base64"):Ie?n=>ue(Ie.encode(n)):n=>de(Ce(n)),K=(n,e=!1)=>e?Te(Pe(n)):Pe(n),Ne=n=>K(n,!0),Nt=/[\\xC0-\\xDF][\\x80-\\xBF]|[\\xE0-\\xEF][\\x80-\\xBF]{2}|[\\xF0-\\xF7][\\x80-\\xBF]{3}/g,Dt=n=>{switch(n.length){case 4:var e=(7&n.charCodeAt(0))<<18|(63&n.charCodeAt(1))<<12|(63&n.charCodeAt(2))<<6|63&n.charCodeAt(3),t=e-65536;return b((t>>>10)+55296)+b((t&1023)+56320);case 3:return b((15&n.charCodeAt(0))<<12|(63&n.charCodeAt(1))<<6|63&n.charCodeAt(2));default:return b((31&n.charCodeAt(0))<<6|63&n.charCodeAt(1))}},ke=n=>n.replace(Nt,Dt),Be=n=>{if(n=n.replace(/\\s+/g,""),!It.test(n))throw new TypeError("malformed base64.");n+="==".slice(2-(n.length&3));let e,t="",r,o;for(let i=0;i<n.length;)e=re[n.charAt(i++)]<<18|re[n.charAt(i++)]<<12|(r=re[n.charAt(i++)])<<6|(o=re[n.charAt(i++)]),t+=r===64?b(e>>16&255):o===64?b(e>>16&255,e>>8&255):b(e>>16&255,e>>8&255,e&255);return t},fe=typeof atob=="function"?n=>atob(ve(n)):V?n=>Buffer.from(n,"base64").toString("binary"):Be,Me=V?n=>we(Buffer.from(n,"base64")):n=>we(fe(n).split("").map(e=>e.charCodeAt(0))),Je=n=>Me(Le(n)),Tt=V?n=>Buffer.from(n,"base64").toString("utf8"):xe?n=>xe.decode(Me(n)):n=>ke(fe(n)),Le=n=>ve(n.replace(/[-_]/g,e=>e=="-"?"+":"/")),pe=n=>Tt(Le(n)),vt=n=>{if(typeof n!="string")return!1;let e=n.replace(/\\s+/g,"").replace(/={0,2}$/,"");return!/[^\\s0-9a-zA-Z\\+/]/.test(e)||!/[^\\s0-9a-zA-Z\\-_]/.test(e)},je=n=>({value:n,enumerable:!1,writable:!0,configurable:!0}),Ue=function(){let n=(e,t)=>Object.defineProperty(String.prototype,e,je(t));n("fromBase64",function(){return pe(this)}),n("toBase64",function(e){return K(this,e)}),n("toBase64URI",function(){return K(this,!0)}),n("toBase64URL",function(){return K(this,!0)}),n("toUint8Array",function(){return Je(this)})},$e=function(){let n=(e,t)=>Object.defineProperty(Uint8Array.prototype,e,je(t));n("toBase64",function(e){return oe(this,e)}),n("toBase64URI",function(){return oe(this,!0)}),n("toBase64URL",function(){return oe(this,!0)})},Rt=()=>{Ue(),$e()},Ke={version:De,VERSION:Ft,atob:fe,atobPolyfill:Be,btoa:de,btoaPolyfill:Re,fromBase64:pe,toBase64:K,encode:K,encodeURI:Ne,encodeURL:Ne,utob:Ce,btou:ke,decode:pe,isValid:vt,fromUint8Array:oe,toUint8Array:Je,extendString:Ue,extendUint8Array:$e,extendBuiltins:Rt};function ie(n){return{name:n.name,scale:{unitFrom:n.scale.unitFrom,unitTo:n.scale.unitTo,from:Number(n.scale.fromValue),to:Number(n.scale.toValue)},precision:n.precision}}var Ve="bf0cd9709aab6554";var We="20722ea18bb46c32";function me(n){return Promise.resolve(require(n))}function ge(n){return typeof window=="object"?new Promise((e,t)=>{let r=document.createElement("script");r.type="text/javascript",r.async=!0,r.onload=()=>e(window.PSPDFModuleInit),r.onerror=t,r.src=n;let{documentElement:o}=document;u(o),o.appendChild(r)}):(self.importScripts(n),Promise.resolve(self.PSPDFModuleInit))}var ye;typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node<"u"?ye=me:ye=ge;var Ge=ye;var ze=!0,Ct=!1,qe=ze&&Ct,Ye=ze?`${d.BUNDLE}/`:"",kt=`${Ye}pspdfkit${qe?"-"+We:""}.wasm.js`,He=`${Ye}pspdfkit${qe?"-"+Ve:""}.wasm`;function Xe(n,e,t=globalThis){let r,o;return new Promise(async i=>{r=Bt(n,e),typeof n=="string"?o=await Ge(`${n}${kt}`):o=(await import(n.wasmLoaderPath)).default,O("Using WASM method"),Mt(t);let s=await o(r);i({nativeModule:s})})}function Bt(n,e){let t;return typeof n=="object"?(t=n.wasm,{wasmBinaryFile:He,locateFile:s=>s,wasmBinary:t}):(t=require("fs").readFileSync("./vendor/pspdfkit.wasm"),{wasmBinaryFile:n+He,locateFile:i=>i,wasmBinary:t})}function Mt(n){n.PSPDFLoggingServices={error(e,t){A(`[${e}] ${t}`)},warn(e,t){J(`[${e}] ${t}`)},info(e,t){d.INTERNAL_DEBUG&&O(`[${e}] ${t}`)},debug(e,t){d.INTERNAL_DEBUG&&O(`[${e}] ${t}`)},trace(e,t){d.INTERNAL_DEBUG&&O(`[${e}] ${t}`)}},n.PSPDFUnicodeServices={stripDiacritics(e){let t={\\u00C1:"A",\\u0102:"A",\\u1EAE:"A",\\u1EB6:"A",\\u1EB0:"A",\\u1EB2:"A",\\u1EB4:"A",\\u01CD:"A",\\u00C2:"A",\\u1EA4:"A",\\u1EAC:"A",\\u1EA6:"A",\\u1EA8:"A",\\u1EAA:"A",\\u00C4:"A",\\u01DE:"A",\\u0226:"A",\\u01E0:"A",\\u1EA0:"A",\\u0200:"A",\\u00C0:"A",\\u1EA2:"A",\\u0202:"A",\\u0100:"A",\\u0104:"A",\\u00C5:"A",\\u01FA:"A",\\u1E00:"A","\\u023A":"A",\\u00C3:"A","\\uA732":"AA",\\u00C6:"AE",\\u01FC:"AE",\\u01E2:"AE","\\uA734":"AO","\\uA736":"AU","\\uA738":"AV","\\uA73A":"AV","\\uA73C":"AY",\\u1E02:"B",\\u1E04:"B",\\u0181:"B",\\u1E06:"B","\\u0243":"B",\\u0182:"B",\\u0106:"C",\\u010C:"C",\\u00C7:"C",\\u1E08:"C",\\u0108:"C",\\u010A:"C",\\u0187:"C","\\u023B":"C",\\u010E:"D",\\u1E10:"D",\\u1E12:"D",\\u1E0A:"D",\\u1E0C:"D",\\u018A:"D",\\u1E0E:"D",\\u01F2:"D",\\u01C5:"D",\\u0110:"D",\\u018B:"D",\\u01F1:"DZ",\\u01C4:"DZ",\\u00C9:"E",\\u0114:"E",\\u011A:"E",\\u0228:"E",\\u1E1C:"E",\\u00CA:"E",\\u1EBE:"E",\\u1EC6:"E",\\u1EC0:"E",\\u1EC2:"E",\\u1EC4:"E",\\u1E18:"E",\\u00CB:"E",\\u0116:"E",\\u1EB8:"E",\\u0204:"E",\\u00C8:"E",\\u1EBA:"E",\\u0206:"E",\\u0112:"E",\\u1E16:"E",\\u1E14:"E",\\u0118:"E","\\u0246":"E",\\u1EBC:"E",\\u1E1A:"E","\\uA76A":"ET",\\u1E1E:"F",\\u0191:"F",\\u01F4:"G",\\u011E:"G",\\u01E6:"G",\\u0122:"G",\\u011C:"G",\\u0120:"G",\\u0193:"G",\\u1E20:"G",\\u01E4:"G",\\u1E2A:"H",\\u021E:"H",\\u1E28:"H",\\u0124:"H","\\u2C67":"H",\\u1E26:"H",\\u1E22:"H",\\u1E24:"H",\\u0126:"H",\\u00CD:"I",\\u012C:"I",\\u01CF:"I",\\u00CE:"I",\\u00CF:"I",\\u1E2E:"I",\\u0130:"I",\\u1ECA:"I",\\u0208:"I",\\u00CC:"I",\\u1EC8:"I",\\u020A:"I",\\u012A:"I",\\u012E:"I",\\u0197:"I",\\u0128:"I",\\u1E2C:"I","\\uA779":"D","\\uA77B":"F","\\uA77D":"G","\\uA782":"R","\\uA784":"S","\\uA786":"T","\\uA76C":"IS",\\u0134:"J","\\u0248":"J",\\u1E30:"K",\\u01E8:"K",\\u0136:"K","\\u2C69":"K","\\uA742":"K",\\u1E32:"K",\\u0198:"K",\\u1E34:"K","\\uA740":"K","\\uA744":"K",\\u0139:"L","\\u023D":"L",\\u013D:"L",\\u013B:"L",\\u1E3C:"L",\\u1E36:"L",\\u1E38:"L","\\u2C60":"L","\\uA748":"L",\\u1E3A:"L",\\u013F:"L","\\u2C62":"L",\\u01C8:"L",\\u0141:"L",\\u01C7:"LJ",\\u1E3E:"M",\\u1E40:"M",\\u1E42:"M","\\u2C6E":"M",\\u0143:"N",\\u0147:"N",\\u0145:"N",\\u1E4A:"N",\\u1E44:"N",\\u1E46:"N",\\u01F8:"N",\\u019D:"N",\\u1E48:"N","\\u0220":"N",\\u01CB:"N",\\u00D1:"N",\\u01CA:"NJ",\\u00D3:"O",\\u014E:"O",\\u01D1:"O",\\u00D4:"O",\\u1ED0:"O",\\u1ED8:"O",\\u1ED2:"O",\\u1ED4:"O",\\u1ED6:"O",\\u00D6:"O",\\u022A:"O",\\u022E:"O",\\u0230:"O",\\u1ECC:"O",\\u0150:"O",\\u020C:"O",\\u00D2:"O",\\u1ECE:"O",\\u01A0:"O",\\u1EDA:"O",\\u1EE2:"O",\\u1EDC:"O",\\u1EDE:"O",\\u1EE0:"O",\\u020E:"O","\\uA74A":"O","\\uA74C":"O",\\u014C:"O",\\u1E52:"O",\\u1E50:"O",\\u019F:"O",\\u01EA:"O",\\u01EC:"O",\\u00D8:"O",\\u01FE:"O",\\u00D5:"O",\\u1E4C:"O",\\u1E4E:"O",\\u022C:"O",\\u01A2:"OI","\\uA74E":"OO",\\u0190:"E",\\u0186:"O",\\u0222:"OU",\\u1E54:"P",\\u1E56:"P","\\uA752":"P",\\u01A4:"P","\\uA754":"P","\\u2C63":"P","\\uA750":"P","\\uA758":"Q","\\uA756":"Q",\\u0154:"R",\\u0158:"R",\\u0156:"R",\\u1E58:"R",\\u1E5A:"R",\\u1E5C:"R",\\u0210:"R",\\u0212:"R",\\u1E5E:"R","\\u024C":"R","\\u2C64":"R","\\uA73E":"C",\\u018E:"E",\\u015A:"S",\\u1E64:"S",\\u0160:"S",\\u1E66:"S",\\u015E:"S",\\u015C:"S",\\u0218:"S",\\u1E60:"S",\\u1E62:"S",\\u1E68:"S",\\u0164:"T",\\u0162:"T",\\u1E70:"T",\\u021A:"T","\\u023E":"T",\\u1E6A:"T",\\u1E6C:"T",\\u01AC:"T",\\u1E6E:"T",\\u01AE:"T",\\u0166:"T","\\u2C6F":"A","\\uA780":"L",\\u019C:"M","\\u0245":"V","\\uA728":"TZ",\\u00DA:"U",\\u016C:"U",\\u01D3:"U",\\u00DB:"U",\\u1E76:"U",\\u00DC:"U",\\u01D7:"U",\\u01D9:"U",\\u01DB:"U",\\u01D5:"U",\\u1E72:"U",\\u1EE4:"U",\\u0170:"U",\\u0214:"U",\\u00D9:"U",\\u1EE6:"U",\\u01AF:"U",\\u1EE8:"U",\\u1EF0:"U",\\u1EEA:"U",\\u1EEC:"U",\\u1EEE:"U",\\u0216:"U",\\u016A:"U",\\u1E7A:"U",\\u0172:"U",\\u016E:"U",\\u0168:"U",\\u1E78:"U",\\u1E74:"U","\\uA75E":"V",\\u1E7E:"V",\\u01B2:"V",\\u1E7C:"V","\\uA760":"VY",\\u1E82:"W",\\u0174:"W",\\u1E84:"W",\\u1E86:"W",\\u1E88:"W",\\u1E80:"W","\\u2C72":"W",\\u1E8C:"X",\\u1E8A:"X",\\u00DD:"Y",\\u0176:"Y",\\u0178:"Y",\\u1E8E:"Y",\\u1EF4:"Y",\\u1EF2:"Y",\\u01B3:"Y",\\u1EF6:"Y","\\u1EFE":"Y",\\u0232:"Y","\\u024E":"Y",\\u1EF8:"Y",\\u0179:"Z",\\u017D:"Z",\\u1E90:"Z","\\u2C6B":"Z",\\u017B:"Z",\\u1E92:"Z",\\u0224:"Z",\\u1E94:"Z",\\u01B5:"Z",\\u0132:"IJ",\\u0152:"OE","\\u1D00":"A","\\u1D01":"AE",\\u0299:"B","\\u1D03":"B","\\u1D04":"C","\\u1D05":"D","\\u1D07":"E","\\uA730":"F",\\u0262:"G",\\u029B:"G",\\u029C:"H",\\u026A:"I",\\u0281:"R","\\u1D0A":"J","\\u1D0B":"K",\\u029F:"L","\\u1D0C":"L","\\u1D0D":"M",\\u0274:"N","\\u1D0F":"O",\\u0276:"OE","\\u1D10":"O","\\u1D15":"OU","\\u1D18":"P",\\u0280:"R","\\u1D0E":"N","\\u1D19":"R","\\uA731":"S","\\u1D1B":"T","\\u2C7B":"E","\\u1D1A":"R","\\u1D1C":"U","\\u1D20":"V","\\u1D21":"W",\\u028F:"Y","\\u1D22":"Z",\\u00E1:"a",\\u0103:"a",\\u1EAF:"a",\\u1EB7:"a",\\u1EB1:"a",\\u1EB3:"a",\\u1EB5:"a",\\u01CE:"a",\\u00E2:"a",\\u1EA5:"a",\\u1EAD:"a",\\u1EA7:"a",\\u1EA9:"a",\\u1EAB:"a",\\u00E4:"a",\\u01DF:"a",\\u0227:"a",\\u01E1:"a",\\u1EA1:"a",\\u0201:"a",\\u00E0:"a",\\u1EA3:"a",\\u0203:"a",\\u0101:"a",\\u0105:"a","\\u1D8F":"a",\\u1E9A:"a",\\u00E5:"a",\\u01FB:"a",\\u1E01:"a","\\u2C65":"a",\\u00E3:"a","\\uA733":"aa",\\u00E6:"ae",\\u01FD:"ae",\\u01E3:"ae","\\uA735":"ao","\\uA737":"au","\\uA739":"av","\\uA73B":"av","\\uA73D":"ay",\\u1E03:"b",\\u1E05:"b",\\u0253:"b",\\u1E07:"b","\\u1D6C":"b","\\u1D80":"b",\\u0180:"b",\\u0183:"b",\\u0275:"o",\\u0107:"c",\\u010D:"c",\\u00E7:"c",\\u1E09:"c",\\u0109:"c",\\u0255:"c",\\u010B:"c",\\u0188:"c","\\u023C":"c",\\u010F:"d",\\u1E11:"d",\\u1E13:"d","\\u0221":"d",\\u1E0B:"d",\\u1E0D:"d",\\u0257:"d","\\u1D91":"d",\\u1E0F:"d","\\u1D6D":"d","\\u1D81":"d",\\u0111:"d",\\u0256:"d",\\u018C:"d",\\u0131:"i","\\u0237":"j",\\u025F:"j",\\u0284:"j",\\u01F3:"dz",\\u01C6:"dz",\\u00E9:"e",\\u0115:"e",\\u011B:"e",\\u0229:"e",\\u1E1D:"e",\\u00EA:"e",\\u1EBF:"e",\\u1EC7:"e",\\u1EC1:"e",\\u1EC3:"e",\\u1EC5:"e",\\u1E19:"e",\\u00EB:"e",\\u0117:"e",\\u1EB9:"e",\\u0205:"e",\\u00E8:"e",\\u1EBB:"e",\\u0207:"e",\\u0113:"e",\\u1E17:"e",\\u1E15:"e","\\u2C78":"e",\\u0119:"e","\\u1D92":"e","\\u0247":"e",\\u1EBD:"e",\\u1E1B:"e","\\uA76B":"et",\\u1E1F:"f",\\u0192:"f","\\u1D6E":"f","\\u1D82":"f",\\u01F5:"g",\\u011F:"g",\\u01E7:"g",\\u0123:"g",\\u011D:"g",\\u0121:"g",\\u0260:"g",\\u1E21:"g","\\u1D83":"g",\\u01E5:"g",\\u1E2B:"h",\\u021F:"h",\\u1E29:"h",\\u0125:"h","\\u2C68":"h",\\u1E27:"h",\\u1E23:"h",\\u1E25:"h",\\u0266:"h",\\u1E96:"h",\\u0127:"h",\\u0195:"hv",\\u00ED:"i",\\u012D:"i",\\u01D0:"i",\\u00EE:"i",\\u00EF:"i",\\u1E2F:"i",\\u1ECB:"i",\\u0209:"i",\\u00EC:"i",\\u1EC9:"i",\\u020B:"i",\\u012B:"i",\\u012F:"i","\\u1D96":"i",\\u0268:"i",\\u0129:"i",\\u1E2D:"i","\\uA77A":"d","\\uA77C":"f","\\u1D79":"g","\\uA783":"r","\\uA785":"s","\\uA787":"t","\\uA76D":"is",\\u01F0:"j",\\u0135:"j",\\u029D:"j","\\u0249":"j",\\u1E31:"k",\\u01E9:"k",\\u0137:"k","\\u2C6A":"k","\\uA743":"k",\\u1E33:"k",\\u0199:"k",\\u1E35:"k","\\u1D84":"k","\\uA741":"k","\\uA745":"k",\\u013A:"l",\\u019A:"l",\\u026C:"l",\\u013E:"l",\\u013C:"l",\\u1E3D:"l","\\u0234":"l",\\u1E37:"l",\\u1E39:"l","\\u2C61":"l","\\uA749":"l",\\u1E3B:"l",\\u0140:"l",\\u026B:"l","\\u1D85":"l",\\u026D:"l",\\u0142:"l",\\u01C9:"lj",\\u017F:"s","\\u1E9C":"s",\\u1E9B:"s","\\u1E9D":"s",\\u1E3F:"m",\\u1E41:"m",\\u1E43:"m",\\u0271:"m","\\u1D6F":"m","\\u1D86":"m",\\u0144:"n",\\u0148:"n",\\u0146:"n",\\u1E4B:"n","\\u0235":"n",\\u1E45:"n",\\u1E47:"n",\\u01F9:"n",\\u0272:"n",\\u1E49:"n",\\u019E:"n","\\u1D70":"n","\\u1D87":"n",\\u0273:"n",\\u00F1:"n",\\u01CC:"nj",\\u00F3:"o",\\u014F:"o",\\u01D2:"o",\\u00F4:"o",\\u1ED1:"o",\\u1ED9:"o",\\u1ED3:"o",\\u1ED5:"o",\\u1ED7:"o",\\u00F6:"o",\\u022B:"o",\\u022F:"o",\\u0231:"o",\\u1ECD:"o",\\u0151:"o",\\u020D:"o",\\u00F2:"o",\\u1ECF:"o",\\u01A1:"o",\\u1EDB:"o",\\u1EE3:"o",\\u1EDD:"o",\\u1EDF:"o",\\u1EE1:"o",\\u020F:"o","\\uA74B":"o","\\uA74D":"o","\\u2C7A":"o",\\u014D:"o",\\u1E53:"o",\\u1E51:"o",\\u01EB:"o",\\u01ED:"o",\\u00F8:"o",\\u01FF:"o",\\u00F5:"o",\\u1E4D:"o",\\u1E4F:"o",\\u022D:"o",\\u01A3:"oi","\\uA74F":"oo",\\u025B:"e","\\u1D93":"e",\\u0254:"o","\\u1D97":"o",\\u0223:"ou",\\u1E55:"p",\\u1E57:"p","\\uA753":"p",\\u01A5:"p","\\u1D71":"p","\\u1D88":"p","\\uA755":"p","\\u1D7D":"p","\\uA751":"p","\\uA759":"q",\\u02A0:"q","\\u024B":"q","\\uA757":"q",\\u0155:"r",\\u0159:"r",\\u0157:"r",\\u1E59:"r",\\u1E5B:"r",\\u1E5D:"r",\\u0211:"r",\\u027E:"r","\\u1D73":"r",\\u0213:"r",\\u1E5F:"r",\\u027C:"r","\\u1D72":"r","\\u1D89":"r","\\u024D":"r",\\u027D:"r","\\u2184":"c","\\uA73F":"c",\\u0258:"e",\\u027F:"r",\\u015B:"s",\\u1E65:"s",\\u0161:"s",\\u1E67:"s",\\u015F:"s",\\u015D:"s",\\u0219:"s",\\u1E61:"s",\\u1E63:"s",\\u1E69:"s",\\u0282:"s","\\u1D74":"s","\\u1D8A":"s","\\u023F":"s",\\u0261:"g","\\u1D11":"o","\\u1D13":"o","\\u1D1D":"u",\\u0165:"t",\\u0163:"t",\\u1E71:"t",\\u021B:"t","\\u0236":"t",\\u1E97:"t","\\u2C66":"t",\\u1E6B:"t",\\u1E6D:"t",\\u01AD:"t",\\u1E6F:"t","\\u1D75":"t",\\u01AB:"t",\\u0288:"t",\\u0167:"t","\\u1D7A":"th",\\u0250:"a","\\u1D02":"ae",\\u01DD:"e","\\u1D77":"g",\\u0265:"h","\\u02AE":"h","\\u02AF":"h","\\u1D09":"i",\\u029E:"k","\\uA781":"l",\\u026F:"m",\\u0270:"m","\\u1D14":"oe",\\u0279:"r",\\u027B:"r",\\u027A:"r","\\u2C79":"r",\\u0287:"t",\\u028C:"v",\\u028D:"w",\\u028E:"y","\\uA729":"tz",\\u00FA:"u",\\u016D:"u",\\u01D4:"u",\\u00FB:"u",\\u1E77:"u",\\u00FC:"u",\\u01D8:"u",\\u01DA:"u",\\u01DC:"u",\\u01D6:"u",\\u1E73:"u",\\u1EE5:"u",\\u0171:"u",\\u0215:"u",\\u00F9:"u",\\u1EE7:"u",\\u01B0:"u",\\u1EE9:"u",\\u1EF1:"u",\\u1EEB:"u",\\u1EED:"u",\\u1EEF:"u",\\u0217:"u",\\u016B:"u",\\u1E7B:"u",\\u0173:"u","\\u1D99":"u",\\u016F:"u",\\u0169:"u",\\u1E79:"u",\\u1E75:"u","\\u1D6B":"ue","\\uA778":"um","\\u2C74":"v","\\uA75F":"v",\\u1E7F:"v",\\u028B:"v","\\u1D8C":"v","\\u2C71":"v",\\u1E7D:"v","\\uA761":"vy",\\u1E83:"w",\\u0175:"w",\\u1E85:"w",\\u1E87:"w",\\u1E89:"w",\\u1E81:"w","\\u2C73":"w",\\u1E98:"w",\\u1E8D:"x",\\u1E8B:"x","\\u1D8D":"x",\\u00FD:"y",\\u0177:"y",\\u00FF:"y",\\u1E8F:"y",\\u1EF5:"y",\\u1EF3:"y",\\u01B4:"y",\\u1EF7:"y","\\u1EFF":"y",\\u0233:"y",\\u1E99:"y","\\u024F":"y",\\u1EF9:"y",\\u017A:"z",\\u017E:"z",\\u1E91:"z",\\u0291:"z","\\u2C6C":"z",\\u017C:"z",\\u1E93:"z",\\u0225:"z",\\u1E95:"z","\\u1D76":"z","\\u1D8E":"z",\\u0290:"z",\\u01B6:"z","\\u0240":"z",\\uFB00:"ff",\\uFB03:"ffi",\\uFB04:"ffl",\\uFB01:"fi",\\uFB02:"fl",\\u0133:"ij",\\u0153:"oe",\\uFB06:"st","\\u2090":"a","\\u2091":"e","\\u1D62":"i","\\u2C7C":"j","\\u2092":"o","\\u1D63":"r","\\u1D64":"u","\\u1D65":"v","\\u2093":"x"};if(!e.normalize)return e;let r=e.replace(/[^A-Za-z0-9[\\] ]/g,function(o){return t[o]||o});return e.normalize("NFC").length==r.normalize("NFC").length?r:""},escapeRegExp(e){return e.replace(/[.*+?^${}()|[\\]\\\\]/g,"\\\\$&")},match(e,t,r){let o=new RegExp(t,r?"g":"gi"),i=[],s=o.exec(e);for(;s!=null;)i.push([s.index,s[0].length]),s=o.exec(e);return i},exec(e,t){return new RegExp(e).exec(t)}}}function q(n){let e=new FileReader;return new Promise((t,r)=>{e.onerror=o=>{r(new Error(o))},e.onload=o=>{t(new Uint8Array(o.target?.result))},e.readAsArrayBuffer(n)})}var Ze={TEXT:"text",PRESET:"preset",REGEX:"regex"};var I={documentA:"documentA",documentB:"documentB",result:"result"};var Jt=150,Lt=300,zr=Jt/72,qr=Lt/72,Yr=75/72;var Xr={LOW:75/72,MEDIUM:150/72,HIGH:300/72},Zr=2/3;var he=16383;var Qe=4096*4096,se=250,Qr={thumbnailMinSize:se/2,thumbnailMaxSize:se+se*1.5,thumbnailDefaultSize:se};var P={SharePoint:"SharePoint",Salesforce:"Salesforce",Maui_Android:"Maui_Android",Maui_iOS:"Maui_iOS",Maui_MacCatalyst:"Maui_MacCatalyst",Maui_Windows:"Maui_Windows",FlutterForWeb:"FlutterForWeb",Electron:"Electron"};var et={cms:"cms",cades:"cades",documentTimestamp:"documentTimestamp"};var _e={canShape:"canShape",unableToShape:"unableToShape",requiresMoreFonts:"requiresMoreFonts"};async function tt(n){try{let e=await fetch(n).catch(t=>{throw new R(`Error fetching dynamic fonts file ${n}. ${t}`)});if(e.status!==200)throw new R(`Error fetching dynamic fonts file ${n}. Status code: ${e.status}`);return e}catch(e){throw e}}function nt(n){try{let e=new Uint8Array(n);return e.length?e[0]===48:!1}catch(e){throw new Error(`Error checking if the signature is in PKCS#7 format: ${e.message}`)}}function ae(n=globalThis.navigator?.userAgent??""){return n.indexOf("Trident/")>-1?"trident":n.indexOf("Edge/")>-1?"edge":n.indexOf("Chrome/")>-1?"blink":n.indexOf("AppleWebKit/")>-1?"webkit":n.indexOf("Gecko/")>-1?"gecko":"unknown"}function Y(n,e){let t=new RegExp(` ${e}/(\\\\d+)\\\\.*`),r;return(r=n.match(t))?Number(r[1]):0}function jt(n=globalThis.navigator?.userAgent){switch(ae(n)){case"trident":return Y(n,"Trident");case"edge":return Y(n,"Edge");case"blink":return Y(n,"Chrome");case"webkit":return Y(n,"Version");case"gecko":return Y(n,"Firefox");default:return 0}}function ot(n=globalThis.navigator?.userAgent??"",e=globalThis.navigator?.platform??"",t=globalThis.navigator?.maxTouchPoints??0){return e.indexOf("MacIntel")>-1&&t>1?"ios":n.indexOf("Win")>-1?"windows":n.indexOf("iPhone")>-1||n.indexOf("iPad")>-1||e==="iPad"?"ios":n.indexOf("Mac")>-1?"macos":n.indexOf("Android")>-1?"android":n.indexOf("Linux")>-1?"linux":"unknown"}function Ut(n=ot(),e=ae()){return n==="ios"||n==="android"||at(e)}var po=ae(),it=ot(),fo=jt(),mo=Ut();var go=it==="ios"||at();var st=it==="ios";function at(n=ae()){return typeof window<"u"&&window.PSPDFKIT_PLAYWRIGHT_TEST||globalThis.navigator?.userAgent.indexOf("jsdom/")>=0?!1:n==="webkit"&&typeof TouchEvent<"u"}var rt;typeof window<"u"&&(window.addEventListener("mousemove",function n(){rt=!1,window.removeEventListener("mousemove",n)}),window.addEventListener("pointermove",function n(e){(e.pointerType==="mouse"||e.pointerType==="pen")&&(rt=!1),window.removeEventListener("pointermove",n)}));var yo=/Mac/i.test(globalThis.navigator?.platform);function ct(){return typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron/")>=0}var y="/create.pdf";var C="/save.pdf",ce="/embedded.pdf",lt=1,N=!1,E="WebAssembly module not loaded.",c=null,ut=!1,k=!1,X=null,U={password:void 0,initialPageIndex:void 0},Se=[],w=U,be=null,L=null,$=new Set,G="/fonts",le,Oe=new Set,D=!1;var Q=[];function _t(n){return n!=null&&n.length!=null&&n.length===0}var St=["configurePDFJavaScriptSupport","closeDocument","setFormValues","openDocument","saveDocument","importXFDF","importInstantDocumentJSON"],$t={annotationsAndForms:"annotations_and_forms",assemble:"assemble",extract:"extract",extractAccessibility:"extract_accessibility",fillForms:"fill_forms",modification:"modification",printHighQuality:"print_high_quality",printing:"printing"};function g(n,...e){u(c,"WebAssembly module not loaded."),u(c[n],`Native module does not implement ${n}.`);let t;(N||D)&&(t=performance.now()),N&&O(`Request: ${n}(${e.map(s=>JSON.stringify(s)).join(", ")})`);let r=e.map(s=>_t(s)?JSON.stringify(s):s);St.includes(n)&&te();let o=c[n](...r)||\'{ "success": true }\',i=JSON.parse(o);if(N&&(u(typeof t=="number"),O(`Response from ${n} (${(performance.now()-t).toFixed(2)} ms): ${JSON.stringify(i)}`)),D&&Q.push({type:1,name:n,args:r,time:performance.now()-t}),!i.success)throw new Error(i.error);return i}function pt(n,...e){u(c,"WebAssembly module not loaded."),u(c[n],`Native module does not implement ${n}.`);let t;(N||D)&&(t=performance.now()),N&&O(`Request: ${n}(${e.map(i=>JSON.stringify(i)).join(", ")})`),St.includes(n)&&te();let r=e.map(i=>_t(i)?JSON.stringify(i):i),o=c[n](...r);return N&&(u(typeof t=="number"),O(`Response from ${n} (${(performance.now()-t).toFixed(2)} ms): ${JSON.stringify(o)}`)),D&&Q.push({type:1,name:n,args:r,time:performance.now()-t}),o}var Kt=["run_pdf_formatting_scripts","run_pdf_javascript","set_form_values_get_script_changes","edit_document","prepare_sign","sign","on_keystroke_event","save_document","update_annotation"];function Vt(n){let e=new ArrayBuffer(n.length*2),t=new Uint16Array(e);for(let r=0,o=n.length;r<o;r++)t[r]=n.charCodeAt(r);return e}function l(n,e,t=null){u(c,"WebAssembly module not loaded.");let r=JSON.stringify({type:n,...e}),o;(N||D)&&(o=performance.now()),N&&O(`Request: dispatchCommand(${r})`),Kt.includes(n)&&te();let i;if(t)try{let a=typeof t=="string"?new Uint8Array(Vt(t)):new Uint8Array(t),p=c.allocateMemory(a.byteLength);try{p.view.set(a);let f=c.memoryHandleToVector(p);try{i=c.dispatchCommandWithBinary(r,f)}finally{f.delete()}}finally{p.delete()}}catch(a){throw a}else i=c.dispatchCommand(r);if(i.hasError()){let a=new Error(i.getErrorMessage()||"There was an error while executing the command: "+n);throw i.delete(),a}let s=[];for(let a=0;a<i.getRepliesCount();a++)i.hasJSONReply(a)&&s.push(JSON.parse(i.getJSONReply(a))),i.hasBinaryReply(a)&&s.push(i.getBinaryReply(a).slice(0));return N&&(u(typeof o=="number"),O(`Response from ${n} (${(performance.now()-o).toFixed(2)} ms): ${JSON.stringify(s)}`)),D&&Q.push({type:0,name:n,args:[r],time:performance.now()-o}),i.delete(),s}function Wt(n){try{let e=new TextDecoder().decode(n);return JSON.parse(e)}catch(e){throw e}}function Z(n,e){return`${n}/${e}.pdf`}function Gt(n,e,t){return u(c,E),c.FS.analyzePath(n).exists||c.FS.mkdir(n),c.FS.writeFile(Z(n,e),t),e}function Ht(n,e){u(c,E),c.FS.unlink(Z(n,e))}async function dt(n,e){let t=Math.random().toString(36).slice(-5),r=await Promise.all(Object.entries(e).map(async([o,i])=>(n.forEach(s=>{"document"in s&&s.document===o&&s.type==="importDocument"?(s.treatImportedDocumentAsOnePage===!1&&(s.treatImportedDocumentAsOnePage=void 0),s.document=Z(t,o)):("dataFilePath"in s&&s.dataFilePath===o&&s.type==="applyInstantJson"||"dataFilePath"in s&&s.dataFilePath===o&&s.type==="applyXfdf")&&(s.dataFilePath=Z(t,o))}),{basename:o,buffer:await q(i)})));return r.forEach(o=>{Gt(t,o.basename,o.buffer)}),function(){r.forEach(o=>{Ht(t,o.basename)})}}function zt(n,e){u(c,E),c.FS.analyzePath(e).exists||c.FS.mkdir(e),n.forEach(t=>{c.FS.writeFile(`${e}/${t.name}`,new Uint8Array(t.data))})}function qt(n){u(c,E),n.forEach(e=>{c.FS.analyzePath(`${G}/${e.name}`).exists||c.FS.writeFile(`${G}/${e.name}`,new Uint8Array(e.data))})}function W(){k=!0;let n=g("configurePDFJavaScriptSupport",!0);return u(n.success,"An error occurred while executing the document level JavaScript."),n.changes||[]}function ft(n,e){let t;try{t=l("edit_document",{save_path:e,operations:n})}catch(r){throw new Error(`Error applying operations to document: ${r.message}`)}return t}var T=null,x=!1,H;function te(){x||(T=null,H=!1)}function j(n){x&&!n&&(x=!1,T&&B(T)),x=n}function F(){return T===null&&(T=l("read_form_json_objects",{include_line_height_factor:!1}),H=!1),T}function B(n){if(x){if(n===null)throw x=!1,new Error("Error enqueuing form JSON objects: form fields JSON is null.");T&&!H&&(H=!0),T=n;return}if(H||!x)try{te(),l("apply_form_json_objects",{form_fields_with_widgets:n})}catch(e){throw new Error("Error applying form JSON objects to "+y+": "+e.message)}}function mt(n,e,t,r,o,i){let s=bt(o,{width:t,height:r});if(u(typeof n.pageIndex=="number","Annotation must have a pageIndex"),!$.has(n.pdfObjectId))try{u(typeof n.pdfObjectId=="number","Cannot call renderAnnotation() for an annotation without pdfObjectId.");let a=l("render_annotation",{page:n.pageIndex,annotation_id:n.pdfObjectId,format:s,bitmap_width:t,bitmap_height:r,appearance_stream_type:i||"normal"});return a[0]}catch(a){J(a.message);return}}function Yt(n=[],e=[]){n.push("pspdfkit/widget"),g("removeAllAnnotations",JSON.stringify(n),JSON.stringify(e))}var gt={SharePoint:"SPO",Salesforce:"SF",[P.Maui_iOS]:"MauiIOS",[P.Maui_Android]:"MauiAndroid",[P.Maui_MacCatalyst]:"MauiMacCatalyst",[P.Maui_Windows]:"MauiWindows",[P.FlutterForWeb]:"FlutterForWeb",NodeJS:"NodeJS",Electron:"Electron"},ee=class{constructor(){this._pdfObjectIdsForIds={};this.comparisonDocuments={};this.lastOpenedComparisonDocument=null;this.persistedOpenDocument=null;this.persistedOpenDocumentConfiguration=U;this.files=new Map;this.fileDescriptor=0}loadNativeModule(e,{disableWebAssemblyStreaming:t,enableAutomaticLinkExtraction:r,overrideMemoryLimit:o}){return be=Date.now(),ut=r,X=o,Xe(e,t).then(({nativeModule:i})=>{c=i;let s=g("PSPDFKitVersion").version;if(s!==lt)throw new Error(`Native version mismatch. Please update the dependencies. Expected ${lt} but got ${s}.`);d.INTERNAL_DEBUG&&g("setLogLevel","debug")})}corePBProtoBridge(e,t,r){let o=c.allocateMemory(r.byteLength),i=null,s=null;try{o.view.set(r),i=c.corePBProtoBridge(e,t,o),s=i.result;let a={success:i.success,result:s.view.slice()};return Promise.resolve(a)}finally{o.delete(),i?.result?.delete(),i?.delete(),s?.delete()}}async writeFile(e,t){u(c,E),c.FS.writeFile(e,new Uint8Array(t))}async readFile(e){return u(c,E),c.FS.readFile(e)}async renderLinearized(e){let t=c.allocateMemory(e.byteLength),r=null;try{return t.view.set(e),r=c.renderLinearized(t),Promise.resolve(r.view.slice())}finally{t.delete(),r?.delete()}}async load(e,t,{mainThreadOrigin:r,customFonts:o,dynamicFonts:i,productId:s}){u(c,E);let a;try{if(c.FS.analyzePath(G).exists||c.FS.mkdir(G),le=o?`${G}/custom-fonts`:"",o&&!c.FS.analyzePath(le).exists&&zt(o,le),ct()&&(u(s==null||s===P.Electron,`PSPDFKit is running on Electron, but has been setup to be used with ${s}Please contact support to resolve the issue.`),s=P.Electron),a=c.initPSPDFKit(t??"",r,G,"",s&&typeof gt[s]<"u"?gt[s]:""),i){let f=await tt(i);l("dynamic_font_loading/set_metadata_file",void 0,await f.arrayBuffer()),L=i.split("/").slice(0,-1).join("/")}}catch(f){throw f}let p=JSON.parse(a);if(be&&O(`Native initialization complete, took: ${Date.now()-be}ms`),!p.success)throw new Error("Failed to initialize PSPDFKit: "+p.error);return p}getNativeModule(){return c}async openDocument(e,t){try{return u(c,E),X!==null&&g("overrideMemoryLimit",X),c.FS.writeFile(y,new Uint8Array(e)),this.openAndReturnDocumentInfo(t??U)}finally{this._pdfObjectIdsForIds={}}}async openCreateFilePathDocument(e){try{return X!==null&&g("overrideMemoryLimit",X),this.openAndReturnDocumentInfo(e??U)}finally{this._pdfObjectIdsForIds={}}}async getSuggestedLineHeightFactor(e,t){return l("get_suggested_line_height_factor",{annotation_ids:[e],page:t})[0].line_height_factors[e.toString()]}async getAvailableFontFaces(e){return e?l("get_available_font_faces")[0]?.font_faces.reduce((r,o)=>{let i=e.find(s=>s.name===o.path.replace(`${le}/`,""));return i?r.concat({readableName:o.fullName,name:i.name}):r},[]):[]}async setFontSubstitutions(e){try{l("set_font_substitutions",{substitutions:e})}catch(t){throw new Error("Error setting fonts substitutions: "+t.message)}}async getClosestSnapPoint(e,t){return l("get_closest_snap",{q:[e,t]})[0]}async configureSnapper(e){l("configure_snapper",{page:e})}async reloadDocument(){try{return j(!1),g("closeDocument"),this.openAndReturnDocumentInfo(w)}finally{this._pdfObjectIdsForIds={}}}async openAndReturnDocumentInfo(e){w=e,g("openDocument",y,JSON.stringify(e)),k&&W(),g("automaticLinkExtraction",ut);let t=g("getDocumentInfo").documentInfo;if(t.pageCount<=0)return t;let r=[];if(typeof e?.initialPageIndex=="number"){let o=await this.getPageInfo(e.initialPageIndex);for(let i=0;i<t.pageCount;i++){let s={...o,pageIndex:i,pageLabel:e.initialPageIndex===i?o.pageLabel:String(i+1)};r.push(s)}}else r=await this.getAllPageInfos(t.pageCount);return t.pages=r,t}async getPageInfo(e){try{let t=l("page_info",{query:"page_info",page:e});u(t.length===1,"expected page_info result to return 1 result when specifying index.");let r=new TextDecoder().decode(t[0]);return JSON.parse(r).pageInfo}catch{return A(`Dimensional information for page ${e} unavailable, page will not be displayed.`),{height:0,matrix:[0,0,0,0,0,0],pageLabel:"",reverseMatrix:[0,0,0,0,0,0],transformedBBox:[0,0,0,0],untransformedBBox:[0,0,0,0],width:0,pageIndex:e,rawPdfBoxes:{bleedBox:null,cropBox:null,mediaBox:null,trimBox:null}}}}async preflightRenderAnnotationText(e,t,r,o){let i=()=>typeof t=="number"&&typeof r=="number"?l("dynamic_font_loading/preflight_annotation",{text:e,annotation_id:t,page:r})[0]:(u(o,`annotation not set: ${o}`),l("dynamic_font_loading/preflight_annotation",{text:e,annotation_json:o})[0]);try{let s=i();s.preflight_result===_e.requiresMoreFonts&&(await this.addDynamicFonts(s.required_fonts),s=i()),typeof t=="number"&&(s.preflight_result===_e.unableToShape?$.add(t):$.delete(t))}catch(s){A(`There was an error testing rendering for annotation ${t} of this text: ${e}: ${s.message}`)}}async addDynamicFonts(e){let t=[];try{t=e.filter(o=>!Oe.has(o));let r=await Promise.all(t.map(o=>fetch(`${L}/${o}`).then(i=>i.arrayBuffer())));qt(r.map((o,i)=>({name:t[i],data:o}))),t.forEach(o=>{Oe.add(o)})}catch(r){t.forEach(o=>{Oe.delete(o)}),A(`There was an error loading a font: ${r}`)}await l("dynamic_font_loading/notify_fonts_added",{added_fonts:t.map(r=>({remote_file_path:r,local_file_name:r}))})}async getAllPageInfos(e){let t=[];try{let r=l("page_info",{query:"page_info",page:"all"});u(r.length===e,"expected the same length of page info response to page count.");for(let o=0;o<r.length;o++){let i=new TextDecoder().decode(r[o]),s=JSON.parse(i);t.push(s.pageInfo)}}catch{A("There was an error retrieving page information for all pages from core. Reverting to individual queries.");for(let o=0;o<e;o++)try{let i=l("page_info",{query:"page_info",page:o});u(i.length===1,"expected page_info result to return 1 result when specifying index.");let s=new TextDecoder().decode(i[0]),a=JSON.parse(s);t.push(a.pageInfo)}catch{A(`Dimensional information for page ${o} unavailable, page will not be displayed.`);let s={height:0,matrix:[0,0,0,0,0,0],pageLabel:"",reverseMatrix:[0,0,0,0,0,0],transformedBBox:[0,0,0,0],untransformedBBox:[0,0,0,0],width:0,pageIndex:o,rawPdfBoxes:{bleedBox:null,cropBox:null,mediaBox:null,trimBox:null}};t.push(s)}}return t}async enablePDFJavaScriptSupport(){return W()}async runPDFFormattingScripts(e,t){u(k,"PDF Formatting Scripts can only run after JavaScript is enabled.");let r;try{r=l("run_pdf_formatting_scripts",{form_fqns:e,only_if_no_ap_stream:t})}catch(o){throw new Error(`An error occurred while executing the document level JavaScript formatting.\n\n`+o.message)}return r[0].changes||[]}async openDocumentAt(){throw new Error("Should never be called")}async getBookmarks(){let e=l("get_bookmarks");return u(e.length===1,"expected only one response for getBookmarks"),e[0].bookmarks||[]}async getFormJSON(){return g("getFormJSON").formJSON}async getFormValues(){return g("getFormValues").formValues}async setFormValues(e){let t=F(),r=!1,o=[],i=t.map(s=>{let a=e.find(p=>p.name===s.formField.name);return a?a.value===s.value||Array.isArray(a.value)&&Array.isArray(s.value)&&a.value.every((p,f)=>p===s.value[f])?s:(typeof a.value=="string"&&a.value.length>0?o.push({widgets:s.widgets,text:a.value}):s.widgets.forEach(p=>{typeof p.pdfObjectId=="number"&&$.delete(p.pdfObjectId)}),r=!0,{...s,value:a.value}):s});if(r){if(L)for(let s=0;s<o.length;s++){let a=o[s].widgets;for(let p=0;p<a.length;p++)await this.preflightWidgetAnnotation(a[p],a[p].pdfObjectId,o[s].text)}B(i)}}async setFormFieldValue(e){await this.setFormValues([e])}async applyOperations(e,t){let r=await dt(e,t);ft(e,y),r()}async exportPDFWithOperations(e,t){let r=await dt(e,t),o;u(c,E);try{ft(e,C),o=c.FS.readFile(C).buffer}catch(i){throw new Error("Error applying operations: "+i.message)}return r(),o}async getSignaturesInfo(){try{return l("get_signatures",{certificate_check_time:"current_time"})[0]}catch(e){throw new Error(`Error getting signatures info: ${e.message}`)}}async getComments(){try{return l("get_comments")}catch(e){throw new Error(`Error getting comments: ${e.message}`)}}async applyComments(e){try{return l("apply_comments",{comments:e})}catch(t){throw new Error(`Error applying comments: ${t.message}`)}}async prepareSign(e,t,r,o,i,s){let a,h="pdf";try{a=l("get_signatures",{certificate_check_time:"current_time"})[0];let S=!1,v=a.status!=="not_signed";g("saveDocument",C,S,v,!1,!1,h,!1),g("openDocument",C,JSON.stringify(w))}catch(S){throw new Error(`Error saving document backup for invisible signing: ${S}`)}try{let S=!r&&a.status!=="not_signed";g("saveDocument",y,r,S,!1,!1,h,!1),r&&(g("openDocument",y,JSON.stringify(w)),k&&W())}catch(S){throw new Error(`Error saving document for invisible signing: ${S}`)}let m;try{m=l("prepare_sign",{signer_data_source:{...e,field_name:o,position:i,appearance:s,type:"pspdfkit/signer-data-source"},signature_metadata:{...t,type:"pspdfkit/signature-metadata"}})}catch(S){throw new Error(`Error preparing document for signing: ${S}`)}u(c,E);let _=null;return(!e||e?.signatureType===et.cms)&&(_=c.FS.readFile(m[0].result.file_contents).buffer),c.FS.unlink(m[0].result.file_contents),{file:m[0].result.file,hash:m[0].result.hash,signatureFormFieldName:m[0].result.signature_form_fqn,dataToBeSigned:m[0].result.data_to_be_signed,fileContents:_}}async getTimestampRequest(e,t){try{let[r]=l("get_timestamp_http_request",{timestamp_authority_info:{url:t.url,authenticationInfo:{username:t.username,password:t.password}},data_to_timestamp:e});return{url:r.url,method:r.method,requestData:r.request_data,contentType:r.content_type,token:r.token,username:r.user,password:r.password}}catch(r){throw new Error(`Error getting timestamp request: ${r.message}`)}}async getRevocationRequests(e){try{return l("get_revocation_http_requests",{signing_certificates:e})}catch(t){throw new Error(`Error getting revocations requests: ${t.message}`)}}async setSignaturesLTV(e){try{let t=l("get_signatures",{certificate_check_time:"current_time",revocation_responses:e})[0];return g("saveDocument",y,!1,!0,!1,!1,"pdf",!1),t}catch(t){throw new Error(`Error getting signatures info: ${t.message}`)}}async sign(e,t,r,o,i,s,a,p,f){let h;try{let m,_=Ke.toUint8Array(i).buffer;(a?a==="pkcs7":nt(_))||(m=l("create_signature",{signatureType:o,hash:r,signed_data:i,certificates:s,timestamp_response:p})),h=l("sign",{password:w?.password,save_path:y,file_path:e,signature_form_fqn:t,pkcs7_container:m?.[0].result||i,revocation_responses:f??[]}),g("openDocument",y,JSON.stringify(w)),k&&W()}catch(m){throw new Error(`Error signing document: ${m}`)}return h[0].result}async restoreToOriginalState(){try{g("openDocument",C,JSON.stringify(w)),k&&W();let e=l("get_signatures",{certificate_check_time:"current_time"})[0],t=!1,r=!1,o="pdf",i=!1,s=e.status!=="not_signed";g("saveDocument",y,i,s,t,r,o,!1),g("openDocument",y,JSON.stringify(w)),k&&W()}catch(e){throw new Error(`Could not restore backup document: ${e}`)}}async evalFormValuesActions(e){let r=F().reduce((i,s)=>e.find(({name:a})=>s.formField.name===a)&&s.formField.type==="pspdfkit/form-field/text"?i.concat(s):i,[]);if(L)for(let i=0;i<r.length;i++){let s=r[i].widgets;for(let a=0;a<s.length;a++)await this.preflightWidgetAnnotation(s[a],s[a].pdfObjectId,e.find(p=>r[a].formField.name===p.name)?.value)}let o=l("set_form_values_get_script_changes",{form_values:e});return u(o.length===1,"expected only one response for evalFormValuesActions"),this._processChanges(o[0].changes)}async readFormJSONObjects(){return F()}async setFormJSONUpdateBatchMode(e){await j(e)}_processChanges(e){return e.map(t=>t.object.type==="pspdfkit/javascript/effects/importIcon"?{...t,object:{...t.object,id:Object.entries(this._pdfObjectIdsForIds).find(([,r])=>r===t.object.annotationID)?.[0]}}:t)}async evalScript(e,t,r){let o=l("run_pdf_javascript",{pdf_javascript_contents:e,pdf_javascript_trigger_event:t,pdf_javascript_form_fqn:r});return u(o.length===1,"expected only one response for evalScript"),this._processChanges(o[0].changes)}async closeDocument(){try{return Se=[],w={password:void 0,initialPageIndex:void 0},k=!1,T=null,x=!1,H=!1,g("closeDocument")}finally{this._pdfObjectIdsForIds={}}}async renderAnnotation(e,t,r,o,i,s){return mt({...e,pdfObjectId:this._getPdfObjectIdForObject(e)},t?await q(t):null,r,o,i,s)}async renderPageAnnotations(e,t,r,o,i){return t.map((s,a)=>mt({pdfObjectId:s,pageIndex:e},null,r[a],o[a],bt(i,{width:r[a],height:o[a]})))}async renderDetachedAnnotation(e,t,r,o,i){u(c,E),L&&(e.type==="pspdfkit/stamp"||e.type==="pspdfkit/text")&&await this.preflightAnnotation(e,e.pdfObjectId);let s=t?await q(t):null,a=t?t.type:null,p,f,h=new c.VectorUint8;try{if(s!=null)for(let m=0;m<s.byteLength;m++)h.push_back(s[m]);if(f=pt("renderDetachedAnnotation",i,JSON.stringify({...e,pdfObjectId:this._getPdfObjectIdForObject(e),pageIndex:0}),0,r,o,h,a||""),!f.hasError()&&f.getRepliesCount()===1)p=f.getBinaryReply(0).slice(0);else{let m=f.getErrorMessage(),_=f.getErrorReason();throw new Error(_+": "+m)}}finally{h&&h.delete(),f&&f.delete()}return p}async loadCertificates(e){if(l("load_certificates",{certificates:e}).length>0)throw new R("Internal error while loading certificates")}async getAttachment(e){let t,r,o,a=(await this.getEmbeddedFilesList())?.map(p=>p.id)?.includes(e);try{if(a)l("extract_embedded_file",{id:e,file_path:ce}),t=c.FS.readFile(ce).buffer;else if(r=pt("getAnnotationAttachment",e),!r.hasError()&&r.getRepliesCount()===1)o=JSON.parse(r.getJSONReply(0)).encoding,t=r.getBinaryReply(0).slice(0);else{let p=r.getErrorMessage(),f=r.getErrorReason();throw new Error("Error fetching attachment: "+f+", "+p)}}finally{c.FS.analyzePath(ce)?.exists&&c.FS.unlink(ce),r&&r.delete()}return[t,o]}async annotationsForPageIndex(e){let t=g("annotationsForPageIndex",e);return["rollover","down"].forEach(r=>{t.apstream_variants?.[r]?.forEach(o=>{let i=t.annotations.find(s=>s.pdfObjectId===o);i?i[r]=!0:t.annotations.push({pdfObjectId:o,[r]:!0})})}),t.annotations}async getTabOrder(e){return l("get_annotation_tab_order",{page:e})[0].order.map(r=>({id:Object.entries(this._pdfObjectIdsForIds).find(([i,s])=>s===r)?.[0]||String(r),pdfObjectId:r}))}async setTabOrder(e,t){let r=t.map(o=>this._getPdfObjectIdForObject(o));l("set_annotation_tab_order",{page:e,order:r})}async createAnnotation(e,t){u(c,E),u(typeof e.pageIndex=="number","Annotation must have a pageIndex");let r=e.pdfObjectId,o=t?await q(t):null,i,s=new c.VectorUint8;try{if(o!=null)for(let f=0;f<o.byteLength;f++)s.push_back(o[f]);e.type==="pspdfkit/widget"&&(j(!1),te());let p=(e.type==="pspdfkit/shape/ellipse"||e.type==="pspdfkit/shape/rectangle")&&e.measurementScale?{...e,measurementBBox:e.bbox}:e;i=g("createAnnotation",JSON.stringify({...p,pdfObjectId:null}),s)}finally{s&&s.delete()}return typeof r=="number"&&typeof this._pdfObjectIdsForIds[r.toString()]=="number"&&delete this._pdfObjectIdsForIds[r.toString()],this._pdfObjectIdsForIds[e.id||i.pdfObjectId.toString()]=i.pdfObjectId,e&&this.canPreflightAnnotation(e)&&L&&await this.preflightAnnotation(e,i.pdfObjectId),i.pdfObjectId}async updateAnnotation(e){let t={...e,pdfObjectId:this._getPdfObjectIdForObject(e)};if(u(t.id,"Annotation must have an ID"),u(typeof t.pageIndex=="number","Annotation must have a pageIndex"),t.type==="pspdfkit/widget"){let r=F(),o=typeof t.pdfObjectId=="number"?t.pdfObjectId.toString():t.id;B(r.map(i=>i.formField.annotationIds.includes(o)||i.formField.annotationIds.includes(String(t.pdfObjectId))?{...i,widgets:i.widgets.map(s=>s.id===o||String(s.pdfObjectId)===o?t:s)}:i))}else e&&this.canPreflightAnnotation(e)&&L&&await this.preflightAnnotation(e,t.pdfObjectId),g("updateAnnotation",JSON.stringify(t),0,0)}async updateButtonIcon(e,t,r){l("update_annotation",{annotation:{...e,pdfObjectId:this._getPdfObjectIdForObject(e),contentType:r}},t)}async deleteAnnotation(e){if(e.APStreamCache&&await this.updateAnnotation(e),e.type==="pspdfkit/widget")try{let t=e.id,r=F();B(r.map(o=>{if(o.formField.annotationIds.includes(t)||o.formField.annotationIds.includes(String(e.pdfObjectId))){let i,s=o.value;if((o.formField.type==="pspdfkit/form-field/checkbox"||o.formField.type==="pspdfkit/form-field/radio")&&o.formField.options.length===o.formField.annotationIds.length){let f=o.formField.annotationIds.includes(t)?o.formField.annotationIds.indexOf(t):o.formField.annotationIds.indexOf(String(e.pdfObjectId));i=o.formField.options.filter((h,m)=>m!==f),i.some(h=>h.value===s)||(s="")}let a=o.widgets.filter(f=>t!==f.id),p=o.formField.annotationIds.filter(f=>f!==t&&f!==String(e.pdfObjectId));return a.length>0&&p.length>0?{...o,formField:{...o.formField,annotationIds:p,...i?{options:i}:null},widgets:a,value:s}:null}return o}).filter(Boolean))}catch(t){throw t}else try{l("remove_annotations",{annotation_ids:[this._getPdfObjectIdForObject(e)]})}catch{J(`Removing annotation failed for annotation: ${JSON.stringify(e)}`)}delete this._pdfObjectIdsForIds[e.id||e.pdfObjectId?.toString()],$.delete(e.pdfObjectId)}async createFormField(e,t){let o=F().concat([{type:"pspdfkit/form-field-with-widgets",formField:e,widgets:t}]),i=x;x&&j(!1),B(o);let s=F();i&&j(!0);let a=s.find(f=>f.formField.name===e.name);if(!a)throw new Error(`Error creating new form field in ${y}: created form field not found. ${JSON.stringify({type:"pspdfkit/form-field-with-widgets",formField:e,widgets:t})}`);let p=a.widgets.map(f=>(this._pdfObjectIdsForIds[f.id]=f.pdfObjectId,f.pdfObjectId));return typeof e.pdfObjectId=="number"&&typeof this._pdfObjectIdsForIds[e.pdfObjectId.toString()]=="number"&&delete this._pdfObjectIdsForIds[e.pdfObjectId.toString()],this._pdfObjectIdsForIds[e.id||a.formField.pdfObjectId.toString()]=a.formField.pdfObjectId,p}async updateFormField(e,t){let r={...e,pdfObjectId:this._pdfObjectIdsForIds[e.id]||this._getPdfObjectIdForObject(e)},o=F(),i=o.find(m=>ht(m.formField,r)||m.formField.name===e.name);if(!i)throw new Error(`Error updating form field with name "${e.name}" in ${y}: form field not found. ${JSON.stringify(o)}`);let s=i.formField.name!==e.name,a=null;if(s&&r.type==="pspdfkit/form-field/radio"){let m=e.name,_=o.find(S=>S.formField.name===m);_&&_.formField.type==="pspdfkit/form-field/radio"&&(r={...r,annotationIds:[...r.annotationIds,..._.formField.annotationIds],options:[...r.options,..._.formField.options]},t=[...t,..._.widgets],a=_)}let p=o.map(m=>{if(a&&a.formField.pdfObjectId===m.formField.pdfObjectId)return null;if(ht(m.formField,r)||m.formField.name===e.name){let _={type:"pspdfkit/form-field-with-widgets",formField:{...m.formField,...r},widgets:t.reduce((S,v)=>{let M=m.widgets.find(ne=>ne.id===v.id||ne.pdfObjectId===v.pdfObjectId);return[...S,{...M,...v}]},[]),...typeof m.value<"u"?{value:m.value}:null};return e.flags||delete _.formField.flags,_}else return m}).filter(Boolean);B(p);let h=F().find(m=>m.formField.name===e.name);if(!h)throw new Error(`Error updating form field "${e.name}" in ${y}: updated form field not found. ${JSON.stringify({type:"pspdfkit/form-field-with-widgets",formField:e,widgets:t})}`);h.formField.pdfObjectId!==r.pdfObjectId&&(this._pdfObjectIdsForIds[r.id]=h.formField.pdfObjectId),i?.widgets.forEach(m=>{t.some(_=>_.id===m.id)||delete this._pdfObjectIdsForIds[m.id]})}async deleteFormField(e){let t=F(),r=t.find(a=>a.formField.name===e.name);if(!r)return;let o=t.filter(a=>a.formField.name!==e.name);B(o);let s=F().find(a=>a.formField.name===e.name);if(!s)r.widgets.forEach(a=>{delete this._pdfObjectIdsForIds[a.id]});else throw new Error(`Error deleting form field with name "${e.name}" in ${y}: form field still present. ${JSON.stringify(s)}`)}async deleteFormFieldValue(e){let t=F();B(t.map(r=>r.formField.name===e?{formField:r.formField,widgets:r.widgets,type:r.type}:r))}canPreflightAnnotation(e){return e.type==="pspdfkit/text"||e.type==="pspdfkit/stamp"}async preflightAnnotation(e,t){if(!this.canPreflightAnnotation(e))return;let r=e.type==="pspdfkit/stamp"?e.title:e.text?.value;if(typeof t=="number"&&!r){$.delete(t);return}r&&await this.preflightRenderAnnotationText(r,t,e.pageIndex,{...e,pdfObjectId:this._getPdfObjectIdForObject(e),pageIndex:0})}async preflightWidgetAnnotation(e,t,r){if(!r&&typeof t=="number"){$.delete(t);return}r&&await this.preflightRenderAnnotationText(r,t,e.pageIndex)}async createBookmark(e){try{l("append_bookmarks",{bookmarks:[e]})}catch(t){throw new Error(`Error creating new bookmark in ${y}: ${t.message}`)}}async updateBookmark(e){try{l("remove_bookmarks",{bookmarkIds:[e.id??e.pdfBookmarkId]}),l("append_bookmarks",{bookmarks:[e]})}catch(t){throw new Error(`Error updating bookmark in ${y}: ${t.message}`)}}async deleteBookmark(e){try{l("remove_bookmarks",{bookmarkIds:[e]})}catch(t){throw new Error(`Error deleting bookmark in ${y}: ${t.message}`)}}async getTextFromRects(e,t){return g("getTextFromRects",e,JSON.stringify(t.map(o=>[o.left,o.top,o.width,o.height]))).text}async search(e,t,r,o,i=Ze.TEXT){return l("search",{query:e,start_index:t,limit:r,case_sensitive:o,search_type:i})}async parseXFDF(e,t){try{let r=l("convert_xfdf_to_instant_json",{ignore_page_rotation:t},e);return Wt(r[0])}catch(r){throw r}}async getEmbeddedFilesList(){return l("list_embedded_files")[0].embeddedFiles||null}async getMeasurementSnappingPoints(e){let t=l("get_snapping_points",{page:e});return t[0].snappingPoints?Xt(t[0].snappingPoints):null}async getSecondaryMeasurementUnit(){try{return l("get_secondary_measurement_unit")[0]||null}catch(e){throw new Error(`Error getting secondary measurement: ${e.message}`)}}async compareDocuments(e){try{u(e.originalDocument.arrayBuffer,"Original document arrayBuffer is missing"),u(e.changedDocument.arrayBuffer,"Changed document arrayBuffer is missing"),c.FS.writeFile("documentA.pdf",new Uint8Array(e.originalDocument.arrayBuffer)),c.FS.writeFile("documentB.pdf",new Uint8Array(e.changedDocument.arrayBuffer));let t={originalDocument:{...e.originalDocument,filePath:"documentA.pdf"},changedDocument:{...e.changedDocument,filePath:"documentB.pdf"},comparisons:[e.comparisonOperation]};return l("document_comparison",t)||null}catch(t){throw new Error(`Error comparing documents: ${t.message}`)}}async setSecondaryMeasurementUnit(e){try{l("set_secondary_measurement_unit",e?{unitTo:e?.unitTo,precision:e?.precision}:null)}catch{J("Error setting secondary measurement unit")}}async getMeasurementScales(){try{return l("get_measurement_content_formats")[0]||null}catch(e){throw new Error(`Error getting measurement scales: ${e.message}`)}}async removeMeasurementScale(e){try{l("remove_measurement_content_format",{measurementContentFormat:ie(e)})}catch(t){throw new Error(`Error removing ${e.name} measurement scale: ${t.message}`)}}async addMeasurementScale(e){try{l("add_measurement_content_format",{measurementContentFormat:ie(e)})}catch(t){throw new Error(`Error adding ${e.name} measurement scale: ${t.message}`)}}async getAnnotationsByScale(e){try{return l("get_annotations_for_measurement_content_format",{measurementContentFormat:ie(e)})||null}catch(t){throw t}}async exportFile(e,t,r,o,i,s,a,p){let f={mimeType:"application/pdf",extension:"pdf"},h;try{h=l("save_document",{file_path:y,format:o,flatten_annotations:e,save_incrementally:t,apply_redactions:!1,save_for_printing:r,remove_all_annotations:i,preserve_change_tracker_state:s,...a?{user_password:a.userPassword,owner_password:a.ownerPassword,document_permissions:yt(a.documentPermissions)}:null}),p&&(p.forEach(({pageIndex:v,id:M,pdfObjectId:ne})=>{l("electronic_signatures/flatten",{page:v,annotation_id:this._getPdfObjectIdForObject({id:M,pdfObjectId:ne})})}),h=l("save_document",{file_path:C,format:o,flatten_annotations:e,save_incrementally:t,apply_redactions:!1,save_for_printing:r,remove_all_annotations:i,preserve_change_tracker_state:s,...a?{user_password:a.userPassword,owner_password:a.ownerPassword,document_permissions:yt(a.documentPermissions)}:null}))}catch(S){throw new Error(`Error saving to ${C}: ${S.message}`)}let m=h[0];m.format&&(f={mimeType:m.format.mime_type,extension:m.format.extension}),u(c,E);let _=c.FS.readFile(p?C:y).buffer;return p&&(g("closeDocument"),g("openDocument",y,JSON.stringify(w))),[_,f]}async importXFDF(e,t,r){Se.push({source:e,keepCurrentAnnotations:t}),t||Yt(),g("importXFDF",e,r)}async exportXFDF(e){return g("exportXFDF",[],[],e).XFDF}async importInstantJSON(e){g("importInstantDocumentJSON",JSON.stringify(e))}async exportInstantJSON(e){let t=x;x&&j(!1);let r=g("exportInstantDocumentJSON",typeof e=="number"?e:-1);return t&&j(!0),JSON.parse(r.InstantDocumentJSON)}async getDocumentOutline(){let e=l("get_outline");return u(e.length===1,"expected only one response for getDocumentOutline"),e[0].outline||[]}async setDocumentOutline(e){return l("set_outline",{outline:e})}async getPageGlyphs(e){return l("get_glyphs",{page:e})[0].glyphs||[]}async onKeystrokeEvent(e){let t=l("on_keystroke_event",{pdf_javascript_event:e});u(t.length===1,"expected only one response for onKeystrokeEvent");let r=t[0].changes||[];return u(r.length>0&&r[0].change_type===4,"expected onKeystrokeEvent to return at least one JavaScript Event change."),r}async version(){return g("PSPDFKitVersion").version}getImportedXFDF(){return Se}async applyRedactions(){try{g("saveDocument",y,!1,!1,!0,!1,"pdf",!1)}catch(e){throw new Error(`Error applying redactions and saving to ${y}: ${e.message}`)}}async clearAPStreamCache(){g("clearAPStreamCache")}async setComparisonDocument(e,t){this.comparisonDocuments[e]=t||(await this.exportFile(!1,!1,!1,"pdf",!1,!1))[0]}async openComparisonDocument(e){return u(this.comparisonDocuments[e]),e===this.lastOpenedComparisonDocument||e===I.documentA&&this.lastOpenedComparisonDocument===null&&this.persistedOpenDocument instanceof ArrayBuffer?null:(this.lastOpenedComparisonDocument=e,this.openDocument(this.comparisonDocuments[e],this.persistedOpenDocument===e?this.persistedOpenDocumentConfiguration:U))}async documentCompareAndOpen(e){u(this.comparisonDocuments[I.documentA]&&this.comparisonDocuments[I.documentB],"One or both comparison input documents are missing.");let t=`${I.documentA}.pdf`,r=`${I.documentB}.pdf`;c.FS.writeFile(t,new Uint8Array(this.comparisonDocuments[I.documentA])),c.FS.writeFile(r,new Uint8Array(this.comparisonDocuments[I.documentB]));let o={documentA:{strokeColor:e.documentA.strokeColor,pageIndex:e.documentA.pageIndex,filePath:t},documentB:{strokeColor:e.documentB.strokeColor,pageIndex:e.documentB.pageIndex,filePath:r},options:{...e.options,outputFilePath:"output.pdf"}};return l("comparison",o),await this.closeDocument(),this.comparisonDocuments[I.result]=c.FS.readFile("output.pdf").buffer,this.lastOpenedComparisonDocument=I.result,this.openDocument(this.comparisonDocuments[I.result],U)}async persistOpenDocument(e){if(e)this.persistedOpenDocument=e;else try{this.persistedOpenDocument=(await this.exportFile(!1,!1,!1,"pdf",!1,!0))[0]}catch(t){throw new Error(`Error trying to persist a copy of the currently opened document: ${t.message}`)}this.persistedOpenDocumentConfiguration=w}async cleanupDocumentComparison(){u(this.persistedOpenDocument,"No persisted previous document key or array buffer is available.");let e=this.persistedOpenDocument instanceof ArrayBuffer?this.persistedOpenDocument:this.comparisonDocuments[this.persistedOpenDocument];u(e,"No persisted previous array buffer is available.");try{await this.closeDocument()}catch(r){throw new Error(`Error trying to close the current document: ${r.message}`)}let t=this.openDocument(e,this.persistedOpenDocumentConfiguration);return this.persistedOpenDocument=null,this.persistedOpenDocumentConfiguration=U,this.lastOpenedComparisonDocument=null,this.comparisonDocuments={},t}_getPdfObjectIdForObject(e){return typeof e.pdfObjectId=="number"?e.pdfObjectId:this._pdfObjectIdsForIds[e.id]}async getOCGs(){return l("ocg/get_ocgs")[0].ocgs}async getOCGVisibilityState(){return{visibleLayerIds:l("ocg/get_visibility_state")[0].state.visible}}async setOCGVisibilityState(e){return l("ocg/set_visibility_state",{state:{visible:e.visibleLayerIds}})}async dispatchCommand(e){let t=null,r;D&&(r=performance.now());try{if(t=await c.dispatchCommand(e),t===null)throw Error("dispatchCommand returned null");if(t.hasError())return{success:!1,message:t.getErrorMessage(),code:t.getErrorReason()};let o={success:!0,values:[]};for(let i=0;i<t.getRepliesCount();i++)t.hasJSONReply(i)&&o.values.push(JSON.parse(t.getJSONReply(i))),t.hasBinaryReply(i)&&o.values.push(t.getBinaryReply(i).slice(0));if(D){let i=JSON.parse(e);Q.push({type:0,name:i.type,args:i,time:performance.now()-r})}return o}finally{t&&t.delete()}}async getCoreCallRecording(){return Q}async enableCoreCallRecording(e){D=e}openFile(e,t){let r=c.FS.open(e,t);return this.files.set(this.fileDescriptor,r),Promise.resolve(this.fileDescriptor++)}closeFile(e){let t=this.files.get(e);return t&&(c.FS.close(t),this.files.delete(e)),Promise.resolve()}writeData(e,t,r){let o=this.files.get(e);if(!o)throw Error(`Trying to write to a file with descriptor ${e}, but the file is not open.`);return c.FS.write(o,new Uint8Array(t),0,t.byteLength,r),Promise.resolve()}recycle(){}destroy(){}};function bt(n,{width:e,height:t}){return n==="webp"&&(e>he||t>he)||st&&e*t>Qe&&n==="bitmap"?"png":n}function Xt(n){let e=[...n.endpoints,...n.intersections,...n.midpoints],t=[];for(let r=0;r<e.length;r=r+2){let o=[e[r],e[r+1]];t.push(o)}return t.sort((r,o)=>r[0]==o[0]?r[1]-o[1]:r[0]-o[0])}function yt(n){let e=[];for(let t=0;t<n.length;t++)e.push($t[n[t]]);return e}function ht(n,e){return n.pdfObjectId===e.pdfObjectId}(function(){typeof self>"u"&&typeof global=="object"&&(global.self=global)})();var Zt=new ee;Ee.parentPort?.on("message",async n=>{let e,t;if(n.action==="loadNativeModule"){let[r,o]=n.args;o&&typeof o=="object"&&"mainThreadOrigin"in o&&(self.location={origin:o.mainThreadOrigin})}try{let r=await Zt[n.action](...n.args);if(e={data:{id:n.id,result:r}},Array.isArray(r)){let o=r.filter(i=>i instanceof ArrayBuffer);o.length>0&&(t=o)}r instanceof ArrayBuffer&&(t=[r])}catch(r){let o=[...n.args].filter(i=>i instanceof ArrayBuffer);o.length>0&&(t=o),A("[PSPDFKit Internal Debug]",r.message,r.stack),e={data:{id:n.id,error:r.message||r.toString(),callArgs:n.args}}}Ee.parentPort?.postMessage(e,t)});\n'}),ev={};S(ev,{default:()=>ek});import{Worker as eb}from"node:worker_threads";async function ew(){let e=new eb(et,{eval:!0,name:"core"});return{setMessageHandler(t){e?.on("message",t)},postMessage(t,r){e?.postMessage(t,r)},terminate(){e?.terminate(),e=null}}}var ek,eE=x(()=>{"use strict";D(),e_(),ek=ew});async function eI(e,t){let r;if("string"!=typeof e)return{initDotnet:r}=await import(e.wasmLoaderPath),r(e.baseUrl);{let r=`${k.BUNDLE}/`,n=`${r}gdpicture-${k.GDPICTURE_HASH}/jit`,i=`${n}/initDotnet.js`,a=`${r}gdpicture-${k.GDPICTURE_HASH}/aot`,s=`${a}/initDotnet.js`,o,u;t?(o=`${e}${s}`,u=`${e}${a}`):(o=`${e}${i}`,u=`${e}${n}`);let{initDotnet:d}=await import(o);return d(u,(e,t,r,n,i)=>"blazor.boot.json"===t?fetch(r,{credentials:"same-origin"}):null)}}var ex,eO=x(()=>{"use strict";D()}),eS=x(()=>{"use strict";var e;D(),(e=ex||{})[e.pdf_a_1a=0]="pdf_a_1a",e[e.pdf_a_1b=1]="pdf_a_1b",e[e.pdf_a_2a=2]="pdf_a_2a",e[e.pdf_a_2u=3]="pdf_a_2u",e[e.pdf_a_2b=4]="pdf_a_2b",e[e.pdf_a_3a=5]="pdf_a_3a",e[e.pdf_a_3u=6]="pdf_a_3u",e[e.pdf_a_3b=7]="pdf_a_3b",e[e.pdf_a_4=8]="pdf_a_4",e[e.pdf_a_4e=9]="pdf_a_4e",e[e.pdf_a_4f=10]="pdf_a_4f",ex=e});function eT(e,...t){let r,n;for(let i of(F(eZ,"GdPicture WebAssembly is not loaded."),eN&&(r=performance.now(),L(`Request: ${e}(${t.map(e=>JSON.stringify(e)).join(", ")})`)),t))n=Object.assign(t[0],i);let i=JSON.stringify({type:e,...n}),a=JSON.parse(eZ.CommandHandler(i));if(eN&&(F("number"==typeof r),L(`Response from ${e} (${(performance.now()-r).toFixed(2)} ms): ${JSON.stringify(a)}`)),!a.success)throw Error(a.errorReason+": "+a.errorMessage+`
`+a.error);return a}var eC,eD,eA,eF,eP,eN,ej,eZ,eR,eB,eL=x(()=>{"use strict";D(),Y(),er(),eO(),eS(),eC="/create.pdf",eD="/save.pdf",eA="/create.docx",eF="/save.docx",eP="/templateData.json",eN=!1,"u">typeof WorkerGlobalScope&&(self,WorkerGlobalScope),ej=null,eZ=null,eR=class{_mountCustomFonts(e,t){F(ej,"WebAssembly module not loaded."),ej.FS.mkdir(t),e.forEach(e=>{ej.FS.writeFile(`${t}/${e.name}`,new Uint8Array(e.data))})}async loadModule(e,t,r,n,i,a,s){let o;eN&&(o=performance.now(),L("loading GdPicture WASM"));let{Assemblies:u,Module:d}=await eI(e,t);eZ=u.GdPictureWasm.API,ej=d,eN&&(F("number"==typeof o),L(`Finished Loading GdPicture WASM (${(performance.now()-o).toFixed(2)} ms)`)),eT("gdpicture/setLicense",{origin:r},{licenseKey:n||"DEMO_PSPDFKIT_WEB"});let c=i?"/fonts":"";if(i&&!ej.FS.analyzePath(c).exists&&(this._mountCustomFonts(i,c),eT("gdpicture/setFonts",{fontPaths:[c]})),a){let e=await ee(a);eT("gdpicture/setDynamicFontLoading",{baseUrl:a.split("/").slice(0,-1).join("/"),allowedFonts:e.availableFonts,v:1})}s&&eT("gdpicture/setFontSubstitutions",{fontSubstitutions:s})}toPdf(e,t){ej.FS.writeFile(eC,new Uint8Array(e));let r={file:eD,format:"pdf"};t&&t in ex&&(r.conformance=t);try{return eT("gdpicture/process",{input:{file:eC},output:r}),ej.FS.readFile(eD).buffer}finally{try{ej.FS.unlink(eD)}catch{}}}toOffice(e,t){ej.FS.writeFile(eC,new Uint8Array(e));let r=`/save.${t}`;try{return eT("gdpicture/process",{input:{file:eC},output:{file:r,format:t}}),ej.FS.readFile(r).buffer}finally{try{ej.FS.unlink(r)}catch(e){console.log(e.message)}}}async populateDocumentTemplate(e,t){let r;ej.FS.writeFile(eA,new Uint8Array(e));try{r=JSON.stringify(t,null,2)}catch{throw Error("Invalid config data")}ej.FS.writeFile(eP,r);try{return eT("gdpicture/process-office-template",{inputFile:eA,modelAndConfigFile:eP,outputFile:eF}),ej.FS.readFile(eF).buffer}finally{try{ej.FS.unlink(eF),ej.FS.unlink(eP)}catch(e){console.log(e.message)}}}}}),eM=x(()=>{"use strict";D(),Y(),eB=class{constructor({baseUrl:e,aot:t,mainThreadOrigin:r,licenseKey:n,customFonts:i,dynamicFonts:a,fontSubstitutions:s,workerSpawner:o,wasmLoaderPath:u}){this.requests=new Map,this.nextRequestId=1,this.handleMessage=e=>{let t=e.data,r=this.requests.get(t.id);F(r,`No request was made for id ${t.id}.`);let{resolve:n,reject:i}=r;if(this.requests.delete(t.id),t.error){let e=new I(t.error);e.callArgs=t.callArgs,i(e)}else n(t.result)},this.workerSpawner=o,this.workerSpawner.setMessageHandler(this.handleMessage),this.moduleLoadPromise=this.sendRequest("loadModule",[u?{baseUrl:e,wasmLoaderPath:u}:e,t,r,n,i,a,s])}toOffice(e,t){return this.sendRequest("toOffice",[e,t])}toPdf(e,t){let r;return t&&(r=t.replace("pdf","pdf_").replaceAll("-","_")),this.sendRequest("toPdf",[e,r])}async populateDocumentTemplate(e,t){return this.sendRequest("populateDocumentTemplate",[e,t])}destroy(){this.workerSpawner?.terminate(),this.workerSpawner=null}async sendRequest(e,t){F(this.workerSpawner,"GdPictureClient has been destroyed"),this.moduleLoadPromise&&await this.moduleLoadPromise;let r=this.workerSpawner;return new Promise((n,i)=>{let a=this.assignId(),s=[...t].filter(e=>e instanceof ArrayBuffer);r.postMessage({id:a,action:e,args:t},s),this.requests=this.requests.set(a,{resolve:n,reject:i})})}assignId(){let e=this.nextRequestId;return this.nextRequestId=this.nextRequestId+1,e}}}),eq={};S(eq,{default:()=>eU});var eU,ez=x(()=>{D(),eU={}});async function e$(e=!0){let t;if(e){let{default:e}=await Promise.resolve().then(()=>(ez(),eq));t=new e}else t=new Worker(new URL("../workers/GdPictureBrowser.worker.ts",import.meta.url));return{setMessageHandler(e){F(t,"Worker is null"),t.onmessage=e},postMessage(e,r){t?.postMessage(e,r)},terminate(){t?.terminate(),t=null}}}var eV,eJ=x(()=>{"use strict";D(),Y(),eV=e$}),eW={};S(eW,{Conformance:()=>ex,GdPicture:()=>eR,GdPictureWorker:()=>eB,getBrowserSpawner:()=>eV});var eG,eK=x(()=>{"use strict";D(),eL(),eM(),eJ(),eS()}),eX=x(()=>{eG='var import_meta_url = require(\'url\').pathToFileURL(__filename)\n"use strict";var s={BUNDLE:"/vendor",BACKEND_BUILD:"true",GDPICTURE_HASH:"d2ca6bda4cb907731fb7296e7cced273bc5ad2c4"};var h=require("node:worker_threads");var w=function e(r){let t;return r instanceof Error?t=r:t=new Error(r),Object.setPrototypeOf(t,e.prototype),t};w.prototype=Object.create(Error.prototype,{name:{value:"PSPDFKitError",enumerable:!1}});var c=w;function u(e,r){if(!e)throw new c(`Assertion failed: ${r||"Condition not met"}\n\nFor further assistance, please go to: https://pspdfkit.com/support/request`)}function d(e){console.log(e)}function b(e){console.error(e)}var N=["a[href]","area[href]","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])","iframe","object","embed","[contenteditable]",\'[tabindex]:not([tabindex^="-"])\'],B=N.join(",");async function G(e){try{let r=await fetch(e).catch(t=>{throw new c(`Error fetching dynamic fonts file ${e}. ${t}`)});if(r.status!==200)throw new c(`Error fetching dynamic fonts file ${e}. Status code: ${r.status}`);return r}catch(r){throw r}}async function R(e){return(await G(e)).json().catch(t=>{throw new c(`Error parsing dynamic fonts file ${e}. ${t}`)})}async function k(e,r){let t;if(typeof e=="string"){let i=`${s.BUNDLE}/`,a=`${i}gdpicture-${s.GDPICTURE_HASH}/jit`,l=`${a}/initDotnet.js`,m=`${i}gdpicture-${s.GDPICTURE_HASH}/aot`,y=`${m}/initDotnet.js`,E,g;r?(E=`${e}${y}`,g=`${e}${m}`):(E=`${e}${l}`,g=`${e}${a}`);let{initDotnet:n}=await import(E);return n(g,(I,T,v,$,U)=>T==="blazor.boot.json"?fetch(v,{credentials:"same-origin"}):null)}else return{initDotnet:t}=await import(e.wasmLoaderPath),t(e.baseUrl)}var A=(n=>(n[n.pdf_a_1a=0]="pdf_a_1a",n[n.pdf_a_1b=1]="pdf_a_1b",n[n.pdf_a_2a=2]="pdf_a_2a",n[n.pdf_a_2u=3]="pdf_a_2u",n[n.pdf_a_2b=4]="pdf_a_2b",n[n.pdf_a_3a=5]="pdf_a_3a",n[n.pdf_a_3u=6]="pdf_a_3u",n[n.pdf_a_3b=7]="pdf_a_3b",n[n.pdf_a_4=8]="pdf_a_4",n[n.pdf_a_4e=9]="pdf_a_4e",n[n.pdf_a_4f=10]="pdf_a_4f",n))(A||{});var P="/create.pdf",S="/save.pdf",C="/create.docx",D="/save.docx",O="/templateData.json",L="WebAssembly module not loaded.",_=!1,Tt=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,f=null,x=null;function p(e,...r){u(x,"GdPicture WebAssembly is not loaded.");let t;_&&(t=performance.now(),d(`Request: ${e}(${r.map(l=>JSON.stringify(l)).join(", ")})`));let o;for(let l of r)o=Object.assign(r[0],l);let i=JSON.stringify({type:e,...o}),a=JSON.parse(x.CommandHandler(i));if(_&&(u(typeof t=="number"),d(`Response from ${e} (${(performance.now()-t).toFixed(2)} ms): ${JSON.stringify(a)}`)),!a.success)throw new Error(a.errorReason+": "+a.errorMessage+`\n`+a.error);return a}var F=class{_mountCustomFonts(r,t){u(f,L),f.FS.mkdir(t),r.forEach(o=>{f.FS.writeFile(`${t}/${o.name}`,new Uint8Array(o.data))})}async loadModule(r,t,o,i,a,l,m){let y;_&&(y=performance.now(),d("loading GdPicture WASM"));let{Assemblies:E,Module:g}=await k(r,t);x=E.GdPictureWasm.API,f=g,_&&(u(typeof y=="number"),d(`Finished Loading GdPicture WASM (${(performance.now()-y).toFixed(2)} ms)`)),p("gdpicture/setLicense",{origin:o},{licenseKey:i||"DEMO_PSPDFKIT_WEB"});let n=a?"/fonts":"";if(a&&!f.FS.analyzePath(n).exists&&(this._mountCustomFonts(a,n),p("gdpicture/setFonts",{fontPaths:[n]})),l){let I=await R(l),T=l.split("/").slice(0,-1).join("/");p("gdpicture/setDynamicFontLoading",{baseUrl:T,allowedFonts:I.availableFonts,v:1})}m&&p("gdpicture/setFontSubstitutions",{fontSubstitutions:m})}toPdf(r,t){f.FS.writeFile(P,new Uint8Array(r));let o={file:S,format:"pdf"};t&&t in A&&(o.conformance=t);try{return p("gdpicture/process",{input:{file:P},output:o}),f.FS.readFile(S).buffer}finally{try{f.FS.unlink(S)}catch{}}}toOffice(r,t){f.FS.writeFile(P,new Uint8Array(r));let o=`/save.${t}`,i={file:o,format:t};try{return p("gdpicture/process",{input:{file:P},output:i}),f.FS.readFile(o).buffer}finally{try{f.FS.unlink(o)}catch(a){console.log(a.message)}}}async populateDocumentTemplate(r,t){f.FS.writeFile(C,new Uint8Array(r));let o;try{o=JSON.stringify(t,null,2)}catch{throw new Error("Invalid config data")}f.FS.writeFile(O,o);try{return p("gdpicture/process-office-template",{inputFile:C,modelAndConfigFile:O,outputFile:D}),f.FS.readFile(D).buffer}finally{try{f.FS.unlink(D),f.FS.unlink(O)}catch(i){console.log(i.message)}}}};var j=new F;h.parentPort?.on("message",async e=>{let r,t;try{let o=await j[e.action](...e.args);if(r={data:{id:e.id,result:o}},Array.isArray(o)){let i=o.filter(a=>a instanceof ArrayBuffer);i.length>0&&(t=i)}o instanceof ArrayBuffer&&(t=[o])}catch(o){let i=[...e.args].filter(a=>a instanceof ArrayBuffer);i.length>0&&(t=i),b("[PSPDFKit Internal Debug]",o.message,o.stack),r={data:{id:e.id,error:o.message||o.toString(),callArgs:e.args}}}h.parentPort?.postMessage(r,t)});\n'}),eH={};S(eH,{default:()=>e0});import{Worker as eY}from"node:worker_threads";async function eQ(){let e=new eY(eG,{eval:!0,name:"GdPicture"});return{setMessageHandler(t){e?.on("message",t)},postMessage(t,r){e?.postMessage(t,r)},terminate(){e?.terminate(),e=null}}}var e0,e1=x(()=>{"use strict";D(),eX(),e0=eQ});D();import e2 from"node:path";import{fileURLToPath as e4}from"node:url";D(),D(),Y(),D();var e3={TEXT:"text"},e6=()=>{},e7=class{constructor(){this._requests=new Map,this._nextRequestId=1,this._isLoading=!0,this._loadPromise=null,this._initPromise=null,this._hasOpenedDocument=!1,this._hasLoadedCertificates=!1,this._handleMessage=e=>{let t=e.data,r=this._requests.get(t.id);F(r,`No request was made for id ${t.id}.`);let{resolve:n,reject:i}=r;if(this._requests.delete(t.id),t.error){let e=new I(t.error);e.callArgs=t.callArgs,i(e)}else n(t.result)}}getNativeModule(){throw Error("Method not implemented.")}async loadNativeModule(e,{mainThreadOrigin:t,disableWebAssemblyStreaming:r,enableAutomaticLinkExtraction:n,overrideMemoryLimit:i,wasmLoaderPath:a,wasm:s,workerSpawnerFn:o}){return F(!this._hasOpenedDocument,"cannot invoke `loadNativeModule` while an instance is still in use. Please call `recycle` first."),this._loadPromise?this._loadPromise.then(()=>{}):(this._initPromise||(this.workerSpawner||(this.workerSpawner=await o(),this.workerSpawner.setMessageHandler(this._handleMessage)),this._baseCoreUrl=e,this._mainThreadOrigin=t,this._initPromise=this._sendRequest("loadNativeModule",[a&&s?{wasm:s,wasmLoaderPath:a}:e,{mainThreadOrigin:t,disableWebAssemblyStreaming:r,enableAutomaticLinkExtraction:n,overrideMemoryLimit:i}]).then(e=>e).catch(e=>{throw this._isLoading=!1,this.destroy(),e})),this._initPromise)}load(e,t,{mainThreadOrigin:r,customFonts:n,dynamicFonts:i,productId:a}){return F(!this._hasOpenedDocument,"cannot invoke `load` while an instance is still in use. Please call `recycle` first."),this._loadPromise||(this._loadPromise=this._sendRequest("load",[e,t,{mainThreadOrigin:r,customFonts:n,dynamicFonts:i,productId:a}]).then(e=>(this._isLoading=!1,e)).catch(e=>{throw this._isLoading=!1,this.workerSpawner?.terminate(),e})),this._loadPromise}corePBProtoBridge(e,t,r){return this._assertLoaded(),this._sendRequest("corePBProtoBridge",[e,t,r])}version(){return this._assertLoaded(),this._sendRequest("version")}writeFile(e,t){return this._assertLoaded(),this._sendRequest("writeFile",[e,t])}readFile(e){return this._assertLoaded(),this._sendRequest("readFile",[e])}openDocument(e,t){return this._assertLoaded(),this._hasOpenedDocument=!0,this._sendRequest("openDocument",[e,t]).catch(e=>{throw this._hasOpenedDocument=!1,e})}openCreateFilePathDocument(e){return this._assertLoaded(),this._hasOpenedDocument=!0,this._sendRequest("openCreateFilePathDocument",[e]).catch(e=>{throw this._hasOpenedDocument=!1,e})}async getMeasurementScales(){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("getMeasurementScales")}async removeMeasurementScale(e){return this._sendRequest("removeMeasurementScale",[e])}async addMeasurementScale(e){return await this._sendRequest("addMeasurementScale",[e])}async getAnnotationsByScale(e){return await this._sendRequest("getAnnotationsByScale",[e])}async openDocumentAt(){throw Error("Should never be called")}async getAllPageInfos(e){return this._assertLoaded(),this._sendRequest("getAllPageInfos",[e])}async enablePDFJavaScriptSupport(){return this._assertLoaded(),this._sendRequest("enablePDFJavaScriptSupport")}async runPDFFormattingScripts(e,t){return this._assertLoaded(),this._sendRequest("runPDFFormattingScripts",[e,t])}async getSuggestedLineHeightFactor(e,t){return this._assertLoaded(),this._sendRequest("getSuggestedLineHeightFactor",[e,t])}async getAvailableFontFaces(e){return this._assertLoaded(),this._sendRequest("getAvailableFontFaces",[e])}async setFontSubstitutions(e){return this._assertLoaded(),this._sendRequest("setFontSubstitutions",[e])}getBookmarks(){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("getBookmarks")}getFormJSON(){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("getFormJSON")}evalFormValuesActions(e){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("evalFormValuesActions",[e])}evalScript(e,t,r){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("evalScript",[e,t,r])}setFormJSONUpdateBatchMode(e){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("setFormJSONUpdateBatchMode",[e])}getFormValues(){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("getFormValues")}closeDocument(){return this._assertLoaded(),this._hasOpenedDocument=!1,this._sendRequest("closeDocument")}renderAnnotation(e,t,r,n,i,a){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("renderAnnotation",[e,t,r,n,i,a])}renderPageAnnotations(e,t,r,n,i){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("renderPageAnnotations",[e,t,r,n,i])}renderDetachedAnnotation(e,t,r,n,i){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("renderDetachedAnnotation",[e,t,r,n,i])}onKeystrokeEvent(e){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("onKeystrokeEvent",[e])}getAttachment(e){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("getAttachment",[e])}annotationsForPageIndex(e){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("annotationsForPageIndex",[e])}getTabOrder(e){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("getTabOrder",[e])}setTabOrder(e,t){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("setTabOrder",[e,t])}createAnnotation(e,t){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("createAnnotation",[e,t])}updateAnnotation(e){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("updateAnnotation",[e])}deleteAnnotation(e){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("deleteAnnotation",[e])}createFormField(e,t){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("createFormField",[e,t])}updateFormField(e,t){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("updateFormField",[e,t])}deleteFormField(e){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("deleteFormField",[e])}setFormFieldValue(e){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("setFormFieldValue",[e])}deleteFormFieldValue(e){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("deleteFormFieldValue",[e])}createBookmark(e){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("createBookmark",[e])}updateBookmark(e){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("updateBookmark",[e])}deleteBookmark(e){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("deleteBookmark",[e])}setDocumentOutline(e){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("setDocumentOutline",[e])}getTextFromRects(e,t){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("getTextFromRects",[e,t])}getClosestSnapPoint(e,t){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("getClosestSnapPoint",[e,t])}configureSnapper(e){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("configureSnapper",[e])}search(e,t,r,n,i=e3.TEXT){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("search",[e,t,r,n,i])}getSecondaryMeasurementUnit(){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("getSecondaryMeasurementUnit",[])}compareDocuments(e){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("compareDocuments",[e])}setSecondaryMeasurementUnit(e){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("setSecondaryMeasurementUnit",[e])}getMeasurementSnappingPoints(e){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("getMeasurementSnappingPoints",[e])}parseXFDF(e,t){return this._sendRequest("parseXFDF",[e,t])}getEmbeddedFilesList(){return this._sendRequest("getEmbeddedFilesList")}exportFile(e=!1,t=!1,r,n="pdf",i=!1,a,s,o){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("exportFile",[e,t,r,n,i,a,s,o])}importXFDF(e,t=!1,r=!1){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("importXFDF",[e,t,r])}exportXFDF(e){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("exportXFDF",[e])}importInstantJSON(e){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("importInstantJSON",[e])}exportInstantJSON(e){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("exportInstantJSON",[e])}getDocumentOutline(){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("getDocumentOutline")}getPageGlyphs(e){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("getPageGlyphs",[e])}applyOperations(e,t){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("applyOperations",[e,t])}reloadDocument(){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("reloadDocument")}exportPDFWithOperations(e,t){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("exportPDFWithOperations",[e,t])}loadCertificates(e){return this._assertLoaded(),this._assertDocumentOpen(),this._hasLoadedCertificates=!!e.length,this._sendRequest("loadCertificates",[e]).catch(e=>{throw this._hasLoadedCertificates=!1,e})}getSignaturesInfo(){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("getSignaturesInfo",[])}getComments(){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("getComments",[])}applyComments(e){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("applyComments",[e])}prepareSign(e,t,r,n,i,a){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("prepareSign",[e,t,r,n,i,a])}getTimestampRequest(e,t){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("getTimestampRequest",[e,t])}getRevocationRequests(e){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("getRevocationRequests",[e])}setSignaturesLTV(e){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("setSignaturesLTV",[e])}sign(e,t,r,n,i,a,s,o,u){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("sign",[e,t,r,n,i,a,s,o,u])}restoreToOriginalState(){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("restoreToOriginalState")}applyRedactions(){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("applyRedactions",[])}readFormJSONObjects(){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("readFormJSONObjects")}clearAPStreamCache(){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("clearAPStreamCache")}setComparisonDocument(e,t){return this._assertLoaded(),t||this._assertDocumentOpen(),this._sendRequest("setComparisonDocument",[e,t])}openComparisonDocument(e){return this._assertLoaded(),this._hasOpenedDocument=!0,this._sendRequest("openComparisonDocument",[e]).catch(e=>{throw this._hasOpenedDocument=!1,e})}documentCompareAndOpen(e){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("documentCompareAndOpen",[e])}persistOpenDocument(e){return this._assertLoaded(),e||this._assertDocumentOpen(),this._sendRequest("persistOpenDocument",[e])}cleanupDocumentComparison(){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("cleanupDocumentComparison")}getOCGs(){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("getOCGs",[])}getOCGVisibilityState(){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("getOCGVisibilityState",[])}setOCGVisibilityState(e){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("setOCGVisibilityState",[e])}updateButtonIcon(e,t,r){return this._assertLoaded(),this._assertDocumentOpen(),this._sendRequest("updateButtonIcon",[e,t,r])}dispatchCommand(e){return this._assertLoaded(),this._sendRequest("dispatchCommand",[e])}recycle(){this._hasLoadedCertificates&&this.loadCertificates([]),this._hasOpenedDocument&&this.closeDocument(),this._isLoading||this._requests.forEach((e,t)=>{this._requests.set(t,{resolve:e6,reject:e6})})}destroy(){this._loadPromise=null,this.workerSpawner?.terminate()}_assertLoaded(){if(this._isLoading)throw new I("CoreClient not yet initialized")}_assertDocumentOpen(){if(!this._hasOpenedDocument)throw new I("This method can not be called since there is no open document. Have you run PSPDFKit.unload()?")}openFile(e,t){return this._assertLoaded(),this._sendRequest("openFile",[e,t])}closeFile(e){return this._assertLoaded(),this._sendRequest("closeFile",[e])}writeData(e,t,r){return this._assertLoaded(),this._sendRequest("writeData",[e,t,r])}async renderLinearized(e){return this._assertLoaded(),this._sendRequest("renderLinearized",[e])}_sendRequest(e,t=[]){F(this.workerSpawner,"CoreClient has been destroyed");let r=this.workerSpawner;return new Promise((n,i)=>{let a=this._assignId(),s=[...t].filter(e=>e instanceof ArrayBuffer);r.postMessage({id:a,action:e,args:t},s),this._requests=this._requests.set(a,{resolve:n,reject:i})})}_assignId(){let e=this._nextRequestId;return this._nextRequestId=this._nextRequestId+1,e}getCoreCallRecording(){return this._assertLoaded(),this._sendRequest("getCoreCallRecording")}enableCoreCallRecording(e){return this._assertLoaded(),this._sendRequest("enableCoreCallRecording",[e])}};D(),D(),Y(),D(),D(),D(),D(),Y(),D(),D(),D(),Y(),"object"==typeof process&&"object"==typeof process.versions&&process.versions.node,k.BUNDLE,D(),D(),D(),D();var e5={Maui_Android:"Maui_Android",Maui_iOS:"Maui_iOS",Maui_MacCatalyst:"Maui_MacCatalyst",Maui_Windows:"Maui_Windows",FlutterForWeb:"FlutterForWeb"};function e8(e=globalThis.navigator?.userAgent??""){return e.indexOf("Trident/")>-1?"trident":e.indexOf("Edge/")>-1?"edge":e.indexOf("Chrome/")>-1?"blink":e.indexOf("AppleWebKit/")>-1?"webkit":e.indexOf("Gecko/")>-1?"gecko":"unknown"}function e9(e,t){let r=RegExp(` ${t}/(\\d+)\\.*`),n;return(n=e.match(r))?Number(n[1]):0}function te(e=globalThis.navigator?.userAgent??"",t=globalThis.navigator?.platform??"",r=globalThis.navigator?.maxTouchPoints??0){return t.indexOf("MacIntel")>-1&&r>1?"ios":e.indexOf("Win")>-1?"windows":e.indexOf("iPhone")>-1||e.indexOf("iPad")>-1||"iPad"===t?"ios":e.indexOf("Mac")>-1?"macos":e.indexOf("Android")>-1?"android":e.indexOf("Linux")>-1?"linux":"unknown"}D(),D(),er(),D(),e8();var tt=te();function tr(e=e8()){return!("u">typeof window&&window.PSPDFKIT_PLAYWRIGHT_TEST||globalThis.navigator?.userAgent.indexOf("jsdom/")>=0)&&"webkit"===e&&"u">typeof TouchEvent}(function(e=globalThis.navigator?.userAgent){switch(e8(e)){case"trident":return e9(e,"Trident");case"edge":return e9(e,"Edge");case"blink":return e9(e,"Chrome");case"webkit":return e9(e,"Version");case"gecko":return e9(e,"Firefox");default:return 0}})(),function(e=te(),t=e8()){"ios"===e||"android"===e||tr(t)}(),"ios"===tt||tr(),"u">typeof window&&(window.addEventListener("mousemove",function e(){window.removeEventListener("mousemove",e)}),window.addEventListener("pointermove",function e(t){"mouse"===t.pointerType||t.pointerType,window.removeEventListener("pointermove",e)})),/Mac/i.test(globalThis.navigator?.platform),D(),D(),Y(),D(),D(),D(),e5.Maui_iOS,e5.Maui_Android,e5.Maui_MacCatalyst,e5.Maui_Windows,e5.FlutterForWeb,D(),Y(),D();var tn=C(ey());Y(),D(),Y(),D(),(tp=tf||(tf={})).assertEqual=e=>e,tp.assertIs=function(e){},tp.assertNever=function(e){throw Error()},tp.arrayToEnum=e=>{let t={};for(let r of e)t[r]=r;return t},tp.getValidEnumValues=e=>{let t=tp.objectKeys(e).filter(t=>"number"!=typeof e[e[t]]),r={};for(let n of t)r[n]=e[n];return tp.objectValues(r)},tp.objectValues=e=>tp.objectKeys(e).map(function(t){return e[t]}),tp.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{let t=[];for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t},tp.find=(e,t)=>{for(let r of e)if(t(r))return r},tp.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e,tp.joinValues=function(e,t=" | "){return e.map(e=>"string"==typeof e?`'${e}'`:e).join(t)},tp.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t,(tm||(tm={})).mergeShapes=(e,t)=>({...e,...t});var ti=tf.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ta=e=>{switch(typeof e){case"undefined":return ti.undefined;case"string":return ti.string;case"number":return isNaN(e)?ti.nan:ti.number;case"boolean":return ti.boolean;case"function":return ti.function;case"bigint":return ti.bigint;case"symbol":return ti.symbol;case"object":return Array.isArray(e)?ti.array:null===e?ti.null:e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch?ti.promise:"u">typeof Map&&e instanceof Map?ti.map:"u">typeof Set&&e instanceof Set?ti.set:"u">typeof Date&&e instanceof Date?ti.date:ti.object;default:return ti.unknown}},ts=tf.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),to=class extends Error{constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};let t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){let t=e||function(e){return e.message},r={_errors:[]},n=e=>{for(let i of e.issues)if("invalid_union"===i.code)i.unionErrors.map(n);else if("invalid_return_type"===i.code)n(i.returnTypeError);else if("invalid_arguments"===i.code)n(i.argumentsError);else if(0===i.path.length)r._errors.push(t(i));else{let e=r,n=0;for(;n<i.path.length;){let r=i.path[n];n===i.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(t(i))):e[r]=e[r]||{_errors:[]},e=e[r],n++}}};return n(this),r}toString(){return this.message}get message(){return JSON.stringify(this.issues,tf.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){let t={},r=[];for(let n of this.issues)n.path.length>0?(t[n.path[0]]=t[n.path[0]]||[],t[n.path[0]].push(e(n))):r.push(e(n));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}};to.create=e=>new to(e);var tu=(e,t)=>{let r;switch(e.code){case ts.invalid_type:r=e.received===ti.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case ts.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,tf.jsonStringifyReplacer)}`;break;case ts.unrecognized_keys:r=`Unrecognized key(s) in object: ${tf.joinValues(e.keys,", ")}`;break;case ts.invalid_union:r="Invalid input";break;case ts.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${tf.joinValues(e.options)}`;break;case ts.invalid_enum_value:r=`Invalid enum value. Expected ${tf.joinValues(e.options)}, received '${e.received}'`;break;case ts.invalid_arguments:r="Invalid function arguments";break;case ts.invalid_return_type:r="Invalid function return type";break;case ts.invalid_date:r="Invalid date";break;case ts.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:tf.assertNever(e.validation):r="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case ts.too_small:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case ts.too_big:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case ts.custom:r="Invalid input";break;case ts.invalid_intersection_types:r="Intersection results could not be merged";break;case ts.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case ts.not_finite:r="Number must be finite";break;default:r=t.defaultError,tf.assertNever(e)}return{message:r}},td=tu;function tc(){return td}var tl=e=>{let{data:t,path:r,errorMaps:n,issueData:i}=e,a=[...r,...i.path||[]],s={...i,path:a},o="";for(let e of n.filter(e=>!!e).slice().reverse())o=e(s,{data:t,defaultError:o}).message;return{...i,path:a,message:i.message||o}};function th(e,t){let r=tl({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,tc(),tu].filter(e=>!!e)});e.common.issues.push(r)}var tp,tf,tm,ty,tg=class e{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){let r=[];for(let n of t){if("aborted"===n.status)return t_;"dirty"===n.status&&e.dirty(),r.push(n.value)}return{status:e.value,value:r}}static async mergeObjectAsync(t,r){let n=[];for(let e of r)n.push({key:await e.key,value:await e.value});return e.mergeObjectSync(t,n)}static mergeObjectSync(e,t){let r={};for(let n of t){let{key:t,value:i}=n;if("aborted"===t.status||"aborted"===i.status)return t_;"dirty"===t.status&&e.dirty(),"dirty"===i.status&&e.dirty(),"__proto__"!==t.value&&("u">typeof i.value||n.alwaysSet)&&(r[t.value]=i.value)}return{status:e.value,value:r}}},t_=Object.freeze({status:"aborted"}),tv=e=>({status:"dirty",value:e}),tb=e=>({status:"valid",value:e}),tw=e=>"aborted"===e.status,tk=e=>"dirty"===e.status,tE=e=>"valid"===e.status,tI=e=>"u">typeof Promise&&e instanceof Promise;(tT=ty||(ty={})).errToObj=e=>"string"==typeof e?{message:e}:e||{},tT.toString=e=>"string"==typeof e?e:e?.message;var tx=class{constructor(e,t,r,n){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},tO=(e,t)=>{if(tE(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new to(e.common.issues);return this._error=t,this._error}}};function tS(e){if(!e)return{};let{errorMap:t,invalid_type_error:r,required_error:n,description:i}=e;if(t&&(r||n))throw Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return t?{errorMap:t,description:i}:{errorMap:(e,t)=>"invalid_type"!==e.code?{message:t.defaultError}:typeof t.data>"u"?{message:n??t.defaultError}:{message:r??t.defaultError},description:i}}var tT,tC,tD=class{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return ta(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:ta(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new tg,ctx:{common:e.parent.common,data:e.data,parsedType:ta(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(tI(t))throw Error("Synchronous parse encountered promise.");return t}_parseAsync(e){return Promise.resolve(this._parse(e))}parse(e,t){let r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){var r;let n={common:{issues:[],async:null!==(r=t?.async)&&void 0!==r&&r,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ta(e)},i=this._parseSync({data:e,path:n.path,parent:n});return tO(n,i)}async parseAsync(e,t){let r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){let r={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ta(e)},n=this._parse({data:e,path:r.path,parent:r});return tO(r,await (tI(n)?n:Promise.resolve(n)))}refine(e,t){let r=e=>"string"==typeof t||typeof t>"u"?{message:t}:"function"==typeof t?t(e):t;return this._refinement((t,n)=>{let i=e(t),a=()=>n.addIssue({code:ts.custom,...r(t)});return"u">typeof Promise&&i instanceof Promise?i.then(e=>!!e||(a(),!1)):!!i||(a(),!1)})}refinement(e,t){return this._refinement((r,n)=>!!e(r)||(n.addIssue("function"==typeof t?t(r,n):t),!1))}_refinement(e){return new ri({schema:this,typeName:rf.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return ra.create(this,this._def)}nullable(){return rs.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return tH.create(this,this._def)}promise(){return rn.create(this,this._def)}or(e){return tQ.create([this,e],this._def)}and(e){return t2.create(this,e,this._def)}transform(e){return new ri({...tS(this._def),schema:this,typeName:rf.ZodEffects,effect:{type:"transform",transform:e}})}default(e){return new ro({...tS(this._def),innerType:this,defaultValue:"function"==typeof e?e:()=>e,typeName:rf.ZodDefault})}brand(){return new rl({typeName:rf.ZodBranded,type:this,...tS(this._def)})}catch(e){return new ru({...tS(this._def),innerType:this,catchValue:"function"==typeof e?e:()=>e,typeName:rf.ZodCatch})}describe(e){return new this.constructor({...this._def,description:e})}pipe(e){return rh.create(this,e)}readonly(){return rp.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},tA=/^c[^\s-]{8,}$/i,tF=/^[a-z][a-z0-9]*$/,tP=/^[0-9A-HJKMNP-TV-Z]{26}$/,tN=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,tj=/^(?!\.)(?!.*\.\.)([A-Z0-9_+-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,tZ=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,tR=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,tB=e=>e.precision?e.offset?RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${e.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${e.precision}}Z$`):0===e.precision?e.offset?RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):e.offset?RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$"),tL=class e extends tD{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ti.string){let t=this._getOrReturnCtx(e);return th(t,{code:ts.invalid_type,expected:ti.string,received:t.parsedType}),t_}let t=new tg,r;for(let a of this._def.checks)if("min"===a.kind)e.data.length<a.value&&(th(r=this._getOrReturnCtx(e,r),{code:ts.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),t.dirty());else if("max"===a.kind)e.data.length>a.value&&(th(r=this._getOrReturnCtx(e,r),{code:ts.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),t.dirty());else if("length"===a.kind){let n=e.data.length>a.value,i=e.data.length<a.value;(n||i)&&(r=this._getOrReturnCtx(e,r),n?th(r,{code:ts.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):i&&th(r,{code:ts.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),t.dirty())}else if("email"===a.kind)tj.test(e.data)||(th(r=this._getOrReturnCtx(e,r),{validation:"email",code:ts.invalid_string,message:a.message}),t.dirty());else if("emoji"===a.kind)tC||(tC=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),tC.test(e.data)||(th(r=this._getOrReturnCtx(e,r),{validation:"emoji",code:ts.invalid_string,message:a.message}),t.dirty());else if("uuid"===a.kind)tN.test(e.data)||(th(r=this._getOrReturnCtx(e,r),{validation:"uuid",code:ts.invalid_string,message:a.message}),t.dirty());else if("cuid"===a.kind)tA.test(e.data)||(th(r=this._getOrReturnCtx(e,r),{validation:"cuid",code:ts.invalid_string,message:a.message}),t.dirty());else if("cuid2"===a.kind)tF.test(e.data)||(th(r=this._getOrReturnCtx(e,r),{validation:"cuid2",code:ts.invalid_string,message:a.message}),t.dirty());else if("ulid"===a.kind)tP.test(e.data)||(th(r=this._getOrReturnCtx(e,r),{validation:"ulid",code:ts.invalid_string,message:a.message}),t.dirty());else if("url"===a.kind)try{new URL(e.data)}catch{th(r=this._getOrReturnCtx(e,r),{validation:"url",code:ts.invalid_string,message:a.message}),t.dirty()}else{var n,i;"regex"===a.kind?(a.regex.lastIndex=0,a.regex.test(e.data)||(th(r=this._getOrReturnCtx(e,r),{validation:"regex",code:ts.invalid_string,message:a.message}),t.dirty())):"trim"===a.kind?e.data=e.data.trim():"includes"===a.kind?e.data.includes(a.value,a.position)||(th(r=this._getOrReturnCtx(e,r),{code:ts.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),t.dirty()):"toLowerCase"===a.kind?e.data=e.data.toLowerCase():"toUpperCase"===a.kind?e.data=e.data.toUpperCase():"startsWith"===a.kind?e.data.startsWith(a.value)||(th(r=this._getOrReturnCtx(e,r),{code:ts.invalid_string,validation:{startsWith:a.value},message:a.message}),t.dirty()):"endsWith"===a.kind?e.data.endsWith(a.value)||(th(r=this._getOrReturnCtx(e,r),{code:ts.invalid_string,validation:{endsWith:a.value},message:a.message}),t.dirty()):"datetime"===a.kind?tB(a).test(e.data)||(th(r=this._getOrReturnCtx(e,r),{code:ts.invalid_string,validation:"datetime",message:a.message}),t.dirty()):"ip"===a.kind?(n=e.data,("v4"===(i=a.version)||!i)&&tZ.test(n)||("v6"===i||!i)&&tR.test(n)||(th(r=this._getOrReturnCtx(e,r),{validation:"ip",code:ts.invalid_string,message:a.message}),t.dirty())):tf.assertNever(a)}return{status:t.value,value:e.data}}_regex(e,t,r){return this.refinement(t=>e.test(t),{validation:t,code:ts.invalid_string,...ty.errToObj(r)})}_addCheck(t){return new e({...this._def,checks:[...this._def.checks,t]})}email(e){return this._addCheck({kind:"email",...ty.errToObj(e)})}url(e){return this._addCheck({kind:"url",...ty.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...ty.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...ty.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...ty.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...ty.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...ty.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...ty.errToObj(e)})}datetime(e){var t;return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:null!==(t=e?.offset)&&void 0!==t&&t,...ty.errToObj(e?.message)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...ty.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...ty.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...ty.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...ty.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...ty.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...ty.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...ty.errToObj(t)})}nonempty(e){return this.min(1,ty.errToObj(e))}trim(){return new e({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new e({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new e({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>"datetime"===e.kind)}get isEmail(){return!!this._def.checks.find(e=>"email"===e.kind)}get isURL(){return!!this._def.checks.find(e=>"url"===e.kind)}get isEmoji(){return!!this._def.checks.find(e=>"emoji"===e.kind)}get isUUID(){return!!this._def.checks.find(e=>"uuid"===e.kind)}get isCUID(){return!!this._def.checks.find(e=>"cuid"===e.kind)}get isCUID2(){return!!this._def.checks.find(e=>"cuid2"===e.kind)}get isULID(){return!!this._def.checks.find(e=>"ulid"===e.kind)}get isIP(){return!!this._def.checks.find(e=>"ip"===e.kind)}get minLength(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}};tL.create=e=>{var t;return new tL({checks:[],typeName:rf.ZodString,coerce:null!==(t=e?.coerce)&&void 0!==t&&t,...tS(e)})};var tM=class e extends tD{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ti.number){let t=this._getOrReturnCtx(e);return th(t,{code:ts.invalid_type,expected:ti.number,received:t.parsedType}),t_}let t,r=new tg;for(let n of this._def.checks)"int"===n.kind?tf.isInteger(e.data)||(th(t=this._getOrReturnCtx(e,t),{code:ts.invalid_type,expected:"integer",received:"float",message:n.message}),r.dirty()):"min"===n.kind?(n.inclusive?e.data<n.value:e.data<=n.value)&&(th(t=this._getOrReturnCtx(e,t),{code:ts.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty()):"max"===n.kind?(n.inclusive?e.data>n.value:e.data>=n.value)&&(th(t=this._getOrReturnCtx(e,t),{code:ts.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty()):"multipleOf"===n.kind?0!==function(e,t){let r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,i=r>n?r:n;return parseInt(e.toFixed(i).replace(".",""))%parseInt(t.toFixed(i).replace(".",""))/Math.pow(10,i)}(e.data,n.value)&&(th(t=this._getOrReturnCtx(e,t),{code:ts.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):"finite"===n.kind?Number.isFinite(e.data)||(th(t=this._getOrReturnCtx(e,t),{code:ts.not_finite,message:n.message}),r.dirty()):tf.assertNever(n);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,ty.toString(t))}gt(e,t){return this.setLimit("min",e,!1,ty.toString(t))}lte(e,t){return this.setLimit("max",e,!0,ty.toString(t))}lt(e,t){return this.setLimit("max",e,!1,ty.toString(t))}setLimit(t,r,n,i){return new e({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:ty.toString(i)}]})}_addCheck(t){return new e({...this._def,checks:[...this._def.checks,t]})}int(e){return this._addCheck({kind:"int",message:ty.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ty.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ty.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ty.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ty.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:ty.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:ty.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ty.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ty.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>"int"===e.kind||"multipleOf"===e.kind&&tf.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let r of this._def.checks){if("finite"===r.kind||"int"===r.kind||"multipleOf"===r.kind)return!0;"min"===r.kind?(null===t||r.value>t)&&(t=r.value):"max"===r.kind&&(null===e||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}};tM.create=e=>new tM({checks:[],typeName:rf.ZodNumber,coerce:e?.coerce||!1,...tS(e)});var tq=class e extends tD{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==ti.bigint){let t=this._getOrReturnCtx(e);return th(t,{code:ts.invalid_type,expected:ti.bigint,received:t.parsedType}),t_}let t,r=new tg;for(let n of this._def.checks)"min"===n.kind?(n.inclusive?e.data<n.value:e.data<=n.value)&&(th(t=this._getOrReturnCtx(e,t),{code:ts.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):"max"===n.kind?(n.inclusive?e.data>n.value:e.data>=n.value)&&(th(t=this._getOrReturnCtx(e,t),{code:ts.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):"multipleOf"===n.kind?e.data%n.value!==BigInt(0)&&(th(t=this._getOrReturnCtx(e,t),{code:ts.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):tf.assertNever(n);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,ty.toString(t))}gt(e,t){return this.setLimit("min",e,!1,ty.toString(t))}lte(e,t){return this.setLimit("max",e,!0,ty.toString(t))}lt(e,t){return this.setLimit("max",e,!1,ty.toString(t))}setLimit(t,r,n,i){return new e({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:ty.toString(i)}]})}_addCheck(t){return new e({...this._def,checks:[...this._def.checks,t]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ty.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ty.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ty.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ty.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:ty.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}};tq.create=e=>{var t;return new tq({checks:[],typeName:rf.ZodBigInt,coerce:null!==(t=e?.coerce)&&void 0!==t&&t,...tS(e)})};var tU=class extends tD{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ti.boolean){let t=this._getOrReturnCtx(e);return th(t,{code:ts.invalid_type,expected:ti.boolean,received:t.parsedType}),t_}return tb(e.data)}};tU.create=e=>new tU({typeName:rf.ZodBoolean,coerce:e?.coerce||!1,...tS(e)});var tz=class e extends tD{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ti.date){let t=this._getOrReturnCtx(e);return th(t,{code:ts.invalid_type,expected:ti.date,received:t.parsedType}),t_}if(isNaN(e.data.getTime()))return th(this._getOrReturnCtx(e),{code:ts.invalid_date}),t_;let t=new tg,r;for(let n of this._def.checks)"min"===n.kind?e.data.getTime()<n.value&&(th(r=this._getOrReturnCtx(e,r),{code:ts.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),t.dirty()):"max"===n.kind?e.data.getTime()>n.value&&(th(r=this._getOrReturnCtx(e,r),{code:ts.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),t.dirty()):tf.assertNever(n);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(t){return new e({...this._def,checks:[...this._def.checks,t]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:ty.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:ty.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}};tz.create=e=>new tz({checks:[],coerce:e?.coerce||!1,typeName:rf.ZodDate,...tS(e)});var t$=class extends tD{_parse(e){if(this._getType(e)!==ti.symbol){let t=this._getOrReturnCtx(e);return th(t,{code:ts.invalid_type,expected:ti.symbol,received:t.parsedType}),t_}return tb(e.data)}};t$.create=e=>new t$({typeName:rf.ZodSymbol,...tS(e)});var tV=class extends tD{_parse(e){if(this._getType(e)!==ti.undefined){let t=this._getOrReturnCtx(e);return th(t,{code:ts.invalid_type,expected:ti.undefined,received:t.parsedType}),t_}return tb(e.data)}};tV.create=e=>new tV({typeName:rf.ZodUndefined,...tS(e)});var tJ=class extends tD{_parse(e){if(this._getType(e)!==ti.null){let t=this._getOrReturnCtx(e);return th(t,{code:ts.invalid_type,expected:ti.null,received:t.parsedType}),t_}return tb(e.data)}};tJ.create=e=>new tJ({typeName:rf.ZodNull,...tS(e)});var tW=class extends tD{constructor(){super(...arguments),this._any=!0}_parse(e){return tb(e.data)}};tW.create=e=>new tW({typeName:rf.ZodAny,...tS(e)});var tG=class extends tD{constructor(){super(...arguments),this._unknown=!0}_parse(e){return tb(e.data)}};tG.create=e=>new tG({typeName:rf.ZodUnknown,...tS(e)});var tK=class extends tD{_parse(e){let t=this._getOrReturnCtx(e);return th(t,{code:ts.invalid_type,expected:ti.never,received:t.parsedType}),t_}};tK.create=e=>new tK({typeName:rf.ZodNever,...tS(e)});var tX=class extends tD{_parse(e){if(this._getType(e)!==ti.undefined){let t=this._getOrReturnCtx(e);return th(t,{code:ts.invalid_type,expected:ti.void,received:t.parsedType}),t_}return tb(e.data)}};tX.create=e=>new tX({typeName:rf.ZodVoid,...tS(e)});var tH=class e extends tD{_parse(e){let{ctx:t,status:r}=this._processInputParams(e),n=this._def;if(t.parsedType!==ti.array)return th(t,{code:ts.invalid_type,expected:ti.array,received:t.parsedType}),t_;if(null!==n.exactLength){let e=t.data.length>n.exactLength.value,i=t.data.length<n.exactLength.value;(e||i)&&(th(t,{code:e?ts.too_big:ts.too_small,minimum:i?n.exactLength.value:void 0,maximum:e?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),r.dirty())}if(null!==n.minLength&&t.data.length<n.minLength.value&&(th(t,{code:ts.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),r.dirty()),null!==n.maxLength&&t.data.length>n.maxLength.value&&(th(t,{code:ts.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((e,r)=>n.type._parseAsync(new tx(t,e,t.path,r)))).then(e=>tg.mergeArray(r,e));let i=[...t.data].map((e,r)=>n.type._parseSync(new tx(t,e,t.path,r)));return tg.mergeArray(r,i)}get element(){return this._def.type}min(t,r){return new e({...this._def,minLength:{value:t,message:ty.toString(r)}})}max(t,r){return new e({...this._def,maxLength:{value:t,message:ty.toString(r)}})}length(t,r){return new e({...this._def,exactLength:{value:t,message:ty.toString(r)}})}nonempty(e){return this.min(1,e)}};tH.create=(e,t)=>new tH({type:e,minLength:null,maxLength:null,exactLength:null,typeName:rf.ZodArray,...tS(t)});var tY=class e extends tD{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;let e=this._def.shape(),t=tf.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==ti.object){let t=this._getOrReturnCtx(e);return th(t,{code:ts.invalid_type,expected:ti.object,received:t.parsedType}),t_}let{status:t,ctx:r}=this._processInputParams(e),{shape:n,keys:i}=this._getCached(),a=[];if(!(this._def.catchall instanceof tK&&"strip"===this._def.unknownKeys))for(let e in r.data)i.includes(e)||a.push(e);let s=[];for(let e of i){let t=n[e],i=r.data[e];s.push({key:{status:"valid",value:e},value:t._parse(new tx(r,i,r.path,e)),alwaysSet:e in r.data})}if(this._def.catchall instanceof tK){let e=this._def.unknownKeys;if("passthrough"===e)for(let e of a)s.push({key:{status:"valid",value:e},value:{status:"valid",value:r.data[e]}});else if("strict"===e)a.length>0&&(th(r,{code:ts.unrecognized_keys,keys:a}),t.dirty());else if("strip"!==e)throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let e=this._def.catchall;for(let t of a){let n=r.data[t];s.push({key:{status:"valid",value:t},value:e._parse(new tx(r,n,r.path,t)),alwaysSet:t in r.data})}}return r.common.async?Promise.resolve().then(async()=>{let e=[];for(let t of s){let r=await t.key;e.push({key:r,value:await t.value,alwaysSet:t.alwaysSet})}return e}).then(e=>tg.mergeObjectSync(t,e)):tg.mergeObjectSync(t,s)}get shape(){return this._def.shape()}strict(t){return ty.errToObj,new e({...this._def,unknownKeys:"strict",...void 0!==t?{errorMap:(e,r)=>{var n,i,a,s;let o=null!==(a=null===(i=(n=this._def).errorMap)||void 0===i?void 0:i.call(n,e,r).message)&&void 0!==a?a:r.defaultError;return"unrecognized_keys"===e.code?{message:null!==(s=ty.errToObj(t).message)&&void 0!==s?s:o}:{message:o}}}:{}})}strip(){return new e({...this._def,unknownKeys:"strip"})}passthrough(){return new e({...this._def,unknownKeys:"passthrough"})}extend(t){return new e({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new e({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:rf.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(t){return new e({...this._def,catchall:t})}pick(t){let r={};return tf.objectKeys(t).forEach(e=>{t[e]&&this.shape[e]&&(r[e]=this.shape[e])}),new e({...this._def,shape:()=>r})}omit(t){let r={};return tf.objectKeys(this.shape).forEach(e=>{t[e]||(r[e]=this.shape[e])}),new e({...this._def,shape:()=>r})}deepPartial(){return function e(t){if(!(t instanceof tY))return t instanceof tH?new tH({...t._def,type:e(t.element)}):t instanceof ra?ra.create(e(t.unwrap())):t instanceof rs?rs.create(e(t.unwrap())):t instanceof t4?t4.create(t.items.map(t=>e(t))):t;{let r={};for(let n in t.shape){let i=t.shape[n];r[n]=ra.create(e(i))}return new tY({...t._def,shape:()=>r})}}(this)}partial(t){let r={};return tf.objectKeys(this.shape).forEach(e=>{let n=this.shape[e];t&&!t[e]?r[e]=n:r[e]=n.optional()}),new e({...this._def,shape:()=>r})}required(t){let r={};return tf.objectKeys(this.shape).forEach(e=>{if(t&&!t[e])r[e]=this.shape[e];else{let t=this.shape[e];for(;t instanceof ra;)t=t._def.innerType;r[e]=t}}),new e({...this._def,shape:()=>r})}keyof(){return re(tf.objectKeys(this.shape))}};tY.create=(e,t)=>new tY({shape:()=>e,unknownKeys:"strip",catchall:tK.create(),typeName:rf.ZodObject,...tS(t)}),tY.strictCreate=(e,t)=>new tY({shape:()=>e,unknownKeys:"strict",catchall:tK.create(),typeName:rf.ZodObject,...tS(t)}),tY.lazycreate=(e,t)=>new tY({shape:e,unknownKeys:"strip",catchall:tK.create(),typeName:rf.ZodObject,...tS(t)});var tQ=class extends tD{_parse(e){let{ctx:t}=this._processInputParams(e),r=this._def.options;if(t.common.async)return Promise.all(r.map(async e=>{let r={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:r}),ctx:r}})).then(function(e){for(let t of e)if("valid"===t.result.status)return t.result;for(let r of e)if("dirty"===r.result.status)return t.common.issues.push(...r.ctx.common.issues),r.result;let r=e.map(e=>new to(e.ctx.common.issues));return th(t,{code:ts.invalid_union,unionErrors:r}),t_});{let e,n=[];for(let i of r){let r={...t,common:{...t.common,issues:[]},parent:null},a=i._parseSync({data:t.data,path:t.path,parent:r});if("valid"===a.status)return a;"dirty"!==a.status||e||(e={result:a,ctx:r}),r.common.issues.length&&n.push(r.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;let i=n.map(e=>new to(e));return th(t,{code:ts.invalid_union,unionErrors:i}),t_}}get options(){return this._def.options}};tQ.create=(e,t)=>new tQ({options:e,typeName:rf.ZodUnion,...tS(t)});var t0=e=>e instanceof t8?t0(e.schema):e instanceof ri?t0(e.innerType()):e instanceof t9?[e.value]:e instanceof rt?e.options:e instanceof rr?Object.keys(e.enum):e instanceof ro?t0(e._def.innerType):e instanceof tV?[void 0]:e instanceof tJ?[null]:null,t1=class e extends tD{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==ti.object)return th(t,{code:ts.invalid_type,expected:ti.object,received:t.parsedType}),t_;let r=this.discriminator,n=t.data[r],i=this.optionsMap.get(n);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):(th(t,{code:ts.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),t_)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,r,n){let i=new Map;for(let e of r){let r=t0(e.shape[t]);if(!r)throw Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(let n of r){if(i.has(n))throw Error(`Discriminator property ${String(t)} has duplicate value ${String(n)}`);i.set(n,e)}}return new e({typeName:rf.ZodDiscriminatedUnion,discriminator:t,options:r,optionsMap:i,...tS(n)})}},t2=class extends tD{_parse(e){let{status:t,ctx:r}=this._processInputParams(e),n=(e,n)=>{if(tw(e)||tw(n))return t_;let i=function e(t,r){let n=ta(t),i=ta(r);if(t===r)return{valid:!0,data:t};if(n===ti.object&&i===ti.object){let n=tf.objectKeys(r),i=tf.objectKeys(t).filter(e=>-1!==n.indexOf(e)),a={...t,...r};for(let n of i){let i=e(t[n],r[n]);if(!i.valid)return{valid:!1};a[n]=i.data}return{valid:!0,data:a}}if(n!==ti.array||i!==ti.array)return n===ti.date&&i===ti.date&&+t==+r?{valid:!0,data:t}:{valid:!1};{if(t.length!==r.length)return{valid:!1};let n=[];for(let i=0;i<t.length;i++){let a=e(t[i],r[i]);if(!a.valid)return{valid:!1};n.push(a.data)}return{valid:!0,data:n}}}(e.value,n.value);return i.valid?((tk(e)||tk(n))&&t.dirty(),{status:t.value,value:i.data}):(th(r,{code:ts.invalid_intersection_types}),t_)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([e,t])=>n(e,t)):n(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}};t2.create=(e,t,r)=>new t2({left:e,right:t,typeName:rf.ZodIntersection,...tS(r)});var t4=class e extends tD{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ti.array)return th(r,{code:ts.invalid_type,expected:ti.array,received:r.parsedType}),t_;if(r.data.length<this._def.items.length)return th(r,{code:ts.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t_;!this._def.rest&&r.data.length>this._def.items.length&&(th(r,{code:ts.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let n=[...r.data].map((e,t)=>{let n=this._def.items[t]||this._def.rest;return n?n._parse(new tx(r,e,r.path,t)):null}).filter(e=>!!e);return r.common.async?Promise.all(n).then(e=>tg.mergeArray(t,e)):tg.mergeArray(t,n)}get items(){return this._def.items}rest(t){return new e({...this._def,rest:t})}};t4.create=(e,t)=>{if(!Array.isArray(e))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new t4({items:e,typeName:rf.ZodTuple,rest:null,...tS(t)})};var t3=class e extends tD{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ti.object)return th(r,{code:ts.invalid_type,expected:ti.object,received:r.parsedType}),t_;let n=[],i=this._def.keyType,a=this._def.valueType;for(let e in r.data)n.push({key:i._parse(new tx(r,e,r.path,e)),value:a._parse(new tx(r,r.data[e],r.path,e))});return r.common.async?tg.mergeObjectAsync(t,n):tg.mergeObjectSync(t,n)}get element(){return this._def.valueType}static create(t,r,n){return new e(r instanceof tD?{keyType:t,valueType:r,typeName:rf.ZodRecord,...tS(n)}:{keyType:tL.create(),valueType:t,typeName:rf.ZodRecord,...tS(r)})}},t6=class extends tD{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ti.map)return th(r,{code:ts.invalid_type,expected:ti.map,received:r.parsedType}),t_;let n=this._def.keyType,i=this._def.valueType,a=[...r.data.entries()].map(([e,t],a)=>({key:n._parse(new tx(r,e,r.path,[a,"key"])),value:i._parse(new tx(r,t,r.path,[a,"value"]))}));if(r.common.async){let e=new Map;return Promise.resolve().then(async()=>{for(let r of a){let n=await r.key,i=await r.value;if("aborted"===n.status||"aborted"===i.status)return t_;("dirty"===n.status||"dirty"===i.status)&&t.dirty(),e.set(n.value,i.value)}return{status:t.value,value:e}})}{let e=new Map;for(let r of a){let n=r.key,i=r.value;if("aborted"===n.status||"aborted"===i.status)return t_;("dirty"===n.status||"dirty"===i.status)&&t.dirty(),e.set(n.value,i.value)}return{status:t.value,value:e}}}};t6.create=(e,t,r)=>new t6({valueType:t,keyType:e,typeName:rf.ZodMap,...tS(r)});var t7=class e extends tD{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ti.set)return th(r,{code:ts.invalid_type,expected:ti.set,received:r.parsedType}),t_;let n=this._def;null!==n.minSize&&r.data.size<n.minSize.value&&(th(r,{code:ts.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),t.dirty()),null!==n.maxSize&&r.data.size>n.maxSize.value&&(th(r,{code:ts.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),t.dirty());let i=this._def.valueType;function a(e){let r=new Set;for(let n of e){if("aborted"===n.status)return t_;"dirty"===n.status&&t.dirty(),r.add(n.value)}return{status:t.value,value:r}}let s=[...r.data.values()].map((e,t)=>i._parse(new tx(r,e,r.path,t)));return r.common.async?Promise.all(s).then(e=>a(e)):a(s)}min(t,r){return new e({...this._def,minSize:{value:t,message:ty.toString(r)}})}max(t,r){return new e({...this._def,maxSize:{value:t,message:ty.toString(r)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}};t7.create=(e,t)=>new t7({valueType:e,minSize:null,maxSize:null,typeName:rf.ZodSet,...tS(t)});var t5=class e extends tD{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==ti.function)return th(t,{code:ts.invalid_type,expected:ti.function,received:t.parsedType}),t_;function r(e,r){return tl({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,tc(),tu].filter(e=>!!e),issueData:{code:ts.invalid_arguments,argumentsError:r}})}function n(e,r){return tl({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,tc(),tu].filter(e=>!!e),issueData:{code:ts.invalid_return_type,returnTypeError:r}})}let i={errorMap:t.common.contextualErrorMap},a=t.data;if(this._def.returns instanceof rn){let e=this;return tb(async function(...t){let s=new to([]),o=await e._def.args.parseAsync(t,i).catch(e=>{throw s.addIssue(r(t,e)),s}),u=await Reflect.apply(a,this,o);return await e._def.returns._def.type.parseAsync(u,i).catch(e=>{throw s.addIssue(n(u,e)),s})})}{let e=this;return tb(function(...t){let s=e._def.args.safeParse(t,i);if(!s.success)throw new to([r(t,s.error)]);let o=Reflect.apply(a,this,s.data),u=e._def.returns.safeParse(o,i);if(!u.success)throw new to([n(o,u.error)]);return u.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new e({...this._def,args:t4.create(t).rest(tG.create())})}returns(t){return new e({...this._def,returns:t})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(t,r,n){return new e({args:t||t4.create([]).rest(tG.create()),returns:r||tG.create(),typeName:rf.ZodFunction,...tS(n)})}},t8=class extends tD{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}};t8.create=(e,t)=>new t8({getter:e,typeName:rf.ZodLazy,...tS(t)});var t9=class extends tD{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return th(t,{received:t.data,code:ts.invalid_literal,expected:this._def.value}),t_}return{status:"valid",value:e.data}}get value(){return this._def.value}};function re(e,t){return new rt({values:e,typeName:rf.ZodEnum,...tS(t)})}t9.create=(e,t)=>new t9({value:e,typeName:rf.ZodLiteral,...tS(t)});var rt=class e extends tD{_parse(e){if("string"!=typeof e.data){let t=this._getOrReturnCtx(e),r=this._def.values;return th(t,{expected:tf.joinValues(r),received:t.parsedType,code:ts.invalid_type}),t_}if(-1===this._def.values.indexOf(e.data)){let t=this._getOrReturnCtx(e),r=this._def.values;return th(t,{received:t.data,code:ts.invalid_enum_value,options:r}),t_}return tb(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(t){return e.create(t)}exclude(t){return e.create(this.options.filter(e=>!t.includes(e)))}};rt.create=re;var rr=class extends tD{_parse(e){let t=tf.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==ti.string&&r.parsedType!==ti.number){let e=tf.objectValues(t);return th(r,{expected:tf.joinValues(e),received:r.parsedType,code:ts.invalid_type}),t_}if(-1===t.indexOf(e.data)){let e=tf.objectValues(t);return th(r,{received:r.data,code:ts.invalid_enum_value,options:e}),t_}return tb(e.data)}get enum(){return this._def.values}};rr.create=(e,t)=>new rr({values:e,typeName:rf.ZodNativeEnum,...tS(t)});var rn=class extends tD{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);return t.parsedType!==ti.promise&&!1===t.common.async?(th(t,{code:ts.invalid_type,expected:ti.promise,received:t.parsedType}),t_):tb((t.parsedType===ti.promise?t.data:Promise.resolve(t.data)).then(e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap})))}};rn.create=(e,t)=>new rn({type:e,typeName:rf.ZodPromise,...tS(t)});var ri=class extends tD{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===rf.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:r}=this._processInputParams(e),n=this._def.effect||null,i={addIssue:e=>{th(r,e),e.fatal?t.abort():t.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),"preprocess"===n.type){let e=n.transform(r.data,i);return r.common.issues.length?{status:"dirty",value:r.data}:r.common.async?Promise.resolve(e).then(e=>this._def.schema._parseAsync({data:e,path:r.path,parent:r})):this._def.schema._parseSync({data:e,path:r.path,parent:r})}if("refinement"===n.type){let e=e=>{let t=n.refinement(e,i);if(r.common.async)return Promise.resolve(t);if(t instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(r=>"aborted"===r.status?t_:("dirty"===r.status&&t.dirty(),e(r.value).then(()=>({status:t.value,value:r.value}))));{let n=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===n.status?t_:("dirty"===n.status&&t.dirty(),e(n.value),{status:t.value,value:n.value})}}if("transform"===n.type){if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(e=>tE(e)?Promise.resolve(n.transform(e.value,i)).then(e=>({status:t.value,value:e})):e);{let e=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!tE(e))return e;let a=n.transform(e.value,i);if(a instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:a}}}tf.assertNever(n)}};ri.create=(e,t,r)=>new ri({schema:e,typeName:rf.ZodEffects,effect:t,...tS(r)}),ri.createWithPreprocess=(e,t,r)=>new ri({schema:t,effect:{type:"preprocess",transform:e},typeName:rf.ZodEffects,...tS(r)});var ra=class extends tD{_parse(e){return this._getType(e)===ti.undefined?tb(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};ra.create=(e,t)=>new ra({innerType:e,typeName:rf.ZodOptional,...tS(t)});var rs=class extends tD{_parse(e){return this._getType(e)===ti.null?tb(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};rs.create=(e,t)=>new rs({innerType:e,typeName:rf.ZodNullable,...tS(t)});var ro=class extends tD{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return t.parsedType===ti.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}};ro.create=(e,t)=>new ro({innerType:e,typeName:rf.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...tS(t)});var ru=class extends tD{_parse(e){let{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},n=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return tI(n)?n.then(e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new to(r.common.issues)},input:r.data})})):{status:"valid",value:"valid"===n.status?n.value:this._def.catchValue({get error(){return new to(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}};ru.create=(e,t)=>new ru({innerType:e,typeName:rf.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...tS(t)});var rd=class extends tD{_parse(e){if(this._getType(e)!==ti.nan){let t=this._getOrReturnCtx(e);return th(t,{code:ts.invalid_type,expected:ti.nan,received:t.parsedType}),t_}return{status:"valid",value:e.data}}};rd.create=e=>new rd({typeName:rf.ZodNaN,...tS(e)});var rc=Symbol("zod_brand"),rl=class extends tD{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}},rh=class e extends tD{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{let e=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?t_:"dirty"===e.status?(t.dirty(),tv(e.value)):this._def.out._parseAsync({data:e.value,path:r.path,parent:r})})();{let e=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?t_:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:r.path,parent:r})}}static create(t,r){return new e({in:t,out:r,typeName:rf.ZodPipeline})}},rp=class extends tD{_parse(e){let t=this._def.innerType._parse(e);return tE(t)&&(t.value=Object.freeze(t.value)),t}};rp.create=(e,t)=>new rp({innerType:e,typeName:rf.ZodReadonly,...tS(t)});var rf,rm=(e,t={},r)=>e?tW.create().superRefine((n,i)=>{var a,s;if(!e(n)){let e="function"==typeof t?t(n):"string"==typeof t?{message:t}:t,o=null===(s=null!==(a=e.fatal)&&void 0!==a?a:r)||void 0===s||s,u="string"==typeof e?{message:e}:e;i.addIssue({code:"custom",...u,fatal:o})}}):tW.create(),ry={object:tY.lazycreate};(t=rf||(rf={})).ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly";var rg=tL.create,r_=tM.create,rv=rd.create,rb=tq.create,rw=tU.create,rk=tz.create,rE=t$.create,rI=tV.create,rx=tJ.create,rO=tW.create,rS=tG.create,rT=tK.create,rC=tX.create,rD=tH.create,rA=tY.create,rF=tY.strictCreate,rP=tQ.create,rN=t1.create,rj=t2.create,rZ=t4.create,rR=t3.create,rB=t6.create,rL=t7.create,rM=t5.create,rq=t8.create,rU=t9.create,rz=rt.create,r$=rr.create,rV=rn.create,rJ=ri.create,rW=ra.create,rG=rs.create,rK=ri.createWithPreprocess,rX=rh.create,rH=Object.freeze({__proto__:null,defaultErrorMap:tu,setErrorMap:function(e){td=e},getErrorMap:tc,makeIssue:tl,EMPTY_PATH:[],addIssueToContext:th,ParseStatus:tg,INVALID:t_,DIRTY:tv,OK:tb,isAborted:tw,isDirty:tk,isValid:tE,isAsync:tI,get util(){return tf},get objectUtil(){return tm},ZodParsedType:ti,getParsedType:ta,ZodType:tD,ZodString:tL,ZodNumber:tM,ZodBigInt:tq,ZodBoolean:tU,ZodDate:tz,ZodSymbol:t$,ZodUndefined:tV,ZodNull:tJ,ZodAny:tW,ZodUnknown:tG,ZodNever:tK,ZodVoid:tX,ZodArray:tH,ZodObject:tY,ZodUnion:tQ,ZodDiscriminatedUnion:t1,ZodIntersection:t2,ZodTuple:t4,ZodRecord:t3,ZodMap:t6,ZodSet:t7,ZodFunction:t5,ZodLazy:t8,ZodLiteral:t9,ZodEnum:rt,ZodNativeEnum:rr,ZodPromise:rn,ZodEffects:ri,ZodTransformer:ri,ZodOptional:ra,ZodNullable:rs,ZodDefault:ro,ZodCatch:ru,ZodNaN:rd,BRAND:rc,ZodBranded:rl,ZodPipeline:rh,ZodReadonly:rp,custom:rm,Schema:tD,ZodSchema:tD,late:ry,get ZodFirstPartyTypeKind(){return rf},coerce:{string:e=>tL.create({...e,coerce:!0}),number:e=>tM.create({...e,coerce:!0}),boolean:e=>tU.create({...e,coerce:!0}),bigint:e=>tq.create({...e,coerce:!0}),date:e=>tz.create({...e,coerce:!0})},any:rO,array:rD,bigint:rb,boolean:rw,date:rk,discriminatedUnion:rN,effect:rJ,enum:rz,function:rM,instanceof:(e,t={message:`Input not instance of ${e.name}`})=>rm(t=>t instanceof e,t),intersection:rj,lazy:rq,literal:rU,map:rB,nan:rv,nativeEnum:r$,never:rT,null:rx,nullable:rG,number:r_,object:rA,oboolean:()=>rw().optional(),onumber:()=>r_().optional(),optional:rW,ostring:()=>rg().optional(),pipeline:rX,preprocess:rK,promise:rV,record:rR,set:rL,strictObject:rF,string:rg,symbol:rE,transformer:rJ,tuple:rZ,undefined:rI,union:rP,unknown:rS,void:rC,NEVER:t_,ZodIssueCode:ts,quotelessJson:e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),ZodError:to}),rY=C(ey());D();var rQ={};S(rQ,{Availability:()=>aS,ContentEditor:()=>aZ,ContentEditorTypes:()=>aR,ImageFormat:()=>ap,IsLinearized:()=>aO,LinearizedInstance:()=>aF,LinearizedInstanceEvents:()=>aC,LinearizedInstanceState:()=>aA,Priority:()=>ah,Renderer:()=>ng,Text:()=>ao,addWASMCtx:()=>nl,attachLinearizedInstance:()=>nu,createContentEditor:()=>aj,createServerContext:()=>nc,createWASMContext:()=>no,ping:()=>ny,removeLinearizedInstance:()=>nd,satifiesServerVersion:()=>nm,withEngine:()=>nf,withServerEngine:()=>np,withWASMEngine:()=>nh}),D(),D(),Y(),D(),Y(),D(),D(),D(),D();import r0 from"crypto";var r1=new Uint8Array(256),r2=r1.length;D();var r4=[];for(let e=0;e<256;++e)r4.push((e+256).toString(16).slice(1));D(),D();import r3 from"crypto";var r6={randomUUID:r3.randomUUID},r7=function(e,t,r){if(r6.randomUUID&&!t&&!e)return r6.randomUUID();let n=(e=e||{}).random||(e.rng||function(){return r2>r1.length-16&&(r0.randomFillSync(r1),r2=0),r1.slice(r2,r2+=16)})();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return function(e,t=0){return r4[e[t+0]]+r4[e[t+1]]+r4[e[t+2]]+r4[e[t+3]]+"-"+r4[e[t+4]]+r4[e[t+5]]+"-"+r4[e[t+6]]+r4[e[t+7]]+"-"+r4[e[t+8]]+r4[e[t+9]]+"-"+r4[e[t+10]]+r4[e[t+11]]+r4[e[t+12]]+r4[e[t+13]]+r4[e[t+14]]+r4[e[t+15]]}(n)};D(),D(),Y();var r5=class extends I{constructor(e){super(e)}},r8=class extends r5{constructor(e,t){super(e),this.code=t}};function r9(e){return e instanceof Uint8Array}var ne=class{constructor(e,t){this.jsonCommand=t,this.identifier=r7(),this.coreClient=e}async request(){let e=await this.coreClient.dispatchCommand(JSON.stringify(this.jsonCommand));if(e.success)return e;throw new r8(e.message,e.code)}},nt=class{constructor(e,t){this.requestQueue=e,this.coreClient=t}executeCommand(e,t,r){return ad(this.requestQueue.enqueue(new ne(this.coreClient,{type:e,...r}),t))}cancelRequests(e){this.requestQueue.cancelRequests(t=>e(t))}};D(),D(),D();var nr=C(eg());function nn(){return!0}Y();var ni=class{constructor(e){this.queue=(0,nr.OrderedMap)(),this.priorityQueue=(0,nr.OrderedMap)(),this.inFlightRequests=(0,nr.Map)(),this.inflightRequestLimit=e,this.isDestroyed=!1}enqueue(e,t=!1){if(this.isDestroyed)return{promise:new Promise(()=>{}),cancel:()=>{}};let r=null,n=null,i=new Promise((e,t)=>{r=e,n=t}),a=t?this.priorityQueue:this.queue,s=(0,nr.set)(a,e,{promise:i,resolve:r,reject:n});return t?this.priorityQueue=s:this.queue=s,t?this.next():setTimeout(()=>this.next(),35),{promise:i,cancel:()=>this._cancel(e)}}_cancel(e){this.queue.has(e)&&(this.queue=this.queue.delete(e)),this.priorityQueue.has(e)&&(this.priorityQueue=this.priorityQueue.delete(e)),this.inFlightRequests.has(e)&&(this.inFlightRequests=this.inFlightRequests.delete(e))}cancelAll(){this.queue=(0,nr.OrderedMap)(),this.priorityQueue=(0,nr.OrderedMap)(),this.inFlightRequests=(0,nr.Map)()}cancel(e){let t=(t,r)=>e(r);this.queue=this.queue.filter(t),this.priorityQueue=this.priorityQueue.filter(t),this.inFlightRequests=this.inFlightRequests.filter(t)}_requestFinished(e,t){if(this.isDestroyed)return;let r=this.inFlightRequests.get(e);r&&(r.resolve(t),this.inFlightRequests=this.inFlightRequests.delete(e)),this.next()}_requestFailed(e,t){if(this.isDestroyed)return;let r=this.inFlightRequests.get(e);r&&(r.reject(t),this.inFlightRequests=this.inFlightRequests.delete(e)),this.next()}next(){if(!this.isDestroyed&&!(this.inFlightRequests.size>=this.inflightRequestLimit)){if(this.priorityQueue.size>=1){let e=this.priorityQueue.findLastEntry(nn);F(e);let[t,r]=e;this.priorityQueue=this.priorityQueue.delete(t),this.inFlightRequests=this.inFlightRequests.set(t,r),t.request().then(e=>this._requestFinished(t,e)).catch(e=>this._requestFailed(t,e));return}if(this.queue.size>=1){let e=this.queue.findEntry(nn);F(e);let[t,r]=e;this.queue=this.queue.delete(t),this.inFlightRequests=this.inFlightRequests.set(t,r),t.request().then(e=>this._requestFinished(t,e)).catch(e=>this._requestFailed(t,e));return}}}destroy(){this.isDestroyed=!0}};D();var na=class{constructor(e){this.requestQueue=new ni(e)}enqueue(e,t){let{promise:r,cancel:n}=this.requestQueue.enqueue(e,1===t);return{promise:r,cancel:()=>{"cancel"in e&&e.cancel(),n()}}}cancelRequests(e){this.requestQueue.cancel(e)}},ns=e=>new na(e),no=e=>{let t=ns(2);return{wasmCtx:{engine:new nt(t,e)},requestQueue:t}},nu=(e,t)=>{F(e.wasmCtx,void 0),e.wasmCtx.linearizedInstance=new WeakRef(t)},nd=e=>{F(e.wasmCtx,void 0),e.wasmCtx.linearizedInstance?.deref()?.destroy(),e.wasmCtx.linearizedInstance=void 0},nc=(e,t,r)=>({serverCtx:{info:e,satisfiesVersion:r},requestQueue:ns(10),getWasmDispatch:t}),nl=(e,t)=>{F(!e.wasmCtx,void 0),e.wasmCtx={engine:new nt(e.requestQueue,t)}},nh=(e,t)=>(F(e.wasmCtx,void 0),t(e.wasmCtx)),np=(e,t)=>(F(e.serverCtx,void 0),t(e.serverCtx)),nf=(e,t,r,n)=>{if(e.wasmCtx){if(n){let t=e.wasmCtx.linearizedInstance?.deref();if(t&&t.isRunning())return n(e.wasmCtx,t)}return nh(e,t)}if(e.serverCtx)return np(e,r);throw new I("No engine found")},nm=(e,t)=>!!e.serverCtx&&e.serverCtx.satisfiesVersion(t);D();var ny=async e=>nf(e,async e=>{await e.engine.executeCommand("ping",0,{})},async e=>{throw new r5("not implemented")}),ng={};S(ng,{LinearizedRenderingRequest:()=>ai,renderTile:()=>as}),D(),D(),D();var n_=((e=globalThis.navigator?.userAgent??"",t=globalThis.navigator?.platform??"",r=globalThis.navigator?.maxTouchPoints??0)=>t.indexOf("MacIntel")>-1&&r>1?1:e.indexOf("Win")>-1?0:e.indexOf("iPhone")>-1||e.indexOf("iPad")>-1||"iPad"===t?1:e.indexOf("Mac")>-1?2:e.indexOf("Android")>-1?3:e.indexOf("Linux")>-1?4:null)();D();var nv=function(e=globalThis.navigator?.userAgent??""){return e.indexOf("Trident/")>-1?0:e.indexOf("Edge/")>-1?1:e.indexOf("Chrome/")>-1?2:e.indexOf("AppleWebKit/")>-1?3:e.indexOf("Gecko/")>-1?4:null}(),nb={};S(nb,{MAX_IOS_CANVAS_SIZE:()=>nk,MAX_WEBP_DIMENSION:()=>nw,getImageFormatForImageDimensions:()=>nE,getImageFormatFromMimeType:()=>nI}),D();var nw=16383,nk=16777216;function nE(e,{width:t,height:r}){return"webp"===e&&(t>nw||r>nw)?"png":"bitmap"===e&&1===n_&&t*r>nk?"png":e}var nI=e=>{if(e){if(e.includes("image/webp"))return"webp";if(e.includes("image/png"))return"png";if(e.includes("image/jpeg"))return"jpeg"}throw new r5("Couldn't determine image format")};D();var nx=class{constructor(){this.listeners=new Map}on(e,t){let r=this.listeners.get(e);r?r.push(t):this.listeners.set(e,[t])}off(e,t){let r=this.listeners.get(e);if(!r)return;let n=r.indexOf(t);-1!==n&&r.splice(n,1),this.listeners.set(e,r)}once(e,t){let r=(...n)=>{t(...n),this.off(e,r)};this.on(e,r)}emit(e,...t){let r=this.listeners.get(e);r&&r.slice().forEach(e=>{e(...t)})}};D();var nO=class{constructor(e,t){this.abortController=new AbortController,this.url=e,this.requestInit=t,this.identifier=r7()}async request(){return fetch(this.url,{...this.requestInit,signal:this.abortController.signal})}cancel(){this.abortController.abort()}},nS=(e,t,r,n,i,a)=>{let s={...a?.headers,...t.info.headers};switch(i){case 0:s={...s,"X-PSPDFKit-Token":t.info.token};break;case 2:s={...s,"X-PSPDFKit-Image-Token":t.info.imageToken}}let o="";if(1==i){let e=new URLSearchParams;e.append("token",t.info.token),o="?"+e.toString()}return ad(e.enqueue(new nO(`${t.info.url}i/d/${t.info.documentId}/h/${t.info.layerHandle}/${r}${o}`,{...a,headers:s}),n))};function nT(e,t){if(!e)throw Error(t)}function nC(e){if("number"!=typeof e)throw Error("invalid int 32: "+typeof e);if(!Number.isInteger(e)||e>2147483647||e<-2147483648)throw Error("invalid int 32: "+e)}function nD(e){if("number"!=typeof e)throw Error("invalid uint 32: "+typeof e);if(!Number.isInteger(e)||e>4294967295||e<0)throw Error("invalid uint 32: "+e)}function nA(e){if("number"!=typeof e)throw Error("invalid float 32: "+typeof e);if(Number.isFinite(e)&&(e>34028234663852886e22||e<-34028234663852886e22))throw Error("invalid float 32: "+e)}D(),D(),D(),D(),D(),D();var nF=Symbol("@bufbuild/protobuf/enum-type");function nP(e,t,r,n){e[nF]=nN(t,r.map(t=>({no:t.no,name:t.name,localName:e[t.no]})),n)}function nN(e,t,r){let n=Object.create(null),i=Object.create(null),a=[];for(let e of t){let t=nj(e);a.push(t),n[e.name]=t,i[e.no]=t}return{typeName:e,values:a,findName:e=>n[e],findNumber:e=>i[e]}}function nj(e){return"localName"in e?e:Object.assign(Object.assign({},e),{localName:e.name})}D(),D();var nZ=class{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,t){let r=this.getType().runtime.bin,n=r.makeReadOptions(t);return r.readMessage(this,n.readerFactory(e),e.byteLength,n),this}fromJson(e,t){let r=this.getType(),n=r.runtime.json,i=n.makeReadOptions(t);return n.readMessage(r,e,i,this),this}fromJsonString(e,t){let r;try{r=JSON.parse(e)}catch(e){throw Error(`cannot decode ${this.getType().typeName} from JSON: ${e instanceof Error?e.message:String(e)}`)}return this.fromJson(r,t)}toBinary(e){let t=this.getType().runtime.bin,r=t.makeWriteOptions(e),n=r.writerFactory();return t.writeMessage(this,n,r),n.finish()}toJson(e){let t=this.getType().runtime.json,r=t.makeWriteOptions(e);return t.writeMessage(this,r)}toJsonString(e){var t;return JSON.stringify(this.toJson(e),null,null!==(t=e?.prettySpaces)&&void 0!==t?t:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}};function nR(){let e=0,t=0;for(let r=0;r<28;r+=7){let n=this.buf[this.pos++];if(e|=(127&n)<<r,!(128&n))return this.assertBounds(),[e,t]}let r=this.buf[this.pos++];if(e|=(15&r)<<28,t=(112&r)>>4,!(128&r))return this.assertBounds(),[e,t];for(let r=3;r<=31;r+=7){let n=this.buf[this.pos++];if(t|=(127&n)<<r,!(128&n))return this.assertBounds(),[e,t]}throw Error("invalid varint")}function nB(e,t,r){for(let n=0;n<28;n+=7){let i=e>>>n,a=!(!(i>>>7)&&0==t),s=(a?128|i:i)&255;if(r.push(s),!a)return}let n=e>>>28&15|(7&t)<<4,i=!!(t>>3);if(r.push((i?128|n:n)&255),i){for(let e=3;e<31;e+=7){let n=t>>>e,i=!!(n>>>7),a=(i?128|n:n)&255;if(r.push(a),!i)return}r.push(t>>>31&1)}}function nL(e){let t="-"===e[0];t&&(e=e.slice(1));let r=0,n=0;function i(t,i){let a=Number(e.slice(t,i));n*=1e6,(r=1e6*r+a)>=4294967296&&(n+=r/4294967296|0,r%=4294967296)}return i(-24,-18),i(-18,-12),i(-12,-6),i(-6),t?nU(r,n):nq(r,n)}function nM(e,t){if({lo:e,hi:t}={lo:e>>>0,hi:t>>>0},t<=2097151)return String(4294967296*t+e);let r=16777215&e,n=(e>>>24|t<<8)&16777215,i=t>>16&65535,a=r+6777216*n+6710656*i,s=n+8147497*i,o=2*i;return a>=1e7&&(s+=Math.floor(a/1e7),a%=1e7),s>=1e7&&(o+=Math.floor(s/1e7),s%=1e7),o.toString()+nz(s)+nz(a)}function nq(e,t){return{lo:0|e,hi:0|t}}function nU(e,t){return t=~t,e?e=~e+1:t+=1,nq(e,t)}D(),D(),D(),D();var nz=e=>{let t=String(e);return"0000000".slice(t.length)+t};function n$(e,t){if(e>=0){for(;e>127;)t.push(127&e|128),e>>>=7;t.push(e)}else{for(let r=0;r<9;r++)t.push(127&e|128),e>>=7;t.push(1)}}function nV(){let e=this.buf[this.pos++],t=127&e;if(!(128&e)||(t|=(127&(e=this.buf[this.pos++]))<<7,!(128&e))||(t|=(127&(e=this.buf[this.pos++]))<<14,!(128&e))||(t|=(127&(e=this.buf[this.pos++]))<<21,!(128&e)))return this.assertBounds(),t;t|=(15&(e=this.buf[this.pos++]))<<28;for(let t=5;128&e&&t<10;t++)e=this.buf[this.pos++];if(128&e)throw Error("invalid varint");return this.assertBounds(),t>>>0}var nJ=function(){let e=new DataView(new ArrayBuffer(8));if("function"==typeof BigInt&&"function"==typeof e.getBigInt64&&"function"==typeof e.getBigUint64&&"function"==typeof e.setBigInt64&&"function"==typeof e.setBigUint64&&("object"!=typeof process||"object"!=typeof process.env||"1"!==process.env.BUF_BIGINT_DISABLE)){let t=BigInt("-9223372036854775808"),r=BigInt("9223372036854775807"),n=BigInt("0"),i=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(e){let n="bigint"==typeof e?e:BigInt(e);if(n>r||n<t)throw Error(`int64 invalid: ${e}`);return n},uParse(e){let t="bigint"==typeof e?e:BigInt(e);if(t>i||t<n)throw Error(`uint64 invalid: ${e}`);return t},enc(t){return e.setBigInt64(0,this.parse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},uEnc(t){return e.setBigInt64(0,this.uParse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},dec:(t,r)=>(e.setInt32(0,t,!0),e.setInt32(4,r,!0),e.getBigInt64(0,!0)),uDec:(t,r)=>(e.setInt32(0,t,!0),e.setInt32(4,r,!0),e.getBigUint64(0,!0))}}let t=e=>nT(/^-?[0-9]+$/.test(e),`int64 invalid: ${e}`),r=e=>nT(/^[0-9]+$/.test(e),`uint64 invalid: ${e}`);return{zero:"0",supported:!1,parse:e=>("string"!=typeof e&&(e=e.toString()),t(e),e),uParse:e=>("string"!=typeof e&&(e=e.toString()),r(e),e),enc:e=>("string"!=typeof e&&(e=e.toString()),t(e),nL(e)),uEnc:e=>("string"!=typeof e&&(e=e.toString()),r(e),nL(e)),dec:(e,t)=>{let r,n,i;return(n=2147483648&(r=nq(e,t)).hi)&&(r=nU(r.lo,r.hi)),i=nM(r.lo,r.hi),n?"-"+i:i},uDec:(e,t)=>nM(e,t)}}();function nW(e,t,r){if(t===r)return!0;if(e==l.BYTES){if(!(t instanceof Uint8Array)||!(r instanceof Uint8Array)||t.length!==r.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==r[e])return!1;return!0}switch(e){case l.UINT64:case l.FIXED64:case l.INT64:case l.SFIXED64:case l.SINT64:return t==r}return!1}function nG(e,t){switch(e){case l.BOOL:return!1;case l.UINT64:case l.FIXED64:case l.INT64:case l.SFIXED64:case l.SINT64:return 0==t?nJ.zero:"0";case l.DOUBLE:case l.FLOAT:return 0;case l.BYTES:return new Uint8Array(0);case l.STRING:return"";default:return 0}}function nK(e,t){switch(e){case l.BOOL:return!1===t;case l.STRING:return""===t;case l.BYTES:return t instanceof Uint8Array&&!t.byteLength;default:return 0==t}}D(),(r=l||(l={}))[r.DOUBLE=1]="DOUBLE",r[r.FLOAT=2]="FLOAT",r[r.INT64=3]="INT64",r[r.UINT64=4]="UINT64",r[r.INT32=5]="INT32",r[r.FIXED64=6]="FIXED64",r[r.FIXED32=7]="FIXED32",r[r.BOOL=8]="BOOL",r[r.STRING=9]="STRING",r[r.BYTES=12]="BYTES",r[r.UINT32=13]="UINT32",r[r.SFIXED32=15]="SFIXED32",r[r.SFIXED64=16]="SFIXED64",r[r.SINT32=17]="SINT32",r[r.SINT64=18]="SINT64",(n=h||(h={}))[n.BIGINT=0]="BIGINT",n[n.STRING=1]="STRING",D(),(i=p||(p={}))[i.Varint=0]="Varint",i[i.Bit64=1]="Bit64",i[i.LengthDelimited=2]="LengthDelimited",i[i.StartGroup=3]="StartGroup",i[i.EndGroup=4]="EndGroup",i[i.Bit32=5]="Bit32";var nX=class{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let t=0;t<this.chunks.length;t++)e+=this.chunks[t].length;let t=new Uint8Array(e),r=0;for(let e=0;e<this.chunks.length;e++)t.set(this.chunks[e],r),r+=this.chunks[e].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(nD(e);e>127;)this.buf.push(127&e|128),e>>>=7;return this.buf.push(e),this}int32(e){return nC(e),n$(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){nA(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){nD(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){nC(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return nC(e),n$(e=(e<<1^e>>31)>>>0,this.buf),this}sfixed64(e){let t=new Uint8Array(8),r=new DataView(t.buffer),n=nJ.enc(e);return r.setInt32(0,n.lo,!0),r.setInt32(4,n.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),r=new DataView(t.buffer),n=nJ.uEnc(e);return r.setInt32(0,n.lo,!0),r.setInt32(4,n.hi,!0),this.raw(t)}int64(e){let t=nJ.enc(e);return nB(t.lo,t.hi,this.buf),this}sint64(e){let t=nJ.enc(e),r=t.hi>>31;return nB(t.lo<<1^r,(t.hi<<1|t.lo>>>31)^r,this.buf),this}uint64(e){let t=nJ.uEnc(e);return nB(t.lo,t.hi,this.buf),this}},nH=class{constructor(e,t){this.varint64=nR,this.uint32=nV,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=t??new TextDecoder}tag(){let e=this.uint32(),t=e>>>3,r=7&e;if(t<=0||r<0||r>5)throw Error("illegal tag: field no "+t+" wire type "+r);return[t,r]}skip(e,t){let r=this.pos;switch(e){case p.Varint:for(;128&this.buf[this.pos++];);break;case p.Bit64:this.pos+=4;case p.Bit32:this.pos+=4;break;case p.LengthDelimited:let n=this.uint32();this.pos+=n;break;case p.StartGroup:for(;;){let[e,r]=this.tag();if(r===p.EndGroup){if(void 0!==t&&e!==t)throw Error("invalid end group tag");break}this.skip(r,e)}break;default:throw Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(r,this.pos)}assertBounds(){if(this.pos>this.len)throw RangeError("premature EOF")}int32(){return 0|this.uint32()}sint32(){let e=this.uint32();return e>>>1^-(1&e)}int64(){return nJ.dec(...this.varint64())}uint64(){return nJ.uDec(...this.varint64())}sint64(){let[e,t]=this.varint64(),r=-(1&e);return e=(e>>>1|(1&t)<<31)^r,t=t>>>1^r,nJ.dec(e,t)}bool(){let[e,t]=this.varint64();return 0!==e||0!==t}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return nJ.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return nJ.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}};function nY(e){let t=e.field.localName,r=Object.create(null);return r[t]=function(e){let t=e.field;if(t.repeated)return[];if(void 0!==t.default)return t.default;switch(t.kind){case"enum":return t.T.values[0].no;case"scalar":return nG(t.T,t.L);case"message":let r=t.T,n=new r;return r.fieldWrapper?r.fieldWrapper.unwrapField(n):n;case"map":throw"map fields are not allowed to be extensions"}}(e),[r,()=>r[t]]}D(),D();var nQ="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),n0=[];for(let e=0;e<nQ.length;e++)n0[nQ[e].charCodeAt(0)]=e;n0[45]=nQ.indexOf("+"),n0[95]=nQ.indexOf("/");var n1={dec(e){let t=3*e.length/4;"="==e[e.length-2]?t-=2:"="==e[e.length-1]&&(t-=1);let r=new Uint8Array(t),n=0,i=0,a,s=0;for(let t=0;t<e.length;t++){if(void 0===(a=n0[e.charCodeAt(t)]))switch(e[t]){case"=":i=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(i){case 0:s=a,i=1;break;case 1:r[n++]=s<<2|(48&a)>>4,s=a,i=2;break;case 2:r[n++]=(15&s)<<4|(60&a)>>2,s=a,i=3;break;case 3:r[n++]=(3&s)<<6|a,i=0}}if(1==i)throw Error("invalid base64 string.");return r.subarray(0,n)},enc(e){let t="",r=0,n,i=0;for(let a=0;a<e.length;a++)switch(n=e[a],r){case 0:t+=nQ[n>>2],i=(3&n)<<4,r=1;break;case 1:t+=nQ[i|n>>4],i=(15&n)<<2,r=2;break;case 2:t+=nQ[i|n>>6]+nQ[63&n],r=0}return r&&(t+=nQ[i]+"=",1==r&&(t+="=")),t}};function n2(e,t){let r=e.getType();return t.extendee.typeName===r.typeName&&!!r.runtime.bin.listUnknownFields(e).find(e=>e.no==t.field.no)}function n4(e,t){nT(e.extendee.typeName==t.getType().typeName,`extension ${e.typeName} can only be applied to message ${e.extendee.typeName}`)}function n3(e,t){let r=e.localName;if(e.repeated)return t[r].length>0;if(e.oneof)return t[e.oneof.localName].case===r;switch(e.kind){case"enum":case"scalar":return e.opt||e.req?void 0!==t[r]:"enum"==e.kind?t[r]!==e.T.values[0].no:!nK(e.T,t[r]);case"message":return void 0!==t[r];case"map":return Object.keys(t[r]).length>0}}function n6(e,t){let r=e.localName,n=!e.opt&&!e.req;if(e.repeated)t[r]=[];else if(e.oneof)t[e.oneof.localName]={case:void 0};else switch(e.kind){case"map":t[r]={};break;case"enum":t[r]=n?e.T.values[0].no:void 0;break;case"scalar":t[r]=n?nG(e.T,e.L):void 0;break;case"message":t[r]=void 0}}function n7(e,t){if(null===e||"object"!=typeof e||!Object.getOwnPropertyNames(nZ.prototype).every(t=>t in e&&"function"==typeof e[t]))return!1;let r=e.getType();return null!==r&&"function"==typeof r&&"typeName"in r&&"string"==typeof r.typeName&&(void 0===t||r.typeName==t.typeName)}function n5(e,t){return n7(t)||!e.fieldWrapper?t:e.fieldWrapper.wrapField(t)}D(),D(),D(),D(),l.DOUBLE,l.FLOAT,l.INT64,l.UINT64,l.INT32,l.UINT32,l.BOOL,l.STRING,l.BYTES;var n8={ignoreUnknownFields:!1},n9={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0},ie=Symbol(),it=Symbol();function ir(e){if(null===e)return"null";switch(typeof e){case"object":return Array.isArray(e)?"array":"object";case"string":return e.length>100?"string":`"${e.split('"').join('\\"')}"`;default:return String(e)}}function ii(e,t,r,n,i){let a=r.localName;if(r.repeated){if(nT("map"!=r.kind),null===t)return;if(!Array.isArray(t))throw Error(`cannot decode field ${i.typeName}.${r.name} from JSON: ${ir(t)}`);let s=e[a];for(let e of t){if(null===e)throw Error(`cannot decode field ${i.typeName}.${r.name} from JSON: ${ir(e)}`);switch(r.kind){case"message":s.push(r.T.fromJson(e,n));break;case"enum":let t=is(r.T,e,n.ignoreUnknownFields,!0);t!==it&&s.push(t);break;case"scalar":try{s.push(ia(r.T,e,r.L,!0))}catch(n){let t=`cannot decode field ${i.typeName}.${r.name} from JSON: ${ir(e)}`;throw n instanceof Error&&n.message.length>0&&(t+=`: ${n.message}`),Error(t)}}}}else if("map"==r.kind){if(null===t)return;if("object"!=typeof t||Array.isArray(t))throw Error(`cannot decode field ${i.typeName}.${r.name} from JSON: ${ir(t)}`);let s=e[a];for(let[e,a]of Object.entries(t)){let o;if(null===a)throw Error(`cannot decode field ${i.typeName}.${r.name} from JSON: map value null`);try{o=function(e,t){if(e===l.BOOL)switch(t){case"true":t=!0;break;case"false":t=!1}return ia(e,t,h.BIGINT,!0).toString()}(r.K,e)}catch(n){let e=`cannot decode map key for field ${i.typeName}.${r.name} from JSON: ${ir(t)}`;throw n instanceof Error&&n.message.length>0&&(e+=`: ${n.message}`),Error(e)}switch(r.V.kind){case"message":s[o]=r.V.T.fromJson(a,n);break;case"enum":let u=is(r.V.T,a,n.ignoreUnknownFields,!0);u!==it&&(s[o]=u);break;case"scalar":try{s[o]=ia(r.V.T,a,h.BIGINT,!0)}catch(n){let e=`cannot decode map value for field ${i.typeName}.${r.name} from JSON: ${ir(t)}`;throw n instanceof Error&&n.message.length>0&&(e+=`: ${n.message}`),Error(e)}}}}else switch(r.oneof&&(e=e[r.oneof.localName]={case:a},a="value"),r.kind){case"message":let s=r.T;if(null===t&&"google.protobuf.Value"!=s.typeName)return;let o=e[a];n7(o)?o.fromJson(t,n):(e[a]=o=s.fromJson(t,n),s.fieldWrapper&&!r.oneof&&(e[a]=s.fieldWrapper.unwrapField(o)));break;case"enum":let u=is(r.T,t,n.ignoreUnknownFields,!1);switch(u){case ie:n6(r,e);break;case it:break;default:e[a]=u}break;case"scalar":try{let n=ia(r.T,t,r.L,!1);n===ie?n6(r,e):e[a]=n}catch(n){let e=`cannot decode field ${i.typeName}.${r.name} from JSON: ${ir(t)}`;throw n instanceof Error&&n.message.length>0&&(e+=`: ${n.message}`),Error(e)}}}function ia(e,t,r,n){if(null===t)return n?nG(e,r):ie;switch(e){case l.DOUBLE:case l.FLOAT:if("NaN"===t)return Number.NaN;if("Infinity"===t)return Number.POSITIVE_INFINITY;if("-Infinity"===t)return Number.NEGATIVE_INFINITY;if(""===t||"string"==typeof t&&t.trim().length!==t.length||"string"!=typeof t&&"number"!=typeof t)break;let i=Number(t);if(Number.isNaN(i)||!Number.isFinite(i))break;return e==l.FLOAT&&nA(i),i;case l.INT32:case l.FIXED32:case l.SFIXED32:case l.SINT32:case l.UINT32:let a;if("number"==typeof t?a=t:"string"==typeof t&&t.length>0&&t.trim().length===t.length&&(a=Number(t)),void 0===a)break;return e==l.UINT32||e==l.FIXED32?nD(a):nC(a),a;case l.INT64:case l.SFIXED64:case l.SINT64:if("number"!=typeof t&&"string"!=typeof t)break;let s=nJ.parse(t);return r?s.toString():s;case l.FIXED64:case l.UINT64:if("number"!=typeof t&&"string"!=typeof t)break;let o=nJ.uParse(t);return r?o.toString():o;case l.BOOL:if("boolean"!=typeof t)break;return t;case l.STRING:if("string"!=typeof t)break;try{encodeURIComponent(t)}catch{throw Error("invalid UTF8")}return t;case l.BYTES:if(""===t)return new Uint8Array(0);if("string"!=typeof t)break;return n1.dec(t)}throw Error()}function is(e,t,r,n){if(null===t)return"google.protobuf.NullValue"==e.typeName?0:n?e.values[0].no:ie;switch(typeof t){case"number":if(Number.isInteger(t))return t;break;case"string":let i=e.findName(t);if(void 0!==i)return i.no;if(r)return it}throw Error(`cannot decode enum ${e.typeName} from JSON: ${ir(t)}`)}function io(e,t,r){if("map"==e.kind){nT("object"==typeof t&&null!=t);let n={},i=Object.entries(t);switch(e.V.kind){case"scalar":for(let[t,r]of i)n[t.toString()]=id(e.V.T,r);break;case"message":for(let[e,t]of i)n[e.toString()]=t.toJson(r);break;case"enum":let a=e.V.T;for(let[e,t]of i)n[e.toString()]=iu(a,t,r.enumAsInteger)}return r.emitDefaultValues||i.length>0?n:void 0}if(e.repeated){nT(Array.isArray(t));let n=[];switch(e.kind){case"scalar":for(let r=0;r<t.length;r++)n.push(id(e.T,t[r]));break;case"enum":for(let i=0;i<t.length;i++)n.push(iu(e.T,t[i],r.enumAsInteger));break;case"message":for(let e=0;e<t.length;e++)n.push(t[e].toJson(r))}return r.emitDefaultValues||n.length>0?n:void 0}switch(e.kind){case"scalar":return id(e.T,t);case"enum":return iu(e.T,t,r.enumAsInteger);case"message":return n5(e.T,t).toJson(r)}}function iu(e,t,r){var n;if(nT("number"==typeof t),"google.protobuf.NullValue"==e.typeName)return null;if(r)return t;let i=e.findNumber(t);return null!==(n=i?.name)&&void 0!==n?n:t}function id(e,t){switch(e){case l.INT32:case l.SFIXED32:case l.SINT32:case l.FIXED32:case l.UINT32:return nT("number"==typeof t),t;case l.FLOAT:case l.DOUBLE:return nT("number"==typeof t),Number.isNaN(t)?"NaN":t===Number.POSITIVE_INFINITY?"Infinity":t===Number.NEGATIVE_INFINITY?"-Infinity":t;case l.STRING:return nT("string"==typeof t),t;case l.BOOL:return nT("boolean"==typeof t),t;case l.UINT64:case l.FIXED64:case l.INT64:case l.SFIXED64:case l.SINT64:return nT("bigint"==typeof t||"string"==typeof t||"number"==typeof t),t.toString();case l.BYTES:return nT(t instanceof Uint8Array),n1.enc(t)}}D();var ic=Symbol("@bufbuild/protobuf/unknown-fields"),il={readUnknownFields:!0,readerFactory:e=>new nH(e)},ih={writeUnknownFields:!0,writerFactory:()=>new nX};function ip(e,t,r,n,i){let{repeated:a,localName:s}=r;switch(r.oneof&&((e=e[r.oneof.localName]).case!=s&&delete e.value,e.case=s,s="value"),r.kind){case"scalar":case"enum":let o="enum"==r.kind?l.INT32:r.T,u=ig;if("scalar"==r.kind&&r.L>0&&(u=iy),a){let r=e[s];if(n==p.LengthDelimited&&o!=l.STRING&&o!=l.BYTES){let e=t.uint32()+t.pos;for(;t.pos<e;)r.push(u(t,o))}else r.push(u(t,o))}else e[s]=u(t,o);break;case"message":let d=r.T;a?e[s].push(im(t,new d,i,r)):n7(e[s])?im(t,e[s],i,r):(e[s]=im(t,new d,i,r),!d.fieldWrapper||r.oneof||r.repeated||(e[s]=d.fieldWrapper.unwrapField(e[s])));break;case"map":let[c,f]=function(e,t,r){let n=t.uint32(),i=t.pos+n,a,s;for(;t.pos<i;){let[n]=t.tag();switch(n){case 1:a=ig(t,e.K);break;case 2:switch(e.V.kind){case"scalar":s=ig(t,e.V.T);break;case"enum":s=t.int32();break;case"message":s=im(t,new e.V.T,r,void 0)}}}if(void 0===a&&(a=nG(e.K,h.BIGINT)),"string"!=typeof a&&"number"!=typeof a&&(a=a.toString()),void 0===s)switch(e.V.kind){case"scalar":s=nG(e.V.T,h.BIGINT);break;case"enum":s=e.V.T.values[0].no;break;case"message":s=new e.V.T}return[a,s]}(r,t,i);e[s][c]=f}}function im(e,t,r,n){let i=t.getType().runtime.bin,a=n?.delimited;return i.readMessage(t,e,a?n.no:e.uint32(),r,a),t}function iy(e,t){let r=ig(e,t);return"bigint"==typeof r?r.toString():r}function ig(e,t){switch(t){case l.STRING:return e.string();case l.BOOL:return e.bool();case l.DOUBLE:return e.double();case l.FLOAT:return e.float();case l.INT32:return e.int32();case l.INT64:return e.int64();case l.UINT64:return e.uint64();case l.FIXED64:return e.fixed64();case l.BYTES:return e.bytes();case l.FIXED32:return e.fixed32();case l.SFIXED32:return e.sfixed32();case l.SFIXED64:return e.sfixed64();case l.SINT64:return e.sint64();case l.UINT32:return e.uint32();case l.SINT32:return e.sint32()}}function i_(e,t,r,n){nT(void 0!==t);let i=e.repeated;switch(e.kind){case"scalar":case"enum":let a="enum"==e.kind?l.INT32:e.T;if(i){if(nT(Array.isArray(t)),e.packed)!function(e,t,r,n){if(!n.length)return;e.tag(r,p.LengthDelimited).fork();let[,i]=iw(t);for(let t=0;t<n.length;t++)e[i](n[t]);e.join()}(r,a,e.no,t);else for(let n of t)ib(r,a,e.no,n)}else ib(r,a,e.no,t);break;case"message":if(i)for(let i of(nT(Array.isArray(t)),t))iv(r,n,e,i);else iv(r,n,e,t);break;case"map":for(let[i,a]of(nT("object"==typeof t&&null!=t),Object.entries(t)))!function(e,t,r,n,i){e.tag(r.no,p.LengthDelimited),e.fork();let a=n;switch(r.K){case l.INT32:case l.FIXED32:case l.UINT32:case l.SFIXED32:case l.SINT32:a=Number.parseInt(n);break;case l.BOOL:nT("true"==n||"false"==n),a="true"==n}switch(ib(e,r.K,1,a),r.V.kind){case"scalar":ib(e,r.V.T,2,i);break;case"enum":ib(e,l.INT32,2,i);break;case"message":nT(void 0!==i),e.tag(2,p.LengthDelimited).bytes(i.toBinary(t))}e.join()}(r,n,e,i,a)}}function iv(e,t,r,n){let i=n5(r.T,n);r.delimited?e.tag(r.no,p.StartGroup).raw(i.toBinary(t)).tag(r.no,p.EndGroup):e.tag(r.no,p.LengthDelimited).bytes(i.toBinary(t))}function ib(e,t,r,n){nT(void 0!==n);let[i,a]=iw(t);e.tag(r,i)[a](n)}function iw(e){let t=p.Varint;switch(e){case l.BYTES:case l.STRING:t=p.LengthDelimited;break;case l.DOUBLE:case l.FIXED64:case l.SFIXED64:t=p.Bit64;break;case l.FIXED32:case l.SFIXED32:case l.FLOAT:t=p.Bit32}return[t,l[e].toLowerCase()]}function ik(e){if(void 0===e)return e;if(n7(e))return e.clone();if(e instanceof Uint8Array){let t=new Uint8Array(e.byteLength);return t.set(e),t}return e}function iE(e){return e instanceof Uint8Array?e:new Uint8Array(e)}D(),D();var iI=class{constructor(e,t){this._fields=e,this._normalizer=t}findJsonName(e){if(!this.jsonNames){let e={};for(let t of this.list())e[t.jsonName]=e[t.name]=t;this.jsonNames=e}return this.jsonNames[e]}find(e){if(!this.numbers){let e={};for(let t of this.list())e[t.no]=t;this.numbers=e}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,t)=>e.no-t.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];let e=this.members,t;for(let r of this.list())r.oneof?r.oneof!==t&&(t=r.oneof,e.push(t)):e.push(r)}return this.members}};function ix(e,t){let r=iS(e);return t?r:iF(iA(r))}D(),D(),D();var iO=iS;function iS(e){let t=!1,r=[];for(let n=0;n<e.length;n++){let i=e.charAt(n);switch(i){case"_":t=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":r.push(i),t=!1;break;default:t&&(t=!1,i=i.toUpperCase()),r.push(i)}}return r.join("")}var iT=new Set(["constructor","toString","toJSON","valueOf"]),iC=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),iD=e=>`${e}$`,iA=e=>iC.has(e)?iD(e):e,iF=e=>iT.has(e)?iD(e):e,iP=class{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=ix(e,!1)}addField(e){nT(e.oneof===this,`field ${e.name} not one of ${this.name}`),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let e=0;e<this.fields.length;e++)this._lookup[this.fields[e].localName]=this.fields[e]}return this._lookup[e]}},iN={syntax:"proto3",json:{makeReadOptions:function(e){return e?Object.assign(Object.assign({},n8),e):n8},makeWriteOptions:function(e){return e?Object.assign(Object.assign({},n9),e):n9},readMessage(e,t,r,n){if(null==t||Array.isArray(t)||"object"!=typeof t)throw Error(`cannot decode message ${e.typeName} from JSON: ${ir(t)}`);n=n??new e;let i=new Map,a=r.typeRegistry;for(let[s,o]of Object.entries(t)){let t=e.fields.findJsonName(s);if(t){if(t.oneof){if(null===o&&"scalar"==t.kind)continue;let r=i.get(t.oneof);if(void 0!==r)throw Error(`cannot decode message ${e.typeName} from JSON: multiple keys for oneof "${t.oneof.name}" present: "${r}", "${s}"`);i.set(t.oneof,s)}ii(n,o,t,r,e)}else{let t=!1;if(a?.findExtension&&s.startsWith("[")&&s.endsWith("]")){let i=a.findExtension(s.substring(1,s.length-1));if(i&&i.extendee.typeName==e.typeName){t=!0;let[e,a]=nY(i);ii(e,o,i.field,r,i),function(e,t,r,n){n4(t,e);let i=t.runtime.bin.makeReadOptions(n),a=t.runtime.bin.makeWriteOptions(n);if(n2(e,t)){let r=e.getType().runtime.bin.listUnknownFields(e).filter(e=>e.no!=t.field.no);for(let t of(e.getType().runtime.bin.discardUnknownFields(e),r))e.getType().runtime.bin.onUnknownField(e,t.no,t.wireType,t.data)}let s=a.writerFactory(),o=t.field;o.opt||o.repeated||"enum"!=o.kind&&"scalar"!=o.kind||(o=Object.assign(Object.assign({},t.field),{opt:!0})),t.runtime.bin.writeField(o,r,s,a);let u=i.readerFactory(s.finish());for(;u.pos<u.len;){let[t,r]=u.tag(),n=u.skip(r,t);e.getType().runtime.bin.onUnknownField(e,t,r,n)}}(n,i,a(),r)}}if(!t&&!r.ignoreUnknownFields)throw Error(`cannot decode message ${e.typeName} from JSON: key "${s}" is unknown`)}}return n},writeMessage(e,t){let r=e.getType(),n={},i;try{for(i of r.fields.byNumber()){if(!n3(i,e)){var a;if(i.req)throw"required field not set";if(!t.emitDefaultValues||!((a=i).repeated||"map"==a.kind||!(a.oneof||"message"==a.kind||a.opt||a.req)))continue}let r=i.oneof?e[i.oneof.localName].value:e[i.localName],s=io(i,r,t);void 0!==s&&(n[t.useProtoFieldName?i.name:i.jsonName]=s)}let s=t.typeRegistry;if(s?.findExtensionFor)for(let i of r.runtime.bin.listUnknownFields(e)){let a=s.findExtensionFor(r.typeName,i.no);if(a&&n2(e,a)){let r=function(e,t,r){n4(t,e);let n=t.runtime.bin.makeReadOptions(r),i=function(e,t){if(!t.repeated&&("enum"==t.kind||"scalar"==t.kind)){for(let r=e.length-1;r>=0;--r)if(e[r].no==t.no)return[e[r]];return[]}return e.filter(e=>e.no===t.no)}(e.getType().runtime.bin.listUnknownFields(e),t.field),[a,s]=nY(t);for(let e of i)t.runtime.bin.readField(a,n.readerFactory(e.data),t.field,e.wireType,n);return s()}(e,a,t),i=io(a.field,r,t);void 0!==i&&(n[a.field.jsonName]=i)}}}catch(n){let e=i?`cannot encode field ${r.typeName}.${i.name} to JSON`:`cannot encode message ${r.typeName} to JSON`,t=n instanceof Error?n.message:String(n);throw Error(e+(t.length>0?`: ${t}`:""))}return n},readScalar:(e,t,r)=>ia(e,t,r??h.BIGINT,!0),writeScalar(e,t,r){if(void 0!==t&&(r||nK(e,t)))return id(e,t)},debug:ir},bin:{makeReadOptions:function(e){return e?Object.assign(Object.assign({},il),e):il},makeWriteOptions:function(e){return e?Object.assign(Object.assign({},ih),e):ih},listUnknownFields(e){var t;return null!==(t=e[ic])&&void 0!==t?t:[]},discardUnknownFields(e){delete e[ic]},writeUnknownFields(e,t){let r=e[ic];if(r)for(let e of r)t.tag(e.no,e.wireType).raw(e.data)},onUnknownField(e,t,r,n){Array.isArray(e[ic])||(e[ic]=[]),e[ic].push({no:t,wireType:r,data:n})},readMessage(e,t,r,n,i){let a=e.getType(),s=i?t.len:t.pos+r,o,u;for(;t.pos<s&&([o,u]=t.tag(),!(!0===i&&u==p.EndGroup));){let r=a.fields.find(o);if(!r){let r=t.skip(u,o);n.readUnknownFields&&this.onUnknownField(e,o,u,r);continue}ip(e,t,r,u,n)}if(i&&(u!=p.EndGroup||o!==r))throw Error("invalid end group tag")},readField:ip,writeMessage(e,t,r){let n=e.getType();for(let i of n.fields.byNumber()){if(!n3(i,e)){if(i.req)throw Error(`cannot encode field ${n.typeName}.${i.name} to binary: required field not set`);continue}let a=i.oneof?e[i.oneof.localName].value:e[i.localName];i_(i,a,t,r)}return r.writeUnknownFields&&this.writeUnknownFields(e,t),t},writeField(e,t,r,n){void 0!==t&&i_(e,t,r,n)}},util:Object.assign(Object.assign({},{setEnumType:nP,initPartial(e,t){if(void 0!==e)for(let r of t.getType().fields.byMember()){let n=r.localName;if(null!=e[n])switch(r.kind){case"oneof":let i=e[n].case;if(void 0===i)continue;let a=r.findField(i),s=e[n].value;a&&"message"==a.kind&&!n7(s,a.T)?s=new a.T(s):a&&"scalar"===a.kind&&a.T===l.BYTES&&(s=iE(s)),t[n]={case:i,value:s};break;case"scalar":case"enum":let o=e[n];r.T===l.BYTES&&(o=r.repeated?o.map(iE):iE(o)),t[n]=o;break;case"map":switch(r.V.kind){case"scalar":case"enum":if(r.V.T===l.BYTES)for(let[r,i]of Object.entries(e[n]))t[n][r]=iE(i);else Object.assign(t[n],e[n]);break;case"message":let u=r.V.T;for(let r of Object.keys(e[n])){let i=e[n][r];u.fieldWrapper||(i=new u(i)),t[n][r]=i}}break;case"message":let d=r.T;if(r.repeated)t[n]=e[n].map(e=>n7(e,d)?e:new d(e));else{let r=e[n];d.fieldWrapper?"google.protobuf.BytesValue"===d.typeName?t[n]=iE(r):t[n]=r:t[n]=n7(r,d)?r:new d(r)}}}},equals:(e,t,r)=>t===r||!!t&&!!r&&e.fields.byMember().every(e=>{let n=t[e.localName],i=r[e.localName];if(e.repeated){if(n.length!==i.length)return!1;switch(e.kind){case"message":return n.every((t,r)=>e.T.equals(t,i[r]));case"scalar":return n.every((t,r)=>nW(e.T,t,i[r]));case"enum":return n.every((e,t)=>nW(l.INT32,e,i[t]))}throw Error(`repeated cannot contain ${e.kind}`)}switch(e.kind){case"message":return e.T.equals(n,i);case"enum":return nW(l.INT32,n,i);case"scalar":return nW(e.T,n,i);case"oneof":if(n.case!==i.case)return!1;let a=e.findField(n.case);if(void 0===a)return!0;switch(a.kind){case"message":return a.T.equals(n.value,i.value);case"enum":return nW(l.INT32,n.value,i.value);case"scalar":return nW(a.T,n.value,i.value)}throw Error(`oneof cannot contain ${a.kind}`);case"map":let s=Object.keys(n).concat(Object.keys(i));switch(e.V.kind){case"message":let o=e.V.T;return s.every(e=>o.equals(n[e],i[e]));case"enum":return s.every(e=>nW(l.INT32,n[e],i[e]));case"scalar":let u=e.V.T;return s.every(e=>nW(u,n[e],i[e]))}}}),clone(e){let t=e.getType(),r=new t;for(let n of t.fields.byMember()){let t=e[n.localName],i;if(n.repeated)i=t.map(ik);else if("map"==n.kind)for(let[e,a]of(i=r[n.localName],Object.entries(t)))i[e]=ik(a);else i="oneof"==n.kind?n.findField(t.case)?{case:t.case,value:ik(t.value)}:{case:void 0}:ik(t);r[n.localName]=i}for(let n of t.runtime.bin.listUnknownFields(e))t.runtime.bin.onUnknownField(r,n.no,n.wireType,n.data);return r}}),{newFieldList:e=>new iI(e,e=>(function(e,t){var r,n,i,a,s,o;let u=[],d;for(let c of"function"==typeof e?e():e){if(c.localName=ix(c.name,void 0!==c.oneof),c.jsonName=null!==(r=c.jsonName)&&void 0!==r?r:iO(c.name),c.repeated=null!==(n=c.repeated)&&void 0!==n&&n,"scalar"==c.kind&&(c.L=null!==(i=c.L)&&void 0!==i?i:h.BIGINT),c.delimited=null!==(a=c.delimited)&&void 0!==a&&a,c.req=null!==(s=c.req)&&void 0!==s&&s,c.opt=null!==(o=c.opt)&&void 0!==o&&o,void 0===c.packed&&(t?c.packed="enum"==c.kind||"scalar"==c.kind&&c.T!=l.BYTES&&c.T!=l.STRING:c.packed=!1),void 0!==c.oneof){let e="string"==typeof c.oneof?c.oneof:c.oneof.name;d&&d.name==e||(d=new iP(e)),c.oneof=d,d.addField(c)}u.push(c)}return u})(e,!0)),initFields:e=>{for(let t of e.getType().fields.byMember()){if(t.opt)continue;let r=t.localName;if(t.repeated){e[r]=[];continue}switch(t.kind){case"oneof":e[r]={case:void 0};break;case"enum":e[r]=0;break;case"map":e[r]={};break;case"scalar":e[r]=nG(t.T,t.L)}}}}),makeMessageType(e,t,r){var n,i;let a,s;return n=this,Object.setPrototypeOf((s=({[a=null!==(i=r?.localName)&&void 0!==i?i:e.substring(e.lastIndexOf(".")+1)]:function(e){n.util.initFields(this),n.util.initPartial(e,this)}})[a]).prototype,new nZ),Object.assign(s,{runtime:n,typeName:e,fields:n.util.newFieldList(t),fromBinary:(e,t)=>new s().fromBinary(e,t),fromJson:(e,t)=>new s().fromJson(e,t),fromJsonString:(e,t)=>new s().fromJsonString(e,t),equals:(e,t)=>n.util.equals(s,e,t)}),s},makeEnum:function(e,t,r){let n={};for(let e of t){let t=nj(e);n[t.localName]=t.no,n[t.no]=t.localName}return nP(n,e,t,r),n},makeEnumType:nN,getEnumType:function(e){let t=e[nF];return nT(t,"missing enum type on enum object"),t},makeExtension(e,t,r){var n;let i;return n=this,{typeName:e,extendee:t,get field(){if(!i){let t="function"==typeof r?r():r;t.name=e.split(".").pop(),t.jsonName=`[${e}]`,i=n.util.newFieldList([t]).list()[0]}return i},runtime:n}}};D();var ij=iN.makeMessageType("PDFC.CorePB.Generated.Matrix",()=>[{no:1,name:"a",kind:"scalar",T:2},{no:2,name:"b",kind:"scalar",T:2},{no:3,name:"c",kind:"scalar",T:2},{no:4,name:"d",kind:"scalar",T:2},{no:5,name:"e",kind:"scalar",T:2},{no:6,name:"f",kind:"scalar",T:2}]),iZ=iN.makeMessageType("PDFC.CorePB.Generated.Rect",()=>[{no:1,name:"x",kind:"scalar",T:2},{no:2,name:"y",kind:"scalar",T:2},{no:3,name:"width",kind:"scalar",T:2},{no:4,name:"height",kind:"scalar",T:2}]),iR=iN.makeMessageType("PDFC.CorePB.Generated.PdfRect",()=>[{no:1,name:"l",kind:"scalar",T:2},{no:2,name:"t",kind:"scalar",T:2},{no:3,name:"r",kind:"scalar",T:2},{no:4,name:"b",kind:"scalar",T:2}]),iB=iN.makeMessageType("PDFC.CorePB.Generated.RawPdfBoxes",()=>[{no:1,name:"mediaBox",kind:"message",T:iR},{no:2,name:"cropBox",kind:"message",T:iR},{no:3,name:"bleedBox",kind:"message",T:iR},{no:4,name:"trimBox",kind:"message",T:iR}]),iL=iN.makeMessageType("PDFC.CorePB.Generated.PageInfo",()=>[{no:1,name:"page_index",kind:"scalar",T:5},{no:2,name:"page_label",kind:"scalar",T:9,opt:!0},{no:3,name:"rotation",kind:"scalar",T:5},{no:4,name:"width",kind:"scalar",T:2},{no:5,name:"height",kind:"scalar",T:2},{no:6,name:"matrix",kind:"message",T:ij},{no:7,name:"reverse_matrix",kind:"message",T:ij},{no:8,name:"transformed_bbox",kind:"message",T:iZ},{no:9,name:"untransformed_bbox",kind:"message",T:iZ},{no:10,name:"raw_pdf_boxes",kind:"message",T:iB}]),iM=iN.makeMessageType("PDFC.CorePB.Generated.PDFPermissions",()=>[{no:1,name:"annotations_and_forms",kind:"scalar",T:8},{no:2,name:"assemble",kind:"scalar",T:8},{no:3,name:"extract",kind:"scalar",T:8},{no:4,name:"extract_accessibility",kind:"scalar",T:8},{no:5,name:"fill_forms",kind:"scalar",T:8},{no:6,name:"modification",kind:"scalar",T:8},{no:7,name:"print_high_quality",kind:"scalar",T:8},{no:8,name:"printing",kind:"scalar",T:8}]),iq=iN.makeMessageType("PDFC.CorePB.Generated.Metadata",()=>[{no:1,name:"author",kind:"scalar",T:9,opt:!0},{no:2,name:"creator",kind:"scalar",T:9,opt:!0},{no:3,name:"date_created",kind:"scalar",T:9,opt:!0},{no:4,name:"date_modified",kind:"scalar",T:9,opt:!0},{no:5,name:"producer",kind:"scalar",T:9,opt:!0},{no:6,name:"title",kind:"scalar",T:9,opt:!0},{no:7,name:"subject",kind:"scalar",T:9,opt:!0},{no:8,name:"keywords",kind:"scalar",T:9,opt:!0}]),iU=iN.makeMessageType("PDFC.CorePB.Generated.PDFID",()=>[{no:1,name:"permanent",kind:"scalar",T:9},{no:2,name:"changing",kind:"scalar",T:9}]),iz=iN.makeMessageType("PDFC.CorePB.Generated.DocumentInfo",()=>[{no:1,name:"page_count",kind:"scalar",T:5},{no:2,name:"title",kind:"scalar",T:9,opt:!0},{no:3,name:"permissions",kind:"message",T:iM,opt:!0},{no:4,name:"metadata",kind:"message",T:iq},{no:5,name:"page_info",kind:"map",K:5,V:{kind:"message",T:iL}},{no:6,name:"pdf_id",kind:"message",T:iU,opt:!0}]),i$=iN.makeEnum("PDFC.CorePB.Generated.Availability",[{no:0,name:"ERROR"},{no:1,name:"AVAILABLE"},{no:2,name:"NOT_AVAILABLE_YET"}]),iV=iN.makeEnum("PDFC.CorePB.Generated.IsLinearized",[{no:0,name:"UNKNOWN"},{no:1,name:"LINEARIZED"},{no:2,name:"NOT_LINEARIZED"}]),iJ=iN.makeEnum("PDFC.CorePB.Generated.PageEncoding",[{no:0,name:"JPEG"},{no:1,name:"PNG"},{no:2,name:"WEBP"},{no:3,name:"TIFF"},{no:4,name:"GIF"},{no:5,name:"BITMAP"}]),iW=iN.makeMessageType("PDFC.CorePB.Generated.DownloadChunk",()=>[{no:2,name:"offset",kind:"scalar",T:3},{no:3,name:"size",kind:"scalar",T:3}]),iG=iN.makeMessageType("PDFC.CorePB.Generated.AvailabilityWithDownloads",()=>[{no:1,name:"is_available",kind:"enum",T:iN.getEnumType(i$)},{no:2,name:"downloads_required",kind:"message",T:iW,repeated:!0}]),iK=iN.makeMessageType("PDFC.CorePB.Generated.IsPageAvailableRequest",()=>[{no:1,name:"linearized_instance_id",kind:"scalar",T:5},{no:2,name:"page_index",kind:"scalar",T:5}]),iX=iN.makeMessageType("PDFC.CorePB.Generated.IsPageAvailableResponse",()=>[{no:1,name:"is_page_available",kind:"message",T:iG},{no:2,name:"page_info",kind:"message",T:iL,opt:!0}]),iH=iN.makeMessageType("PDFC.CorePB.Generated.GetDocumentInfoRequest",()=>[{no:1,name:"linearized_instance_id",kind:"scalar",T:5}]),iY=iN.makeMessageType("PDFC.CorePB.Generated.GetDocumentInfoResponse",()=>[{no:1,name:"is_available",kind:"message",T:iG,oneof:"response"},{no:2,name:"document_info",kind:"message",T:iz,oneof:"response"}]),iQ=iN.makeMessageType("PDFC.CorePB.Generated.IsDocumentAvailableRequest",()=>[{no:1,name:"linearized_instance_id",kind:"scalar",T:5}]),i0=iN.makeMessageType("PDFC.CorePB.Generated.IsDocumentAvailableResponse",()=>[{no:1,name:"is_available",kind:"message",T:iG}]),i1=iN.makeMessageType("PDFC.CorePB.Generated.OnDataWrittenRequest",()=>[{no:1,name:"linearized_instance_id",kind:"scalar",T:5},{no:2,name:"offset",kind:"scalar",T:3},{no:3,name:"size",kind:"scalar",T:3}]),i2=iN.makeMessageType("PDFC.CorePB.Generated.OnDataWrittenResponse",[]),i4=iN.makeMessageType("PDFC.CorePB.Generated.IsLinearizedRequest",()=>[{no:1,name:"linearized_instance_id",kind:"scalar",T:5}]),i3=iN.makeMessageType("PDFC.CorePB.Generated.IsLinearizedResponse",()=>[{no:1,name:"is_linearized",kind:"enum",T:iN.getEnumType(iV)},{no:2,name:"downloads_required",kind:"message",T:iW,repeated:!0}]),i6=iN.makeMessageType("PDFC.CorePB.Generated.InitializeRequest",()=>[{no:1,name:"filepath",kind:"scalar",T:9},{no:2,name:"full_file_size",kind:"scalar",T:3}]),i7=iN.makeMessageType("PDFC.CorePB.Generated.InitializeResponse",()=>[{no:1,name:"linearized_instance_id",kind:"scalar",T:5}]),i5=iN.makeMessageType("PDFC.CorePB.Generated.GetContentTreeRequest",()=>[{no:1,name:"linearized_instance_id",kind:"scalar",T:5},{no:2,name:"page_index",kind:"scalar",T:5}]),i8=iN.makeMessageType("PDFC.CorePB.Generated.GetContentTreeResponse",()=>[{no:1,name:"is_available",kind:"message",T:iG},{no:2,name:"content_tree_json",kind:"scalar",T:9}]),i9=iN.makeMessageType("PDFC.CorePB.Generated.EMBindRenderRequest",()=>[{no:1,name:"linearized_instance_id",kind:"scalar",T:5},{no:2,name:"page_index",kind:"scalar",T:5},{no:3,name:"bitmap_width",kind:"scalar",T:5},{no:4,name:"bitmap_height",kind:"scalar",T:5},{no:5,name:"bitmap_x",kind:"scalar",T:5},{no:6,name:"bitmap_y",kind:"scalar",T:5},{no:7,name:"page_width",kind:"scalar",T:5},{no:8,name:"page_height",kind:"scalar",T:5},{no:9,name:"page_encoding",kind:"enum",T:iN.getEnumType(iJ)}]),ae=iN.makeMessageType("PDFC.CorePB.Generated.CloseRequest",()=>[{no:1,name:"linearized_instance_id",kind:"scalar",T:5}]),at=iN.makeMessageType("PDFC.CorePB.Generated.CloseResponse",[]),ar=(e,t)=>{let r=new FormData;return r.append("data",JSON.stringify({annotations:e.annotations,formFieldValues:e.formFieldValues,formFields:e.formFields,signatures:e.signatures||[]})),t&&t.length>0&&t.forEach(t=>{let n=e.attachments[t];F(n,`Attachment data '${t}' could not be found.`),F(n.data,`Attachment '${t}' doesn't have any data.`),r.append(t,n.data)}),r};async function an(e,t,r){t.options.format=t.options.format??"bitmap";let n=nb.getImageFormatForImageDimensions(t.options.format,t.pageSize),i=t.documentState&&(t.documentState.annotations.length>0||t.documentState.formFieldValues.length>0),a=await r.addPromise(e.engine.executeCommand("render_tile",t.options.priority??0,{render_annotations:i,print_rendering:t.options.renderForPrinting,page:t.pageIndex,bitmap_width:t.tileRect.width,bitmap_height:t.tileRect.height,bitmap_x:t.tileRect.left,bitmap_y:t.tileRect.top,page_width:t.pageSize.width,page_height:t.pageSize.height,format:n,render_text:t.options.renderText??!0}));return F(1==a.values.length,"Should have exactly one image buffer in result."),F(a.values[0]instanceof Uint8Array,void 0),{buffer:a.values[0],format:n}}var ai=class{constructor(e,t,r){this.identifier="LinearizedRenderingRequest",this.coreClient=e,this.embindRequest=t,this.format=r}async request(){return{buffer:new Uint8Array(await this.coreClient.renderLinearized(this.embindRequest.toBinary())),format:this.format}}};async function aa(e,t,r,n){F(e.wasmCtx,"Wasm context is required for linearized rendering."),await n.whenPageAvailable(t.pageIndex,r),t.options.format=t.options.format??"bitmap";let i=nb.getImageFormatForImageDimensions(t.options.format,t.pageSize),a=new i9;a.linearizedInstanceId=n.linearizedInstanceId,a.pageIndex=t.pageIndex,a.bitmapWidth=t.tileRect.width,a.bitmapHeight=t.tileRect.height,a.bitmapX=t.tileRect.left,a.bitmapY=t.tileRect.top,a.pageWidth=t.pageSize.width,a.pageHeight=t.pageSize.height,a.pageEncoding=function(e){switch(e){case"bitmap":return iJ.BITMAP;case"jpeg":return iJ.JPEG;case"png":return iJ.PNG;case"webp":return iJ.WEBP;default:throw new r5(`Unsupported image format: ${e}`)}}(i);let{promise:s,cancel:o}=e.requestQueue.enqueue(new ai(e.wasmCtx.engine.coreClient,a,i),t.options.priority??0);return r.addCancelFn(o),s}var as=(e,t,r,n,i,a,s)=>{let o=new au,u=nf(e,async s=>{let u={pageIndex:t,pageSize:r,tileRect:n,options:i,documentState:a},d=s.linearizedInstance?.deref();return d&&d.isRunning()?aa(e,u,o,d):an(s,u,o)},async u=>{F(!i.format,"Requesting image format is not supported on server.");let d=`page-${t}-dimensions-${r.width}-${r.height}-tile-${n.left}-${n.top}-${n.width}-${n.height}${i.renderForPrinting?"-print":""}`,c=a?ar(a,s):void 0,l=3!=nv||r.width<=nb.MAX_WEBP_DIMENSION&&r.height<=nb.MAX_WEBP_DIMENSION,h=await o.addPromise(nS(e.requestQueue,u,d,i.priority,2,{method:c?"POST":"GET",body:c,headers:l?{Accept:"image/webp,*/*"}:void 0}));if(!h.ok){if("application/json"===h.headers.get("content-type")){let s=await h.json();if(s.attachments_not_found){if(!a)throw new r5("Document state is required when attachments are missing");for(let e of s.attachments_not_found)if(!a.attachments[e])throw new r5(`Attachment ${e} not found in document state, but required by server.`);let u=as(e,t,r,n,i,a,s.attachments_not_found);return o.addCancelFn(()=>{u.cancel()}),u.promise}if(s.error)throw new r5(`The server could not render the requested image (${s.error})`)}else throw new r5(`The image can not be rendered because of an unknown error (${h.status})`)}let p=await h.arrayBuffer();return{buffer:new Uint8Array(p),format:nb.getImageFormatFromMimeType(h.headers.get("content-type"))}});return o.wrapPromise(u)},ao={};S(ao,{getContentTreeForPage:()=>al,getTextForPage:()=>ac}),D(),D();var au=class{constructor(){this.cancelled=!1,this.cancelFns=[]}cancel(){for(let e of this.cancelFns)e();this.cancelled=!0}isCancelled(){return this.cancelled}addCancelFn(e){this.cancelFns.push(e)}addPromise(e){return this.addCancelFn(e.cancel),e.promise}wrapPromise(e){return ad({promise:e,cancel:()=>this.cancel()})}},ad=e=>({promise:e.promise,cancel:e.cancel,then:(t,r)=>ad({promise:e.promise.then(t,r),cancel:e.cancel})}),ac=(e,t)=>{let r=new au,n=nf(e,async e=>{let n=await r.addPromise(e.engine.executeCommand("page_info",0,{page:t,query:"text_lines"}));F(1==n.values.length,"Should have exactly one result.");let i=n.values[0];return F(r9(i),"Should have a binary result."),JSON.parse(new TextDecoder().decode(i)).textLines},async n=>{let i=`page-${t}-text`;return(await (await r.addPromise(nS(e.requestQueue,n,i,0,0))).json()).textLines});return r.wrapPromise(n)},al=(e,t)=>{let r=new au,n=nf(e,async e=>{let n=await r.addPromise(e.engine.executeCommand("get_content_tree",0,{pageIndex:t,version:1}));return F(1==n.values.length,"Should have exactly one result."),F(!r9(n.values[0]),"Should have a JSON result."),[n.values[0]]},async n=>{let i=n.satisfiesVersion(">=1.3.0"),a=`page-${t}-text-content${i?"-v-1":""}`;return(await r.addPromise(nS(e.requestQueue,n,a,0,0))).json()},async(e,n)=>(await n.whenPageAvailable(t,r),[await n.getContentTree(t)]));return r.wrapPromise(n)};D();var ah=((a=ah||{})[a.Normal=0]="Normal",a[a.High=1]="High",a),ap=((s=ap||{}).PNG="png",s.JPEG="jpeg",s.WebP="webp",s.Bitmap="bitmap",s);D(),D(),D();var af=iN.makeEnum("PDFC.WASM.Protobuf.Generated.Code",[{no:0,name:"OK"},{no:2,name:"UNKNOWN"},{no:3,name:"INVALID_ARGUMENT"},{no:4,name:"DEADLINE_EXCEEDED"},{no:5,name:"NOT_FOUND"},{no:6,name:"ALREADY_EXISTS"},{no:7,name:"PERMISSION_DENIED"},{no:16,name:"UNAUTHENTICATED"},{no:8,name:"RESOURCE_EXHAUSTED"},{no:9,name:"FAILED_PRECONDITION"},{no:10,name:"ABORTED"},{no:11,name:"OUT_OF_RANGE"},{no:12,name:"UNIMPLEMENTED"},{no:13,name:"INTERNAL"},{no:14,name:"UNAVAILABLE"},{no:15,name:"DATA_LOSS"}]),am=iN.makeMessageType("PDFC.WASM.Protobuf.Generated.Status",()=>[{no:1,name:"code",kind:"enum",T:iN.getEnumType(af)},{no:2,name:"message",kind:"scalar",T:9}]),ay=class{constructor(e){this.bridgeFn=e}async Initialize(e){let t;if(!(t=await this.bridgeFn("PDFC.CorePB.Generated.Linearized","Initialize",e.toBinary())).success){let e=am.fromBinary(t.result.slice());throw Error(e.message,{cause:e})}if(!t.result)throw Error("No result returned - this should not happen.");return i7.fromBinary(t.result.slice())}async IsLinearized(e){let t;if(!(t=await this.bridgeFn("PDFC.CorePB.Generated.Linearized","IsLinearized",e.toBinary())).success){let e=am.fromBinary(t.result.slice());throw Error(e.message,{cause:e})}if(!t.result)throw Error("No result returned - this should not happen.");return i3.fromBinary(t.result.slice())}async IsDocumentAvailable(e){let t;if(!(t=await this.bridgeFn("PDFC.CorePB.Generated.Linearized","IsDocumentAvailable",e.toBinary())).success){let e=am.fromBinary(t.result.slice());throw Error(e.message,{cause:e})}if(!t.result)throw Error("No result returned - this should not happen.");return i0.fromBinary(t.result.slice())}async IsPageAvailable(e){let t;if(!(t=await this.bridgeFn("PDFC.CorePB.Generated.Linearized","IsPageAvailable",e.toBinary())).success){let e=am.fromBinary(t.result.slice());throw Error(e.message,{cause:e})}if(!t.result)throw Error("No result returned - this should not happen.");return iX.fromBinary(t.result.slice())}async GetDocumentInfo(e){let t;if(!(t=await this.bridgeFn("PDFC.CorePB.Generated.Linearized","GetDocumentInfo",e.toBinary())).success){let e=am.fromBinary(t.result.slice());throw Error(e.message,{cause:e})}if(!t.result)throw Error("No result returned - this should not happen.");return iY.fromBinary(t.result.slice())}async OnDataWritten(e){let t;if(!(t=await this.bridgeFn("PDFC.CorePB.Generated.Linearized","OnDataWritten",e.toBinary())).success){let e=am.fromBinary(t.result.slice());throw Error(e.message,{cause:e})}if(!t.result)throw Error("No result returned - this should not happen.");return i2.fromBinary(t.result.slice())}async GetContentTree(e){let t;if(!(t=await this.bridgeFn("PDFC.CorePB.Generated.Linearized","GetContentTree",e.toBinary())).success){let e=am.fromBinary(t.result.slice());throw Error(e.message,{cause:e})}if(!t.result)throw Error("No result returned - this should not happen.");return i8.fromBinary(t.result.slice())}async Close(e){let t;if(!(t=await this.bridgeFn("PDFC.CorePB.Generated.Linearized","Close",e.toBinary())).success){let e=am.fromBinary(t.result.slice());throw Error(e.message,{cause:e})}if(!t.result)throw Error("No result returned - this should not happen.");return at.fromBinary(t.result.slice())}};D(),D();var ag=class e{constructor(e,t){void 0===t?(this.start=e,this.end=e):(this.start=e,this.end=t)}static InvalidRange(){return new e(Number.MAX_SAFE_INTEGER)}isValid(){return!this.equals(e.InvalidRange())}length(){return this.getMax()-this.getMin()}isReversed(){return this.start>this.end}isEmpty(){return this.start===this.end}getMin(){return Math.min(this.start,this.end)}getMax(){return Math.max(this.start,this.end)}equals(e){return this.start===e.start&&this.end===e.end}equalsIgnoringDirection(e){return this.getMin()===e.getMin()&&this.getMax()===e.getMax()}contains(e){return e.isBoundedBy(this)&&(e.getMax()!==this.getMax()||e.isEmpty()===this.isEmpty())}isBoundedBy(e){return this.isValid()&&e.isValid()&&this.getMin()>=e.getMin()&&this.getMax()<=e.getMax()}intersect(t){let r=Math.max(this.getMin(),t.getMin()),n=Math.min(this.getMax(),t.getMax());return r<n||this.contains(t)||t.contains(this)?new e(r,n):e.InvalidRange()}toString(){return`[${this.start},${this.end})`}};function a_(e){return e.isValid()&&e.isReversed()?new ag(e.end+1,e.start+1):e}D();var av=class e{constructor(t){this.ranges=[],t instanceof ag?this.union(t):t instanceof e&&(this.ranges=[...t.ranges])}equals(e){return this.ranges.length===e.ranges.length&&this.ranges.every((t,r)=>t.equals(e.ranges[r]))}union(e){if(e.isEmpty())return;let t=a_(e),r=this.upperBound(t);0!=r&&r--,r<this.ranges.length&&this.ranges[r].end<t.start&&r++;let n=this.upperBound(new ag(t.end));if(r===n){this.ranges.splice(r,0,t);return}n--;let i=Math.min(this.ranges[r].start,t.start),a=Math.max(this.ranges[n].end,t.end);this.ranges.splice(r,n-r+1,new ag(i,a))}unionRangeSet(e){for(let t of e.ranges)this.union(t)}contains(e){if(e.isEmpty())return!1;let t=a_(e),r=this.upperBound(t);if(0===r||null===r)return!1;let n=r-1;return n>=0&&this.ranges[n].end>=t.end}subtract(e){if(e.isEmpty()||this.isEmpty())return;let t=a_(e),r=this.upperBound(t);0!=r&&r--,r<this.ranges.length&&this.ranges[r].end<t.start&&r++;let n=this.upperBound(new ag(t.end));if(r==n)return;let i=[];for(let e=r;e!=n;e++){let r=new ag(this.ranges[e].start,Math.min(this.ranges[e].end,t.start)),n=new ag(Math.max(this.ranges[e].start,t.end),this.ranges[e].end);r.isEmpty()||r.isReversed()||i.push(r),n.isEmpty()||n.isReversed()||i.push(n)}this.ranges.splice(r,n-r,...i)}subtractRangeSet(e){for(let t of e.ranges.slice())this.subtract(t)}isEmpty(){return 0===this.ranges.length}clear(){this.ranges=[]}toString(){let e="{";for(let t of this.ranges)e+=t.toString();return e+"}"}upperBound(e){for(let t=0;t<this.ranges.length;t++)if(this.ranges[t].start>e.start)return t;return this.ranges.length}},ab=class{constructor(e){this.kChunkSize=65535,this.eofPos=0,this.filledChunks=new av,this.filledChunksCount=0,e&&(this.kChunkSize=e)}setChunkData(e){this.filledChunks.union(new ag(e,e+1)),this.filledChunksCount++}getChunkIndex(e){return Math.floor(e/this.kChunkSize)}getChunkEnd(e){return Math.ceil(e/this.kChunkSize)}getChunksRange(e,t){return new ag(this.getChunkIndex(e),this.getChunkEnd(e+t))}isRangeAvailable(e){if(!e.isValid()||e.isReversed()||this.eofPos>0&&this.eofPos<e.end)return!1;if(e.isEmpty())return!0;let t=new ag(this.getChunkIndex(e.start),this.getChunkEnd(e.end));return this.filledChunks.contains(t)}isRangeSetAvailable(e){for(let t of e.ranges)if(!this.isRangeAvailable(t))return!1;return!0}isComplete(){return this.eofPos>0&&this.isRangeAvailable(new ag(0,this.eofPos))}isValidChunkIndex(e){return!this.eofPos||e<=this.getChunkIndex(this.eofPos-1)}clear(){this.eofPos=0,this.filledChunks.clear(),this.filledChunksCount=0}totalChunksCount(){return this.getChunkEnd(this.eofPos)}};function aw(e){if(!e)throw Error("Matrix is required");return[e.a,e.b,e.c,e.d,e.e,e.f]}function ak(e){if(!e)throw Error("Rect is required");return[e.x,e.y,e.width,e.height]}function aE(e){return e?[e.l,e.t,e.r,e.b]:null}function aI(e){if(e.rotation<0||e.rotation>3)throw Error("Invalid page rotation");return{pageIndex:e.pageIndex,pageLabel:e.pageLabel??`${e.pageIndex+1}`,width:e.width,height:e.height,rotation:e.rotation,matrix:aw(e.matrix),reverseMatrix:aw(e.reverseMatrix),transformedBBox:ak(e.transformedBbox),untransformedBBox:ak(e.untransformedBbox),rawPdfBoxes:function(e){if(!e)throw Error("RawPdfBoxes is required");return{mediaBox:aE(e.mediaBox),cropBox:aE(e.cropBox),bleedBox:aE(e.bleedBox),trimBox:aE(e.trimBox)}}(e.rawPdfBoxes)}}D(),D();var ax=(e=!0,{debug(...e){},info(...e){},warn(...t){e&&console.warn("[core-pdf/linearized-instance]",...t)},enable(t){e=t}}),aO=((o=aO||{}).Yes="Yes",o.No="No",o.Unknown="Unknown",o),aS=((u=aS||{}).IsAvailable="IsAvailable",u.IsNotAvailableYet="IsNotAvailable",u.Error="Error",u);function aT(e){return`Page-${e}`}var aC=((d=aC||{})[d.Progress=0]="Progress",d[d.Complete=1]="Complete",d[d.Error=2]="Error",d),aD=new FinalizationRegistry(e=>{try{ax.debug("Finalizing linearized service with id "+e.linearizedInstanceId),e.coreClient.closeFile(e.fileDescriptor),e.linearizedService.Close(new ae({linearizedInstanceId:e.linearizedInstanceId}))}catch{}}),aA=((c=aA||{}).Uninitialized="Uninitialized",c.Initialized="Initialized",c.Downloading="Downloading",c.Complete="Complete",c.Destroyed="Destroyed",c.Error="Error",c),aF=class{#e;#t="Uninitialized";#r=new nx;#n;#i;#a;#s;#o;#u=0;#d=new ab;#c=new av;#l=new Map;#h=new Map;#p=new Map;constructor(e,t,r){this.#i=e,this.#a=r??new ay(e.engine.coreClient.corePBProtoBridge.bind(e.engine.coreClient)),this.#s=t,this.#i.engine.coreClient.writeFile(t,new Uint8Array),ax.debug("initialized")}async destroy(){this.changeState("Destroyed")}on(e,t){this.#r.on(e,t)}off(e,t){this.#r.off(e,t)}get state(){return this.#t}get eventEmitter(){return this.#r}get linearizedInstanceId(){return this.#e}async initialize(e){F("Uninitialized"==this.#t,void 0),this.#o=await this.#i.engine.coreClient.openFile(this.#s,"a"),this.#n=e;let t=new Headers({Range:"bytes=0-"}),r=await fetch(this.#n,{headers:t,method:"HEAD",credentials:"same-origin"});if(!r.ok)throw Error("Couldn't fetch the file: "+r.statusText);let n=parseInt(r.headers.get("content-length"))||0;if(null==n||0==n||(this.#d.eofPos=n,!(206==r.status&&"application/pdf"===r.headers.get("content-type"))))return!1;let i=new i6({fullFileSize:BigInt(n),filepath:this.#s}),a=await this.#a.Initialize(i);return this.#e=a.linearizedInstanceId,aD.register(this,{linearizedService:this.#a,linearizedInstanceId:this.#e,fileDescriptor:this.#o,coreClient:this.#i.engine.coreClient}),ax.debug("Server supports streaming document."),this.changeState("Initialized"),!0}async kickStartDownload(){this.assertNotUninitialized();let e=new iQ({linearizedInstanceId:this.#e}),t=await this.#a.IsDocumentAvailable(e);F(t.isAvailable,void 0),t.isAvailable.downloadsRequired.forEach(e=>{this.scheduleDownload(Number(e.offset),Number(e.size),"isDocumentAvailable")})}async whenPageAvailable(e,t){if(this.assertNotUninitialized(),this.#p.has(e)){let t=this.#p.get(e);return F(t,void 0),Promise.resolve(t)}let r,n,i=new Promise(function(e,t){r=e,n=t});return ax.debug(`Waiting for page ${e} to be available`),this.trackDownload(aT(e)),this.checkIsPageAvailable(e).then(a=>"IsAvailable"==a.availability?(ax.debug(`Page ${e} is already available`),this.freeDownload(aT(e)),Promise.resolve(a.pageInfo)):(ax.debug(`Page ${e} is not available yet`),this.#r.once(0,()=>{this.pageAvailabilityCheck(e,e=>{F("IsAvailable"==e.availability,void 0),r(e.pageInfo)},n,t)}),i))}async getContentTree(e){this.assertNotUninitialized();let t=await this.#a.GetContentTree(new i5({linearizedInstanceId:this.#e,pageIndex:e}));if(F(t.isAvailable,void 0),t.isAvailable.downloadsRequired.forEach(t=>{this.scheduleDownload(Number(t.offset),Number(t.size),`ContentTree-${e}`)}),t.isAvailable.isAvailable!=i$.AVAILABLE)throw Error("Content tree is not available");return JSON.parse(t.contentTreeJson)}isRunning(){return"Uninitialized"!==this.#t&&"Destroyed"!==this.#t&&"Error"!==this.#t}isDestroyed(){return"Destroyed"===this.#t}isComplete(){return"Complete"===this.#t}async waitUntilIsLinearizedIsKnown(){if("Error"===this.#t||this.isDestroyed())throw Error("Loader encountered an error or was destroyed before linearization could be determined.");return new Promise((e,t)=>{let r=async()=>{let t=await this.isLinearized();"Unknown"!==t&&(i(),e("Yes"===t))},n=e=>{i(),t(e)},i=()=>{this.off(0,r),this.#r.off(2,n)};this.on(0,r),this.#r.once(2,n),r()})}async waitUntilDocumentInfoAvailable(){if("Error"===this.#t||this.isDestroyed())throw Error("Loader encountered an error or was destroyed before document info could be retrieved.");let e=async()=>{switch((await this.checkIsPageAvailable(0)).availability){case"IsAvailable":return this.getDocumentInfo();case"IsNotAvailable":return null;case"Error":throw Error("Document info could not be downloaded.")}};return await e()||new Promise((t,r)=>{let n=async()=>{try{let r=await e();r&&(a(),t(r))}catch(e){a(),r(e)}},i=e=>{a(),r(e)},a=()=>{this.off(0,n),this.#r.off(2,i)};this.on(0,n),this.#r.once(2,i)})}async waitUntilDownloaded(){if("Error"===this.#t||this.isDestroyed())throw Error("Loader encountered an error or was destroyed before download could complete.");if("Complete"!==this.#t)return new Promise((e,t)=>{let r=()=>{i(),e()},n=e=>{i(),t(e)},i=()=>{this.#r.off(1,r),this.#r.off(2,n)};this.#r.once(1,r),this.#r.once(2,n)})}changeState(e){"Destroyed"!==this.#t&&(this.#t=e)}assertNotUninitialized(){F("Uninitialized"!=this.#t,"Linearized instance not initialized, please call initialize first")}async pageAvailabilityCheck(e,t,r,n){if(n?.isCancelled()||this.isDestroyed()||this.isComplete()){ax.debug(`Page ${e} availability check cancelled`),this.freeDownload(aT(e));return}let i=await this.checkIsPageAvailable(e);if(n?.isCancelled()||this.isDestroyed()||this.isComplete()){ax.debug(`Page ${e} availability check cancelled`),this.freeDownload(aT(e));return}switch(i.availability){case"IsAvailable":ax.debug(`Page ${e} availability changed to ${i}`),this.freeDownload(aT(e)),t(i);return;case"Error":ax.debug(`Page ${e} availability changed to ${i}`),this.freeDownload(aT(e)),r("Error making page available");return;case"IsNotAvailable":this.#r.once(0,()=>{this.pageAvailabilityCheck(e,t,r,n)})}}async nextDownload(){if(this.#d.isComplete()){ax.debug("All chunks downloaded, we're done."),this.changeState("Complete"),this.#r.emit(1);return}if("Destroyed"===this.#t)return;let e=this.#c.isEmpty()?0:this.#c.ranges[0].start,t=new av(new ag(e,this.#d.totalChunksCount()));t.subtractRangeSet(this.#d.filledChunks);let r=t.ranges[0];ax.debug({pendingRequests:this.#c.toString(),filledChunks:this.#d.filledChunks.toString(),nextRequest:r.toString()});let n=r.start*this.#d.kChunkSize,i=Math.min(r.length(),15)*this.#d.kChunkSize,a=new Headers;a.append("Range",`bytes=${n}-${n+i-1}`),fetch(this.#n,{headers:a}).then(e=>{this.receivedResponse(e,n).catch(e=>{ax.debug(`Error downloading file ${e}`),this.maybeRetryDownload(e)})}).catch(e=>{ax.debug(`Error downloading file ${e}`),this.maybeRetryDownload(e)})}maybeRetryDownload(e){this.#u++,this.#u>3?this.emitUnrecoverableError(e):this.nextDownload()}async receivedResponse(e,t){if(200!=e.status&&206!=e.status){let t=Error("Couldn't fetch the file: "+e.statusText);this.emitUnrecoverableError(t);return}this.#u=0;let r=await e.arrayBuffer(),n=new Uint8Array(r);F(void 0!==this.#o,void 0),await this.#i.engine.coreClient.writeData(this.#o,n,t).then(()=>{this.#a.OnDataWritten(new i1({linearizedInstanceId:this.#e,offset:BigInt(t),size:BigInt(n.length)}))});let i=this.#d.getChunkIndex(t),a=r.byteLength,s=this.#d.getChunksRange(t,a);for(this.#l.forEach((e,t)=>{e.subtract(s),e.isEmpty()&&this.#l.delete(t)});a>0;)this.#d.setChunkData(i),this.#c.subtract(new ag(i,i+1)),a-=this.#d.kChunkSize,i++;this.#r.emit(0),this.nextDownload()}trackDownload(e){let t=this.#h.get(e);t?t.refCount++:this.#h.set(e,{refCount:1})}freeDownload(e){let t=this.#h.get(e);if(t&&(t.refCount--,0==t.refCount)){this.#h.delete(e);let t=this.#l.get(e);t&&(ax.debug(`[${e}] Freeing download, Requested chunks: ${t.toString()}`),this.#c.subtractRangeSet(t),this.#l.delete(e))}}scheduleDownload(e,t,r){let n=new av(this.#d.getChunksRange(e,t));if(n.subtractRangeSet(this.#d.filledChunks),n.subtractRangeSet(this.#c),!n.isEmpty()){this.#c.unionRangeSet(n);let i=this.#l.get(r);i?i.unionRangeSet(n):this.#l.set(r,n),ax.debug(`[${r}] Scheduling download for offset ${e} and size ${t}, Requested chunks: ${n.toString()}`)}"Downloading"===this.#t||this.isDestroyed()||(this.changeState("Downloading"),this.nextDownload())}emitUnrecoverableError(e){this.changeState("Error"),this.#r.emit(2,e)}async getDocumentInfo(){this.assertNotUninitialized();let e=await this.#a.GetDocumentInfo(new iH({linearizedInstanceId:this.#e}));if("documentInfo"===e.response.case){let t=e.response.value;return{pageCount:t.pageCount,ID:t.pdfId?{permanent:t.pdfId.permanent,update:t.pdfId.changing}:{},title:t.title,metadata:function(e){if(e)return{author:e.author,creator:e.creator,dateCreated:e.dateCreated,dateModified:e.dateModified,producer:e.producer}}(t.metadata),pages:Array.from({length:t.pageCount},()=>aI(t.pageInfo[0])).map((e,t)=>(e.pageIndex=t,e.pageLabel=`${t+1}`,e))}}return F(e.response.value,void 0),e.response.value.downloadsRequired.forEach(e=>{this.scheduleDownload(Number(e.offset),Number(e.size),"document-info")}),null}async isLinearized(){this.assertNotUninitialized();let e=await this.#a.IsLinearized(new i4({linearizedInstanceId:this.#e}));switch(e.downloadsRequired.forEach(e=>{this.scheduleDownload(Number(e.offset),Number(e.size),"isLinearized")}),e.isLinearized){case iV.LINEARIZED:return"Yes";case iV.NOT_LINEARIZED:return"No";case iV.UNKNOWN:return"Unknown"}}async checkIsPageAvailable(e){if(this.assertNotUninitialized(),this.#p.has(e)){let t=this.#p.get(e);return F(t,void 0),{availability:"IsAvailable",pageInfo:t}}let t=new iK({linearizedInstanceId:this.#e,pageIndex:e}),r=await this.#a.IsPageAvailable(t);switch(F(r.isPageAvailable,void 0),r.isPageAvailable.downloadsRequired.forEach(t=>{this.scheduleDownload(Number(t.offset),Number(t.size),aT(e))}),r.isPageAvailable.isAvailable){case i$.AVAILABLE:{F(r.pageInfo,void 0);let t=aI(r.pageInfo);return this.#p.set(e,t),{availability:"IsAvailable",pageInfo:t}}case i$.NOT_AVAILABLE_YET:return{availability:"IsNotAvailable"};case i$.ERROR:return ax.debug("Error while checking page availability"),{availability:"Error"}}}};D(),H();var aP=async(e,t,r)=>{let n=await e.engine.executeCommand(t,1,r);return F(1===n.values.length,`expected only one response for ${t}: ${n.values}`),F(!(n.values[0]instanceof Uint8Array),"expected JSON response: "+n.values),n.values[0]},aN=e=>{e.serverCtx&&F(nm(e,M),"Content Editing is available with Document Engine version "+M)};async function aj(e){if(e.serverCtx){aN(e);let t=nS(e.requestQueue,e.serverCtx,"pdf",1,1);if(!e.wasmCtx){F(e.getWasmDispatch,void 0);let t=await e.getWasmDispatch();e.wasmCtx||nl(e,t)}F(e.wasmCtx,void 0);let r=await t;return await e.wasmCtx.engine.coreClient.writeFile("/document.pdf",await r.arrayBuffer()),await e.wasmCtx.engine.executeCommand("open_document",0,{file_path:"/document.pdf"}),await e.wasmCtx.engine.executeCommand("content_editing/enter",1,{}),new aZ(e.wasmCtx,e)}if(e.wasmCtx)return F(e.wasmCtx,"wasmCtx is required."),await e.wasmCtx?.engine.executeCommand("content_editing/enter",1,{}),new aZ(e.wasmCtx,e)}var aZ=class{constructor(e,t){F(e,"wasmCtx is required."),this.wasmCtx=e,this.ctx=t}async closeContentEditor(){await this.wasmCtx.engine.executeCommand("content_editing/exit",1,{})}async getTextBlocks(e){return aP(this.wasmCtx,"content_editing/get_text_blocks",{pageIndex:e})}async detectParagraphs(e){return aP(this.wasmCtx,"content_editing/detect_paragraphs",{pageIndex:e})}async renderTextBlock(e,t,r){let n=await this.wasmCtx.engine.executeCommand("content_editing/render_text_block",1,{textBlockId:e,renderTextBlockParams:t,externalControlState:r});return F(2===n.values.length,"expected only two responses for renderTextBlock. ArrayBuffer and Size info."),F(!(n.values[0]instanceof Uint8Array),`expected JSON response: ${n.values}`),F(n.values[1]instanceof Uint8Array,`expected ArrayBuffer response: ${n.values}`),{imageBuffer:n.values[1],displayRect:n.values[0].displayRect}}async setTextBlockCursor(e,t,r,n){return aP(this.wasmCtx,"content_editing/set_cursor",{textBlockId:e,offset:t,selectText:r,externalControlState:n})}async moveTextBlockCursor(e,t,r,n){return aP(this.wasmCtx,"content_editing/move_cursor",{textBlockId:e,movement:t,selectText:r,externalControlState:n})}async insertTextBlockString(e,t,r,n){return aP(this.wasmCtx,"content_editing/insert_text",{textBlockId:e,cluster:t,text:r,externalControlState:n})}async insertTextBlockContentRef(e,t,r,n){return aP(this.wasmCtx,"content_editing/insert_content_ref",{textBlockId:e,cluster:t,contentRef:r,externalControlState:n})}async createTextBlock(e){return aP(this.wasmCtx,"content_editing/create_text_block",{pageIndex:e})}async layoutTextBlock(e,t,r,n){return aP(this.wasmCtx,"content_editing/layout",{textBlockId:e,cursor:t,selection:r,externalControlState:n})}async deleteTextBlockRange(e,t,r){return aP(this.wasmCtx,"content_editing/delete_range",{textBlockId:e,range:t,externalControlState:r})}async deleteTextBlockString(e,t,r){return aP(this.wasmCtx,"content_editing/delete_cluster",{textBlockId:e,direction:t,externalControlState:r})}async setTextBlockSelection(e,t,r){return aP(this.wasmCtx,"content_editing/set_selection",{textBlockId:e,mode:t,externalControlState:r})}async setTextBlockSelectionRange(e,t,r,n,i){return aP(this.wasmCtx,"content_editing/set_selection_range",{textBlockId:e,begin:t,end:r,mode:n,externalControlState:i})}async textBlockUndo(e,t){return aP(this.wasmCtx,"content_editing/undo",{textBlockId:e,externalControlState:t})}async textBlockRedo(e,t){return aP(this.wasmCtx,"content_editing/redo",{textBlockId:e,externalControlState:t})}async textBlockRestore(e,t,r){return aP(this.wasmCtx,"content_editing/restore",{textBlockId:e,version:t,externalControlState:r})}async textBlockApplyFormat(e,t,r,n){return aP(this.wasmCtx,"content_editing/apply_format",{textBlockId:e,range:t,formatModifications:r,externalControlState:n})}async save(e,t,r){try{let a="/update";if(this.ctx.serverCtx){var n,i;aN(this.ctx);let s=await aP(this.wasmCtx,"content_editing/save_to_document",{path:e,textBlockSaveInfos:t,graphicBlockSaveInfos:r,alsoSaveUpdate:!0,updateSavePath:a});n=s.checksum.length>0,F(n,"expected non-empty checksum");let o=new FormData;if(o.append("update",new Blob([await this.wasmCtx.engine.coreClient.readFile(a)]),"update"),o.append("checksum",s.checksum),(await nS(this.ctx.requestQueue,this.ctx.serverCtx,"update-source-document",1,0,{method:"POST",body:o})).ok)return;i=this.ctx.serverCtx,F(i,"serverCtx is required."),(o=new FormData).append("file",new Blob([await this.wasmCtx.engine.coreClient.readFile(e)]),"file"),await nS(this.ctx.requestQueue,this.ctx.serverCtx,"replace-source-document",1,0,{method:"POST",body:o})}else await this.wasmCtx.engine.executeCommand("content_editing/save_to_document",1,{path:e,textBlockSaveInfos:t,graphicBlockSaveInfos:r})}catch(t){throw Error(`Error saving to ${e}: ${t.message}`)}}async getAvailableFaces(){return aP(this.wasmCtx,"content_editing/available_faces")}async detectPageElements(e){return aP(this.wasmCtx,"content_editing/detect_page_elements",{pageIndex:e})}async renderGraphicBlock(e,t){let r=await this.wasmCtx.engine.executeCommand("content_editing/render_graphic_block",1,{graphicBlockId:e,renderGraphicBlockParams:t});return F(2===r.values.length,"expected only two responses for renderGraphicBlock. ArrayBuffer and Size info."),F(!(r.values[0]instanceof Uint8Array),`expected JSON response: ${r.values}`),F(r.values[1]instanceof Uint8Array,`expected ArrayBuffer response: ${r.values}`),{imageBuffer:r.values[1],displayRect:r.values[0].displayRect}}cancelRequests(){this.wasmCtx.engine.cancelRequests(e=>!!e.jsonCommand&&(F("string"==typeof e.jsonCommand.type,"expected string type"),e.jsonCommand.type.startsWith("content_editing/")))}},aR={};D(),D();var aB=rH.object({incremental:rH.boolean().optional(),flatten:rH.boolean().optional(),excludeAnnotations:rH.boolean().optional(),saveForPrinting:rH.boolean().optional()}).optional(),aL=rH.union([rH.instanceof(ArrayBuffer),rH.instanceof(Uint8Array)]).or(rH.instanceof(Buffer)),aM=rH.union([rH.instanceof(ArrayBuffer),rH.instanceof(Uint8Array)]).or(rH.instanceof(Buffer)),aq=rH.object({document:aL,fonts:rH.array(rH.object({name:rH.string(),data:aM})).optional(),license:rH.optional(rH.object({key:rH.string(),appName:rH.string()})),instantJSON:rH.optional(rH.record(rH.string(),rH.unknown()))}).strict(),aU=class{#e;#t;#r;constructor(e){this.#e=e,this.#t=rQ.createWASMContext(this.#e)}openDocument(e,t){return this.#e?.openDocument(e,t).then(e=>(this.#r=e,e))}async exportPDF(e={}){try{aB.parse(e)}catch(e){throw(0,rY.fromZodError)(e)}return(await this.#e?.exportFile(e.flatten??!1,e.incremental??!1,e.saveForPrinting??!1,"pdf",e.excludeAnnotations,!0))?.[0]}async exportInstantJSON(){return await this.#e?.exportInstantJSON()}async renderPage(e,t,r="png"){F(this.#e,"Document is not loaded"),F(this.#t,"CorePDF context not present"),F(this.#r,"Document information not present"),az.parse(t);let n,i,a=this.#r.pages[e];return F(a,"Page not found"),"width"in t&&(i=Math.round((n=Math.round(t.width))*a.height/a.width)),"height"in t&&(n=Math.round((i=Math.round(t.height))*a.width/a.height)),(await rQ.Renderer.renderTile(this.#t,e,{width:n,height:i},{left:0,top:0,width:n,height:i},{format:r})).buffer}getDocumentInfo(){return F(this.#r,"Document is not loaded"),this.#r}async close(){this.#e?.closeDocument(),this.#e?.destroy(),this.#e=null}},az=rH.union([rH.object({width:rH.number().min(0).max(5e3)}),rH.object({height:rH.number().min(0).max(5e3)})]);async function a$(e){let t;try{aq.parse(e),e.instantJSON&&function(e){F("object"==typeof e&&null!==e,"instantJSON must be an Object"),F("https://pspdfkit.com/instant-json/v1"===e.format,"instantJSON has an invalid format, please use 'https://pspdfkit.com/instant-json/v1");let{pdfId:t}=e;t&&F("object"==typeof t&&null!==t&&("string"==typeof t.permanent&&"string"==typeof t.changing||"string"!=typeof t.permanent&&"string"!=typeof t.changing),"instantJSON has an invalid pdfId"),F(typeof e.skippedPdfObjectIds>"u"||Array.isArray(e.skippedPdfObjectIds),"instantJSON has invalid skippedPdfObjectIds"),F(typeof e.annotations>"u"||Array.isArray(e.annotations)&&e.annotations.every(e=>"object"==typeof e&&null!==e),"instantJSON has invalid annotations"),F(typeof e.formFieldValues>"u"||Array.isArray(e.formFieldValues)&&e.formFieldValues.every(e=>"object"==typeof e&&null!==e),"instantJSON has invalid form field values"),F(typeof e.skippedPdfBookmarkIds>"u"||Array.isArray(e.skippedPdfBookmarkIds),"instantJSON has invalid skippedPdfBookmarkIds"),F(typeof e.bookmarks>"u"||Array.isArray(e.bookmarks)&&e.bookmarks.every(e=>"object"==typeof e&&null!==e),"instantJSON has invalid bookmarks")}(e.instantJSON)}catch(e){throw(0,tn.fromZodError)(e)}let{document:r,fonts:n}=e,{default:i}=await Promise.resolve().then(()=>(eE(),ev));F(i,"Spawner is null");let a=new e7,s=await import("node:fs");f=e4(import.meta.url),m=e2.dirname(f);let o=s.readFileSync(e2.join(m,"..","vendor","pspdfkit.wasm")),u=e2.resolve(e2.join(m,"..","vendor","pspdfkit.wasm.js")),d=e.license?.key,c=e.license?.appName??"localhost";F(o,"Wasm module couldn't be loaded"),await a.loadNativeModule("",{disableWebAssemblyStreaming:!1,enableAutomaticLinkExtraction:!0,overrideMemoryLimit:null,wasm:o,wasmLoaderPath:u,mainThreadOrigin:c,workerSpawnerFn:i}),await a.load("",d,{mainThreadOrigin:c,productId:"NodeJS",customFonts:n}),t=new aU(a);try{await t.openDocument(r),e.instantJSON&&(function e(t){let r={};return Object.keys(t).forEach(n=>{Array.isArray(t[n])?r[n]=t[n].filter(Boolean):"object"==typeof t[n]&&null!==t[n]?r[n]=e(t[n]):r[n]=t[n]}),r}(e.instantJSON),await a.importInstantJSON({skippedPdfObjectIds:[],skippedPdfBookmarkIds:[],annotations:[],bookmarks:[],formFieldValues:[],formFields:[],attachments:{},...e.instantJSON}))}catch(e){if(e.message.includes("File not in PDF format or corrupted.")){let e=(await Promise.resolve().then(()=>(eK(),eW))).GdPictureWorker,{default:i}=await Promise.resolve().then(()=>(e1(),eH)),a=await i();F(a,"Spawner is null");let s=new URL("../vendor/gdpicture/aot",import.meta.url).href,o=new e({baseUrl:e4(s),wasmLoaderPath:e2.resolve(e2.join(m,"..","vendor","gdpicture","aot","initDotnet.js")),mainThreadOrigin:c??"localhost",licenseKey:d,workerSpawner:a,customFonts:n,aot:!0}),u=await o.toPdf(r);o.destroy(),await t.openDocument(u)}else throw t&&await t.close(),e}return t}export{a$ as load};